<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<TITLE>Example with PostgreSQL</TITLE>
<LINK TYPE="text/css" REL="stylesheet" HREF="../fpdf.css">
</HEAD>
<BODY ONLOAD="if(window.focus) window.focus()">
<H2>Example with PostgreSQL</H2>
<H4 class="st">Informations</H4>Author: <A HREF="&#109;ailto:ribafs&#64;dnocs.gov.br?subject=Example%20with%20PostgreSQL">Ribamar FS</A><BR>License: Freeware
<H4 CLASS="st">Description</H4>This is a simple script example which issues a query to a PostgreSQL database and builds a
table with the result.
<H4 CLASS="st">Source</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br><font class="cmt">//Example FPDF script with PostgreSQL<br>//Ribamar FS - ribafs@dnocs.gov.br<br><br></font>define<font class="kw">(</font><font class="str">'FPDF_FONTPATH'</font><font class="kw">,</font><font class="str">'font/'</font><font class="kw">);<br>require(</font><font class="str">'fpdf.php'</font><font class="kw">);<br><br></font>$pdf<font class="kw">=new&nbsp;</font>FPDF<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>Open<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>AddPage<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>SetTitle<font class="kw">(</font><font class="str">'Exemplo de Relatório em PDF via PHP'</font><font class="kw">);<br><br></font><font class="cmt">//Set font and colors<br></font>$pdf<font class="kw">-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">'B'</font><font class="kw">,</font>16<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetFillColor<font class="kw">(</font>255<font class="kw">,</font>0<font class="kw">,</font>0<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetTextColor<font class="kw">(</font>255<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetDrawColor<font class="kw">(</font>128<font class="kw">,</font>0<font class="kw">,</font>0<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetLineWidth<font class="kw">(</font>.3<font class="kw">);<br><br></font><font class="cmt">//Table header<br></font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>20<font class="kw">,</font>10<font class="kw">,</font><font class="str">'SIAPE'</font><font class="kw">,</font>1<font class="kw">,</font>0<font class="kw">,</font><font class="str">'L'</font><font class="kw">,</font>1<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>50<font class="kw">,</font>10<font class="kw">,</font><font class="str">'Nome'</font><font class="kw">,</font>1<font class="kw">,</font>1<font class="kw">,</font><font class="str">'L'</font><font class="kw">,</font>1<font class="kw">);<br><br></font><font class="cmt">//Restore font and colors<br></font>$pdf<font class="kw">-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>10<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetFillColor<font class="kw">(</font>224<font class="kw">,</font>235<font class="kw">,</font>255<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetTextColor<font class="kw">(</font>0<font class="kw">);<br><br></font><font class="cmt">//Connection and query<br></font>$str_conexao<font class="kw">=</font><font class="str">'dbname=contabilidade port=5432 user=postgres password=postgres'</font><font class="kw">;<br></font>$conexao<font class="kw">=</font>pg_connect<font class="kw">(</font>$str_conexao<font class="kw">)&nbsp;or&nbsp;die(</font><font class="str">'A conexão ao banco de dados falhou!'</font><font class="kw">);<br></font>$consulta<font class="kw">=</font>pg_exec<font class="kw">(</font>$conexao<font class="kw">,</font><font class="str">'select * from conveniologin'</font><font class="kw">);<br></font>$numregs<font class="kw">=</font>pg_numrows<font class="kw">(</font>$consulta<font class="kw">);<br><br></font><font class="cmt">//Build table<br></font>$fill<font class="kw">=</font>0<font class="kw">;<br></font>$i<font class="kw">=</font>0<font class="kw">;<br>while(</font>$i<font class="kw">&lt;</font>$numregs<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$siape<font class="kw">=</font>pg_result<font class="kw">(</font>$consulta<font class="kw">,</font>$i<font class="kw">,</font><font class="str">'siape'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$nome<font class="kw">=</font>pg_result<font class="kw">(</font>$consulta<font class="kw">,</font>$i<font class="kw">,</font><font class="str">'nome'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>20<font class="kw">,</font>10<font class="kw">,</font>$siape<font class="kw">,</font>1<font class="kw">,</font>0<font class="kw">,</font><font class="str">'R'</font><font class="kw">,</font>$fill<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>50<font class="kw">,</font>10<font class="kw">,</font>$nome<font class="kw">,</font>1<font class="kw">,</font>1<font class="kw">,</font><font class="str">'L'</font><font class="kw">,</font>$fill<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$fill<font class="kw">=!</font>$fill<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$i<font class="kw">++;<br>}<br><br></font><font class="cmt">//Add a rectangle, a line, a logo and some text<br></font>$pdf<font class="kw">-&gt;</font>Rect<font class="kw">(</font>5<font class="kw">,</font>5<font class="kw">,</font>170<font class="kw">,</font>80<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Line<font class="kw">(</font>5<font class="kw">,</font>90<font class="kw">,</font>90<font class="kw">,</font>90<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Image<font class="kw">(</font><font class="str">'mouse.jpg'</font><font class="kw">,</font>185<font class="kw">,</font>5<font class="kw">,</font>10<font class="kw">,</font>0<font class="kw">,</font><font class="str">'JPG'</font><font class="kw">,</font><font class="str">'http://www.dnocs.gov.br'</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetFillColor<font class="kw">(</font>224<font class="kw">,</font>235<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">'B'</font><font class="kw">,</font>8<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetXY<font class="kw">(</font>5<font class="kw">,</font>95<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>170<font class="kw">,</font>5<font class="kw">,</font><font class="str">'PDF gerado via PHP acessando banco de dados - Por Ribamar FS'</font><font class="kw">,</font>1<font class="kw">,</font>1<font class="kw">,</font><font class="str">'L'</font><font class="kw">,</font>1<font class="kw">,</font><font class="str">'mailto:ribafs@dnocs.gov.br'</font><font class="kw">);<br><br></font>$pdf<font class="kw">-&gt;</font>Output<font class="kw">();<br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>

<H4 CLASS="st">Download</H4><A HREF="script11.zip">ZIP</A> | <A HREF="script11.tgz">TGZ</A>
</BODY>
</HTML>

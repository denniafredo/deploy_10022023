<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<TITLE>Text rotations</TITLE>
<LINK TYPE="text/css" REL="stylesheet" HREF="../fpdf.css">
</HEAD>
<BODY ONLOAD="if(window.focus) window.focus()">
<H2>Text rotations</H2>
<H4 CLASS="st">Informations</H4>Author: <SCRIPT TYPE="text/javascript">document.write('<A H'+'REF="m'+'ailto:boba'+'&#'+'64;'+'khspu.ru?subject=Text%20rotations">');</SCRIPT>Pivkin Vladimir<SCRIPT TYPE="text/javascript">document.write('<\/A>');</SCRIPT><BR>License: Freeware
<H4 CLASS="st">Description</H4>This extension allows to print rotated and sheared (i.e. distorted like in italic) text.<BR>
<BR>
<TT>TextWithDirection(<B>float</B> x, <B>float</B> y, <B>string</B> txt [, <B>string</B> direction])</TT><BR>
<BR>
<TT><U>x</U></TT>: abscissa<BR>
<TT><U>y</U></TT>: ordinate<BR>
<TT><U>txt</U></TT>: text string<BR>
<TT><U>direction</U></TT>: one of the following values (<TT>R</TT> by default):<BR>
<UL>
<LI><TT>R</TT> (Right): Left to Right <BR>
<LI><TT>U</TT> (Up): Bottom to Top<BR>
<LI><TT>D</TT> (Down): Top To Bottom<BR>
<LI><TT>L</TT> (Left): Right to Left <BR>
</UL>
<TT>TextWithRotation(<B>float</B> x, <B>float</B> y, <B>string</B> txt, <B>float</B> txt_angle [, <B>float</B> font_angle])</TT><BR>
<BR>
<TT><U>x</U></TT>: abscissa<BR>
<TT><U>y</U></TT>: ordinate<BR>
<TT><U>txt</U></TT>: text string<BR>
<TT><U>txt_angle</U></TT>: angle of the text<BR>
<TT><U>font_angle</U></TT>: shear angle (<TT>0</TT> by default)<BR>
<H4 CLASS="st">Source</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br><font class="kw">require(</font><font class="str">'fpdf.php'</font><font class="kw">);<br><br>class </font>RPDF <font class="kw">extends </font>FPDF <font class="kw">{<br><br>function </font>TextWithDirection<font class="kw">(</font>$x<font class="kw">,</font>$y<font class="kw">,</font>$txt<font class="kw">,</font>$direction<font class="kw">=</font><font class="str">'R'</font><font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$txt<font class="kw">=</font>str_replace<font class="kw">(</font><font class="str">')'</font><font class="kw">,</font><font class="str">'\\)'</font><font class="kw">,</font>str_replace<font class="kw">(</font><font class="str">'('</font><font class="kw">,</font><font class="str">'\\('</font><font class="kw">,</font>str_replace<font class="kw">(</font><font class="str">'\\'</font><font class="kw">,</font><font class="str">'\\\\'</font><font class="kw">,</font>$txt<font class="kw">)));<br>&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$direction<font class="kw">==</font><font class="str">'R'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">=</font>sprintf<font class="kw">(</font><font class="str">'BT %.2f %.2f %.2f %.2f %.2f %.2f Tm (%s) Tj ET'</font><font class="kw">,</font>1<font class="kw">,</font>0<font class="kw">,</font>0<font class="kw">,</font>1<font class="kw">,</font>$x<font class="kw">*</font>$<font class="kw">this-&gt;</font>k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$<font class="kw">this-&gt;</font>k<font class="kw">,</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;elseif (</font>$direction<font class="kw">==</font><font class="str">'L'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">=</font>sprintf<font class="kw">(</font><font class="str">'BT %.2f %.2f %.2f %.2f %.2f %.2f Tm (%s) Tj ET'</font><font class="kw">,-</font>1<font class="kw">,</font>0<font class="kw">,</font>0<font class="kw">,-</font>1<font class="kw">,</font>$x<font class="kw">*</font>$<font class="kw">this-&gt;</font>k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$<font class="kw">this-&gt;</font>k<font class="kw">,</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;elseif (</font>$direction<font class="kw">==</font><font class="str">'U'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">=</font>sprintf<font class="kw">(</font><font class="str">'BT %.2f %.2f %.2f %.2f %.2f %.2f Tm (%s) Tj ET'</font><font class="kw">,</font>0<font class="kw">,</font>1<font class="kw">,-</font>1<font class="kw">,</font>0<font class="kw">,</font>$x<font class="kw">*</font>$<font class="kw">this-&gt;</font>k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$<font class="kw">this-&gt;</font>k<font class="kw">,</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;elseif (</font>$direction<font class="kw">==</font><font class="str">'D'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">=</font>sprintf<font class="kw">(</font><font class="str">'BT %.2f %.2f %.2f %.2f %.2f %.2f Tm (%s) Tj ET'</font><font class="kw">,</font>0<font class="kw">,-</font>1<font class="kw">,</font>1<font class="kw">,</font>0<font class="kw">,</font>$x<font class="kw">*</font>$<font class="kw">this-&gt;</font>k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$<font class="kw">this-&gt;</font>k<font class="kw">,</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">=</font>sprintf<font class="kw">(</font><font class="str">'BT %.2f %.2f Td (%s) Tj ET'</font><font class="kw">,</font>$x<font class="kw">*</font>$<font class="kw">this-&gt;</font>k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$<font class="kw">this-&gt;</font>k<font class="kw">,</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$<font class="kw">this-&gt;</font>ColorFlag<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">=</font><font class="str">'q '</font><font class="kw">.</font>$<font class="kw">this-&gt;</font>TextColor<font class="kw">.</font><font class="str">' '</font><font class="kw">.</font>$s<font class="kw">.</font><font class="str">' Q'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font>$s<font class="kw">);<br>}<br><br>function </font>TextWithRotation<font class="kw">(</font>$x<font class="kw">,</font>$y<font class="kw">,</font>$txt<font class="kw">,</font>$txt_angle<font class="kw">,</font>$font_angle<font class="kw">=</font>0<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$txt<font class="kw">=</font>str_replace<font class="kw">(</font><font class="str">')'</font><font class="kw">,</font><font class="str">'\\)'</font><font class="kw">,</font>str_replace<font class="kw">(</font><font class="str">'('</font><font class="kw">,</font><font class="str">'\\('</font><font class="kw">,</font>str_replace<font class="kw">(</font><font class="str">'\\'</font><font class="kw">,</font><font class="str">'\\\\'</font><font class="kw">,</font>$txt<font class="kw">)));<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$font_angle<font class="kw">+=</font>90<font class="kw">+</font>$txt_angle<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$txt_angle<font class="kw">*=</font>M_PI<font class="kw">/</font>180<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$font_angle<font class="kw">*=</font>M_PI<font class="kw">/</font>180<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$txt_dx<font class="kw">=</font>cos<font class="kw">(</font>$txt_angle<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$txt_dy<font class="kw">=</font>sin<font class="kw">(</font>$txt_angle<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$font_dx<font class="kw">=</font>cos<font class="kw">(</font>$font_angle<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$font_dy<font class="kw">=</font>sin<font class="kw">(</font>$font_angle<font class="kw">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">=</font>sprintf<font class="kw">(</font><font class="str">'BT %.2f %.2f %.2f %.2f %.2f %.2f Tm (%s) Tj ET'</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>$txt_dx<font class="kw">,</font>$txt_dy<font class="kw">,</font>$font_dx<font class="kw">,</font>$font_dy<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>$x<font class="kw">*</font>$<font class="kw">this-&gt;</font>k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$<font class="kw">this-&gt;</font>k<font class="kw">,</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$<font class="kw">this-&gt;</font>ColorFlag<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">=</font><font class="str">'q '</font><font class="kw">.</font>$<font class="kw">this-&gt;</font>TextColor<font class="kw">.</font><font class="str">' '</font><font class="kw">.</font>$s<font class="kw">.</font><font class="str">' Q'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font>$s<font class="kw">);<br>}<br><br>}<br><br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>

<H4 CLASS="st">Example</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br>define<font class="kw">(</font><font class="str">'FPDF_FONTPATH'</font><font class="kw">,</font><font class="str">'font/'</font><font class="kw">);<br>require(</font><font class="str">'rpdf.php'</font><font class="kw">);<br><br></font>$pdf<font class="kw">=new </font>RPDF<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>Open<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>AddPage<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>40<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>TextWithRotation<font class="kw">(</font>50<font class="kw">,</font>65<font class="kw">,</font><font class="str">'Hello'</font><font class="kw">,</font>45<font class="kw">,-</font>45<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetFontSize<font class="kw">(</font>30<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>TextWithDirection<font class="kw">(</font>110<font class="kw">,</font>50<font class="kw">,</font><font class="str">'world!'</font><font class="kw">,</font><font class="str">'L'</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>TextWithDirection<font class="kw">(</font>110<font class="kw">,</font>50<font class="kw">,</font><font class="str">'world!'</font><font class="kw">,</font><font class="str">'U'</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>TextWithDirection<font class="kw">(</font>110<font class="kw">,</font>50<font class="kw">,</font><font class="str">'world!'</font><font class="kw">,</font><font class="str">'R'</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>TextWithDirection<font class="kw">(</font>110<font class="kw">,</font>50<font class="kw">,</font><font class="str">'world!'</font><font class="kw">,</font><font class="str">'D'</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Output<font class="kw">();<br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>
<BR>
View the result <A HREF="ex31.pdf" TARGET="_blank">here</A>.
<H4 CLASS="st">Download</H4><A HREF="script31.zip">ZIP</A> | <A HREF="script31.tgz">TGZ</A>
</BODY>
</HTML>

<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<TITLE>Write HTML tables</TITLE>
<LINK TYPE="text/css" REL="stylesheet" HREF="../fpdf.css">
</HEAD>
<BODY ONLOAD="if(window.focus) window.focus()">
<H2>Write HTML tables</H2>
<H4 CLASS="st">Informations</H4>Author: <SCRIPT TYPE="text/javascript">document.write('<A H'+'REF="m'+'ailto:ricky'+'&#'+'64;'+'home.nl?subject=Write%20HTML%20tables">');</SCRIPT>Rick van Buuren<SCRIPT TYPE="text/javascript">document.write('<\/A>');</SCRIPT><BR>License: Freeware
<H4 CLASS="st">Description</H4>This script allows you to parse HTML tables to PDF Cells (and has got some other
functionality too).<BR>
It can parse:<BR>
<BR>
&lt;table border="<I>border</I>"><BR>
where <I>border</I> can be 1 or 0<BR>
<BR>
&lt;tr><BR>
which makes a new row<BR>
<BR>
&lt;td width="<I>width</I>" height="<I>height</I>" bgcolor="<I>bgcolor</I>"><BR>
where <I>width</I> and <I>height</I> are integers and <I>bgcolor</I> is html color code<BR>
<BR>
It's a really simple script. Inner tags can give some problems; &lt;td>&lt;b>big&lt;/b> small&lt;td>
won't give a proper output for example. It also doesn't place pictures in a correct way, although you
can use a table to align a picture:<BR>
<BR>
&lt;table>&lt;tr>&lt;td width="200">&amp;nbsp;&lt;/td>&lt;td width="200">&lt;img src="..." width="..." height="...">&lt;/td>&lt;/tr>&lt;/table><BR>
<BR>
will align a picture in the middle.<BR>
You need to use &amp;nbsp; when you want a blank cell.
<H4 CLASS="st">Source</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br><font class="cmt">//Based on HTML2PDF by Clément Lavoillotte<br><br></font><font class="kw">require(</font><font class="str">'fpdf.php'</font><font class="kw">);<br><br></font><font class="cmt">//function hex2dec<br>//returns an associative array (keys: R,G,B) from<br>//a hex html code (e.g. #3FE5AA)<br></font><font class="kw">function </font>hex2dec<font class="kw">(</font>$couleur <font class="kw">= </font><font class="str">"#000000"</font><font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$R <font class="kw">= </font>substr<font class="kw">(</font>$couleur<font class="kw">, </font>1<font class="kw">, </font>2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$rouge <font class="kw">= </font>hexdec<font class="kw">(</font>$R<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$V <font class="kw">= </font>substr<font class="kw">(</font>$couleur<font class="kw">, </font>3<font class="kw">, </font>2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$vert <font class="kw">= </font>hexdec<font class="kw">(</font>$V<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$B <font class="kw">= </font>substr<font class="kw">(</font>$couleur<font class="kw">, </font>5<font class="kw">, </font>2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$bleu <font class="kw">= </font>hexdec<font class="kw">(</font>$B<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$tbl_couleur <font class="kw">= array();<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$tbl_couleur<font class="kw">[</font><font class="str">'R'</font><font class="kw">]=</font>$rouge<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$tbl_couleur<font class="kw">[</font><font class="str">'G'</font><font class="kw">]=</font>$vert<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$tbl_couleur<font class="kw">[</font><font class="str">'B'</font><font class="kw">]=</font>$bleu<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;return </font>$tbl_couleur<font class="kw">;<br>}<br><br></font><font class="cmt">//conversion pixel -&gt; millimeter in 72 dpi<br></font><font class="kw">function </font>px2mm<font class="kw">(</font>$px<font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;return </font>$px<font class="kw">*</font>25.4<font class="kw">/</font>72<font class="kw">;<br>}<br><br>function </font>txtentities<font class="kw">(</font>$html<font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$trans <font class="kw">= </font>get_html_translation_table<font class="kw">(</font>HTML_ENTITIES<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$trans <font class="kw">= </font>array_flip<font class="kw">(</font>$trans<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;return </font>strtr<font class="kw">(</font>$html<font class="kw">, </font>$trans<font class="kw">);<br>}<br></font><font class="cmt">////////////////////////////////////<br><br></font><font class="kw">class </font>PDF <font class="kw">extends </font>FPDF<br><font class="kw">{<br></font><font class="cmt">//variables of html parser<br></font><font class="kw">var </font>$B<font class="kw">;<br>var </font>$I<font class="kw">;<br>var </font>$U<font class="kw">;<br>var </font>$HREF<font class="kw">;<br>var </font>$fontList<font class="kw">;<br>var </font>$issetfont<font class="kw">;<br>var </font>$issetcolor<font class="kw">;<br><br>function </font>PDF<font class="kw">(</font>$orientation<font class="kw">=</font><font class="str">'P'</font><font class="kw">,</font>$unit<font class="kw">=</font><font class="str">'mm'</font><font class="kw">,</font>$format<font class="kw">=</font><font class="str">'A4'</font><font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Call parent constructor<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>FPDF<font class="kw">(</font>$orientation<font class="kw">,</font>$unit<font class="kw">,</font>$format<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Initialization<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>B<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>I<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>U<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>HREF<font class="kw">=</font><font class="str">''</font><font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tableborder<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tdbegin<font class="kw">=</font>false<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tdwidth<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tdheight<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tdalign<font class="kw">=</font><font class="str">"L"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tdbgcolor<font class="kw">=</font>false<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>oldx<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>oldy<font class="kw">=</font>0<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>fontlist<font class="kw">=array(</font><font class="str">"arial"</font><font class="kw">,</font><font class="str">"times"</font><font class="kw">,</font><font class="str">"courier"</font><font class="kw">,</font><font class="str">"helvetica"</font><font class="kw">,</font><font class="str">"symbol"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>issetfont<font class="kw">=</font>false<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>issetcolor<font class="kw">=</font>false<font class="kw">;<br>}<br><br></font><font class="cmt">//////////////////////////////////////<br>//html parser<br><br></font><font class="kw">function </font>WriteHTML<font class="kw">(</font>$html<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$html<font class="kw">=</font>strip_tags<font class="kw">(</font>$html<font class="kw">,</font><font class="str">"&lt;b&gt;&lt;u&gt;&lt;i&gt;&lt;a&gt;&lt;img&gt;&lt;p&gt;&lt;br&gt;&lt;strong&gt;&lt;em&gt;&lt;font&gt;&lt;tr&gt;&lt;blockquote&gt;&lt;hr&gt;&lt;td&gt;&lt;tr&gt;&lt;table&gt;&lt;sup&gt;"</font><font class="kw">); </font><font class="cmt">//remove all unsupported tags<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$html<font class="kw">=</font>str_replace<font class="kw">(</font><font class="str">"\n"</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>$html<font class="kw">); </font><font class="cmt">//replace carriage returns by spaces<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$html<font class="kw">=</font>str_replace<font class="kw">(</font><font class="str">"\t"</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>$html<font class="kw">); </font><font class="cmt">//replace carriage returns by spaces<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$a<font class="kw">=</font>preg_split<font class="kw">(</font><font class="str">'/&lt;(.*)&gt;/U'</font><font class="kw">,</font>$html<font class="kw">,-</font>1<font class="kw">,</font>PREG_SPLIT_DELIM_CAPTURE<font class="kw">); </font><font class="cmt">//explodes the string<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">foreach(</font>$a <font class="kw">as </font>$i<font class="kw">=&gt;</font>$e<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$i<font class="kw">%</font>2<font class="kw">==</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Text<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if(</font>$<font class="kw">this-&gt;</font>HREF<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>PutLink<font class="kw">(</font>$<font class="kw">this-&gt;</font>HREF<font class="kw">,</font>$e<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif(</font>$<font class="kw">this-&gt;</font>tdbegin<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>trim<font class="kw">(</font>$e<font class="kw">)!=</font><font class="str">'' </font><font class="kw">and </font>$e<font class="kw">!=</font><font class="str">"&amp;nbsp;"</font><font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$<font class="kw">this-&gt;</font>tdwidth<font class="kw">,</font>$<font class="kw">this-&gt;</font>tdheight<font class="kw">,</font>$e<font class="kw">,</font>$<font class="kw">this-&gt;</font>tableborder<font class="kw">,</font><font class="str">''</font><font class="kw">,</font>$<font class="kw">this-&gt;</font>tdalign<font class="kw">,</font>$<font class="kw">this-&gt;</font>tdbgcolor<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif(</font>$e<font class="kw">==</font><font class="str">"&amp;nbsp;"</font><font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$<font class="kw">this-&gt;</font>tdwidth<font class="kw">,</font>$<font class="kw">this-&gt;</font>tdheight<font class="kw">,</font><font class="str">''</font><font class="kw">,</font>$<font class="kw">this-&gt;</font>tableborder<font class="kw">,</font><font class="str">''</font><font class="kw">,</font>$<font class="kw">this-&gt;</font>tdalign<font class="kw">,</font>$<font class="kw">this-&gt;</font>tdbgcolor<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Write<font class="kw">(</font>5<font class="kw">,</font>stripslashes<font class="kw">(</font>txtentities<font class="kw">(</font>$e<font class="kw">)));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Tag<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if(</font>$e<font class="kw">{</font>0<font class="kw">}==</font><font class="str">'/'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>CloseTag<font class="kw">(</font>strtoupper<font class="kw">(</font>substr<font class="kw">(</font>$e<font class="kw">,</font>1<font class="kw">)));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Extract attributes<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$a2<font class="kw">=</font>explode<font class="kw">(</font><font class="str">' '</font><font class="kw">,</font>$e<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$tag<font class="kw">=</font>strtoupper<font class="kw">(</font>array_shift<font class="kw">(</font>$a2<font class="kw">));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$attr<font class="kw">=array();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach(</font>$a2 <font class="kw">as </font>$v<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>ereg<font class="kw">(</font><font class="str">'^([^=]*)=["\']?([^"\']*)["\']?$'</font><font class="kw">,</font>$v<font class="kw">,</font>$a3<font class="kw">))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$attr<font class="kw">[</font>strtoupper<font class="kw">(</font>$a3<font class="kw">[</font>1<font class="kw">])]=</font>$a3<font class="kw">[</font>2<font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>OpenTag<font class="kw">(</font>$tag<font class="kw">,</font>$attr<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br><br>function </font>OpenTag<font class="kw">(</font>$tag<font class="kw">,</font>$attr<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Opening tag<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">switch(</font>$tag<font class="kw">){<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'SUP'</font><font class="kw">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$attr<font class="kw">[</font><font class="str">'SUP'</font><font class="kw">] != </font><font class="str">''</font><font class="kw">) {&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Set current font to: Bold, 6pt &nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">''</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>6<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Start 125cm plus width of cell to the right of left margin &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//Superscript "1" <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>2<font class="kw">,</font>2<font class="kw">,</font>$attr<font class="kw">[</font><font class="str">'SUP'</font><font class="kw">],</font>0<font class="kw">,</font>0<font class="kw">,</font><font class="str">'L'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'TABLE'</font><font class="kw">: </font><font class="cmt">// TABLE-BEGIN<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if( </font>$attr<font class="kw">[</font><font class="str">'BORDER'</font><font class="kw">] != </font><font class="str">'' </font><font class="kw">) </font>$<font class="kw">this-&gt;</font>tableborder<font class="kw">=</font>$attr<font class="kw">[</font><font class="str">'BORDER'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else </font>$<font class="kw">this-&gt;</font>tableborder<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'TR'</font><font class="kw">: </font><font class="cmt">//TR-BEGIN<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'TD'</font><font class="kw">: </font><font class="cmt">// TD-BEGIN<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if( </font>$attr<font class="kw">[</font><font class="str">'WIDTH'</font><font class="kw">] != </font><font class="str">'' </font><font class="kw">) </font>$<font class="kw">this-&gt;</font>tdwidth<font class="kw">=(</font>$attr<font class="kw">[</font><font class="str">'WIDTH'</font><font class="kw">]/</font>4<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else </font>$<font class="kw">this-&gt;</font>tdwidth<font class="kw">=</font>40<font class="kw">; </font><font class="cmt">// SET to your own width if you need bigger fixed cells<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if( </font>$attr<font class="kw">[</font><font class="str">'HEIGHT'</font><font class="kw">] != </font><font class="str">''</font><font class="kw">) </font>$<font class="kw">this-&gt;</font>tdheight<font class="kw">=(</font>$attr<font class="kw">[</font><font class="str">'HEIGHT'</font><font class="kw">]/</font>6<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else </font>$<font class="kw">this-&gt;</font>tdheight<font class="kw">=</font>6<font class="kw">; </font><font class="cmt">// SET to your own height if you need bigger fixed cells<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if( </font>$attr<font class="kw">[</font><font class="str">'ALIGN'</font><font class="kw">] != </font><font class="str">'' </font><font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$align<font class="kw">=</font>$attr<font class="kw">[</font><font class="str">'ALIGN'</font><font class="kw">];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$align<font class="kw">==</font><font class="str">"LEFT"</font><font class="kw">) </font>$<font class="kw">this-&gt;</font>tdalign<font class="kw">=</font><font class="str">"L"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$align<font class="kw">==</font><font class="str">"CENTER"</font><font class="kw">) </font>$<font class="kw">this-&gt;</font>tdalign<font class="kw">=</font><font class="str">"C"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$align<font class="kw">==</font><font class="str">"RIGHT"</font><font class="kw">) </font>$<font class="kw">this-&gt;</font>tdalign<font class="kw">=</font><font class="str">"R"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else </font>$<font class="kw">this-&gt;</font>tdalign<font class="kw">=</font><font class="str">"L"</font><font class="kw">; </font><font class="cmt">// SET to your own<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if( </font>$attr<font class="kw">[</font><font class="str">'BGCOLOR'</font><font class="kw">] != </font><font class="str">'' </font><font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$coul<font class="kw">=</font>hex2dec<font class="kw">(</font>$attr<font class="kw">[</font><font class="str">'BGCOLOR'</font><font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFillColor<font class="kw">(</font>$coul<font class="kw">[</font><font class="str">'R'</font><font class="kw">],</font>$coul<font class="kw">[</font><font class="str">'G'</font><font class="kw">],</font>$coul<font class="kw">[</font><font class="str">'B'</font><font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tdbgcolor<font class="kw">=</font>true<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tdbegin<font class="kw">=</font>true<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'HR'</font><font class="kw">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( </font>$attr<font class="kw">[</font><font class="str">'WIDTH'</font><font class="kw">] != </font><font class="str">'' </font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$Width <font class="kw">= </font>$attr<font class="kw">[</font><font class="str">'WIDTH'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$Width <font class="kw">= </font>$<font class="kw">this-&gt;</font>w <font class="kw">- </font>$<font class="kw">this-&gt;</font>lMargin<font class="kw">-</font>$<font class="kw">this-&gt;</font>rMargin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$x <font class="kw">= </font>$<font class="kw">this-&gt;</font>GetX<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$y <font class="kw">= </font>$<font class="kw">this-&gt;</font>GetY<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetLineWidth<font class="kw">(</font>0.2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">(</font>$x<font class="kw">,</font>$y<font class="kw">,</font>$x<font class="kw">+</font>$Width<font class="kw">,</font>$y<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetLineWidth<font class="kw">(</font>0.2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Ln<font class="kw">(</font>1<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'STRONG'</font><font class="kw">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetStyle<font class="kw">(</font><font class="str">'B'</font><font class="kw">,</font>true<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'EM'</font><font class="kw">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetStyle<font class="kw">(</font><font class="str">'I'</font><font class="kw">,</font>true<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'B'</font><font class="kw">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'I'</font><font class="kw">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'U'</font><font class="kw">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetStyle<font class="kw">(</font>$tag<font class="kw">,</font>true<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'A'</font><font class="kw">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>HREF<font class="kw">=</font>$attr<font class="kw">[</font><font class="str">'HREF'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'IMG'</font><font class="kw">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset(</font>$attr<font class="kw">[</font><font class="str">'SRC'</font><font class="kw">]) and (isset(</font>$attr<font class="kw">[</font><font class="str">'WIDTH'</font><font class="kw">]) or isset(</font>$attr<font class="kw">[</font><font class="str">'HEIGHT'</font><font class="kw">]))) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!isset(</font>$attr<font class="kw">[</font><font class="str">'WIDTH'</font><font class="kw">]))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$attr<font class="kw">[</font><font class="str">'WIDTH'</font><font class="kw">] = </font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!isset(</font>$attr<font class="kw">[</font><font class="str">'HEIGHT'</font><font class="kw">]))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$attr<font class="kw">[</font><font class="str">'HEIGHT'</font><font class="kw">] = </font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Image<font class="kw">(</font>$attr<font class="kw">[</font><font class="str">'SRC'</font><font class="kw">], </font>$<font class="kw">this-&gt;</font>GetX<font class="kw">(), </font>$<font class="kw">this-&gt;</font>GetY<font class="kw">(), </font>px2mm<font class="kw">(</font>$attr<font class="kw">[</font><font class="str">'WIDTH'</font><font class="kw">]), </font>px2mm<font class="kw">(</font>$attr<font class="kw">[</font><font class="str">'HEIGHT'</font><font class="kw">]));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//case 'TR':<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">case </font><font class="str">'BLOCKQUOTE'</font><font class="kw">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'BR'</font><font class="kw">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Ln<font class="kw">(</font>5<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'P'</font><font class="kw">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Ln<font class="kw">(</font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'FONT'</font><font class="kw">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (isset(</font>$attr<font class="kw">[</font><font class="str">'COLOR'</font><font class="kw">]) and </font>$attr<font class="kw">[</font><font class="str">'COLOR'</font><font class="kw">]!=</font><font class="str">''</font><font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$coul<font class="kw">=</font>hex2dec<font class="kw">(</font>$attr<font class="kw">[</font><font class="str">'COLOR'</font><font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetTextColor<font class="kw">(</font>$coul<font class="kw">[</font><font class="str">'R'</font><font class="kw">],</font>$coul<font class="kw">[</font><font class="str">'G'</font><font class="kw">],</font>$coul<font class="kw">[</font><font class="str">'B'</font><font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>issetcolor<font class="kw">=</font>true<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (isset(</font>$attr<font class="kw">[</font><font class="str">'FACE'</font><font class="kw">]) and </font>in_array<font class="kw">(</font>strtolower<font class="kw">(</font>$attr<font class="kw">[</font><font class="str">'FACE'</font><font class="kw">]), </font>$<font class="kw">this-&gt;</font>fontlist<font class="kw">)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font>strtolower<font class="kw">(</font>$attr<font class="kw">[</font><font class="str">'FACE'</font><font class="kw">]));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>issetfont<font class="kw">=</font>true<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (isset(</font>$attr<font class="kw">[</font><font class="str">'FACE'</font><font class="kw">]) and </font>in_array<font class="kw">(</font>strtolower<font class="kw">(</font>$attr<font class="kw">[</font><font class="str">'FACE'</font><font class="kw">]), </font>$<font class="kw">this-&gt;</font>fontlist<font class="kw">) and isset(</font>$attr<font class="kw">[</font><font class="str">'SIZE'</font><font class="kw">]) and </font>$attr<font class="kw">[</font><font class="str">'SIZE'</font><font class="kw">]!=</font><font class="str">''</font><font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font>strtolower<font class="kw">(</font>$attr<font class="kw">[</font><font class="str">'FACE'</font><font class="kw">]),</font><font class="str">''</font><font class="kw">,</font>$attr<font class="kw">[</font><font class="str">'SIZE'</font><font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>issetfont<font class="kw">=</font>true<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br><br>function </font>CloseTag<font class="kw">(</font>$tag<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Closing tag<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if(</font>$tag<font class="kw">==</font><font class="str">'SUP'</font><font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$tag<font class="kw">==</font><font class="str">'TD'</font><font class="kw">) { </font><font class="cmt">// TD-END<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tdbegin<font class="kw">=</font>false<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tdwidth<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tdheight<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tdalign<font class="kw">=</font><font class="str">"L"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tdbgcolor<font class="kw">=</font>false<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$tag<font class="kw">==</font><font class="str">'TR'</font><font class="kw">) { </font><font class="cmt">// TR-END<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Ln<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$tag<font class="kw">==</font><font class="str">'TABLE'</font><font class="kw">) { </font><font class="cmt">// TABLE-END<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//$this-&gt;Ln();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tableborder<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$tag<font class="kw">==</font><font class="str">'STRONG'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$tag<font class="kw">=</font><font class="str">'B'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$tag<font class="kw">==</font><font class="str">'EM'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$tag<font class="kw">=</font><font class="str">'I'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$tag<font class="kw">==</font><font class="str">'B' </font><font class="kw">or </font>$tag<font class="kw">==</font><font class="str">'I' </font><font class="kw">or </font>$tag<font class="kw">==</font><font class="str">'U'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetStyle<font class="kw">(</font>$tag<font class="kw">,</font>false<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$tag<font class="kw">==</font><font class="str">'A'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>HREF<font class="kw">=</font><font class="str">''</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$tag<font class="kw">==</font><font class="str">'FONT'</font><font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$<font class="kw">this-&gt;</font>issetcolor<font class="kw">==</font>true<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetTextColor<font class="kw">(</font>0<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$<font class="kw">this-&gt;</font>issetfont<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">'arial'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>issetfont<font class="kw">=</font>false<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br><br>function </font>SetStyle<font class="kw">(</font>$tag<font class="kw">,</font>$enable<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Modify style and select corresponding font<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>$tag<font class="kw">+=(</font>$enable <font class="kw">? </font>1 <font class="kw">: -</font>1<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$style<font class="kw">=</font><font class="str">''</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;foreach(array(</font><font class="str">'B'</font><font class="kw">,</font><font class="str">'I'</font><font class="kw">,</font><font class="str">'U'</font><font class="kw">) as </font>$s<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>$s<font class="kw">&gt;</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$style<font class="kw">.=</font>$s<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">''</font><font class="kw">,</font>$style<font class="kw">);<br>}<br><br>function </font>PutLink<font class="kw">(</font>$URL<font class="kw">,</font>$txt<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Put a hyperlink<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetTextColor<font class="kw">(</font>0<font class="kw">,</font>0<font class="kw">,</font>255<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetStyle<font class="kw">(</font><font class="str">'U'</font><font class="kw">,</font>true<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Write<font class="kw">(</font>5<font class="kw">,</font>$txt<font class="kw">,</font>$URL<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetStyle<font class="kw">(</font><font class="str">'U'</font><font class="kw">,</font>false<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetTextColor<font class="kw">(</font>0<font class="kw">);<br>}<br><br>}</font><font class="cmt">//end of class<br><br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>

<H4 CLASS="st">Example</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br>define<font class="kw">(</font><font class="str">'FPDF_FONTPATH'</font><font class="kw">,</font><font class="str">'font/'</font><font class="kw">);<br>require(</font><font class="str">'html_table.php'</font><font class="kw">);<br><br></font>$pdf<font class="kw">=new </font>PDF<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>AddPage<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>12<font class="kw">);<br><br></font>$html<font class="kw">=</font><font class="str">'&lt;table border="1"&gt;<br>&lt;tr&gt;<br>&lt;td width="200" height="30"&gt;cell 1&lt;/td&gt;&lt;td width="200" height="30" bgcolor="#D0D0FF"&gt;cell 2&lt;/td&gt;<br>&lt;/tr&gt;<br>&lt;tr&gt;<br>&lt;td width="200" height="30"&gt;cell 3&lt;/td&gt;&lt;td width="200" height="30"&gt;cell 4&lt;/td&gt;<br>&lt;/tr&gt;<br>&lt;/table&gt;'</font><font class="kw">;<br><br></font>$pdf<font class="kw">-&gt;</font>WriteHTML<font class="kw">(</font>$html<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Output<font class="kw">();<br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>
<BR>
View the result <A HREF="ex50.pdf" TARGET="_blank">here</A>.
<H4 CLASS="st">Download</H4><A HREF="script50.zip">ZIP</A> | <A HREF="script50.tgz">TGZ</A>
</BODY>
</HTML>

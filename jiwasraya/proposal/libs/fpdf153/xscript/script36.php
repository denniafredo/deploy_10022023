<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<TITLE>JavaScript support</TITLE>
<LINK TYPE="text/css" REL="stylesheet" HREF="../fpdf.css">
</HEAD>
<BODY ONLOAD="if(window.focus) window.focus()">
<H2>JavaScript support</H2>
<H4 CLASS="st">Informations</H4>Author: <SCRIPT TYPE="text/javascript">document.write('<A H'+'REF="m'+'ailto:johannes.guentert'+'&#'+'64;'+'reservix.de?subject=JavaScript%20support">');</SCRIPT>Johannes Güntert<SCRIPT TYPE="text/javascript">document.write('<\/A>');</SCRIPT><BR>License: Freeware
<H4 CLASS="st">Description</H4>This extension allows to embed some JavaScript inside the PDF. The code is executed on document
opening.<BR>
The Acrobat JavaScript reference is available <A HREF="http://partners.adobe.com/public/developer/pdf/topic_js.html" TARGET="_blank">here</A>.
<H4 CLASS="st">Source</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br><font class="kw">require(</font><font class="str">'fpdf.php'</font><font class="kw">);<br><br>class </font>PDF_Javascript <font class="kw">extends </font>FPDF <font class="kw">{<br><br>&nbsp;&nbsp;&nbsp;&nbsp;var </font>$javascript<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;var </font>$n_js<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;function </font>IncludeJS<font class="kw">(</font>$script<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>javascript<font class="kw">=</font>$script<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;function </font>_putjavascript<font class="kw">() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_newobj<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>n_js<font class="kw">=</font>$<font class="kw">this-&gt;</font>n<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font><font class="str">'&lt;&lt;'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font><font class="str">'/Names [(EmbeddedJS) '</font><font class="kw">.(</font>$<font class="kw">this-&gt;</font>n<font class="kw">+</font>1<font class="kw">).</font><font class="str">' 0 R ]'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font><font class="str">'&gt;&gt;'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font><font class="str">'endobj'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_newobj<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font><font class="str">'&lt;&lt;'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font><font class="str">'/S /JavaScript'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font><font class="str">'/JS '</font><font class="kw">.</font>$<font class="kw">this-&gt;</font>_textstring<font class="kw">(</font>$<font class="kw">this-&gt;</font>javascript<font class="kw">));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font><font class="str">'&gt;&gt;'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font><font class="str">'endobj'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;function </font>_putresources<font class="kw">() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">parent::</font>_putresources<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!empty(</font>$<font class="kw">this-&gt;</font>javascript<font class="kw">)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_putjavascript<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;function </font>_putcatalog<font class="kw">() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">parent::</font>_putcatalog<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (isset(</font>$<font class="kw">this-&gt;</font>javascript<font class="kw">)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font><font class="str">'/Names &lt;&lt;/JavaScript '</font><font class="kw">.(</font>$<font class="kw">this-&gt;</font>n_js<font class="kw">).</font><font class="str">' 0 R&gt;&gt;'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>

<H4 CLASS="st">Example</H4>This example shows how to start printing as soon as the document opens. It is possible to
launch the print dialog (pass true to the AutoPrint() method), or directly print with default
parameters (pass false).<BR>
<BR>
<TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br>define<font class="kw">(</font><font class="str">'FPDF_FONTPATH'</font><font class="kw">,</font><font class="str">'font/'</font><font class="kw">);<br>require(</font><font class="str">'fpdf_js.php'</font><font class="kw">);<br><br>class </font>PDF_AutoPrint <font class="kw">extends </font>PDF_Javascript<br><font class="kw">{<br>function </font>AutoPrint<font class="kw">(</font>$dialog<font class="kw">=</font>false<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Launch the print dialog or start printing immediately on the standard printer<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$param<font class="kw">=(</font>$dialog <font class="kw">? </font><font class="str">'true' </font><font class="kw">: </font><font class="str">'false'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$script<font class="kw">=</font><font class="str">"print($param);"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>IncludeJS<font class="kw">(</font>$script<font class="kw">);<br>}<br><br>function </font>AutoPrintToPrinter<font class="kw">(</font>$server<font class="kw">, </font>$printer<font class="kw">, </font>$dialog<font class="kw">=</font>false<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Print on a shared printer (requires at least Acrobat 6)<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$script <font class="kw">= </font><font class="str">"var pp = getPrintParams();"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$dialog<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$script <font class="kw">.= </font><font class="str">"pp.interactive = pp.constants.interactionLevel.full;"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$script <font class="kw">.= </font><font class="str">"pp.interactive = pp.constants.interactionLevel.automatic;"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$script <font class="kw">.= </font><font class="str">"pp.printerName = '\\\\\\\\"</font><font class="kw">.</font>$server<font class="kw">.</font><font class="str">"\\\\"</font><font class="kw">.</font>$printer<font class="kw">.</font><font class="str">"';"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$script <font class="kw">.= </font><font class="str">"print(pp);"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>IncludeJS<font class="kw">(</font>$script<font class="kw">);<br>}<br>}<br><br></font>$pdf<font class="kw">=new </font>PDF_AutoPrint<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>Open<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>AddPage<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>20<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Text<font class="kw">(</font>90<font class="kw">, </font>50<font class="kw">, </font><font class="str">'Print me!'</font><font class="kw">);<br></font><font class="cmt">//Launch the print dialog<br></font>$pdf<font class="kw">-&gt;</font>AutoPrint<font class="kw">(</font>true<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Output<font class="kw">();<br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>
<BR>
View the result <A HREF="ex36.pdf" TARGET="_blank">here</A>.
<H4 CLASS="st">Download</H4><A HREF="script36.zip">ZIP</A> | <A HREF="script36.tgz">TGZ</A>
</BODY>
</HTML>

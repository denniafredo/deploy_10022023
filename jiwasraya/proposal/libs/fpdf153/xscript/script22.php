<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<TITLE>Example with MS Access</TITLE>
<LINK TYPE="text/css" REL="stylesheet" HREF="../fpdf.css">
</HEAD>
<BODY ONLOAD="if(window.focus) window.focus()">
<H2>Example with MS Access</H2>
<H4 CLASS="st">Informations</H4>Author: Goldboy<BR>License: Freeware
<H4 CLASS="st">Description</H4>This is an example how to generate a PDF file from an MS Access database through ODBC.<BR>
It requires to setup the data source name 'COFFEE' first.
<H4 CLASS="st">Source</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br>define<font class="kw">(</font><font class="str">'FPDF_FONTPATH'</font><font class="kw">,</font><font class="str">'font/'</font><font class="kw">);<br>require(</font><font class="str">'fpdf.php'</font><font class="kw">);<br><br>class </font>PDF <font class="kw">extends </font>FPDF<br><font class="kw">{<br>function </font>Table<font class="kw">(</font>$col<font class="kw">,</font>$sql<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;global </font>$conn<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Query<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$res<font class="kw">=</font>odbc_do<font class="kw">(</font>$conn<font class="kw">,</font>$sql<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;if(!</font>$res<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die(</font><font class="str">'SQL error'</font><font class="kw">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Header<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFillColor<font class="kw">(</font>255<font class="kw">,</font>0<font class="kw">,</font>0<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetTextColor<font class="kw">(</font>255<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetDrawColor<font class="kw">(</font>128<font class="kw">,</font>0<font class="kw">,</font>0<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetLineWidth<font class="kw">(</font>.3<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">''</font><font class="kw">,</font><font class="str">'B'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$tw<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;foreach(</font>$col <font class="kw">as </font>$label<font class="kw">=&gt;</font>$width<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$tw<font class="kw">+=</font>$width<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$width<font class="kw">,</font>7<font class="kw">,</font>$label<font class="kw">,</font>1<font class="kw">,</font>0<font class="kw">,</font><font class="str">'C'</font><font class="kw">,</font>1<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Ln<font class="kw">();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Rows<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFillColor<font class="kw">(</font>224<font class="kw">,</font>235<font class="kw">,</font>255<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetTextColor<font class="kw">(</font>0<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">''</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$fill<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;while(</font>odbc_fetch_row<font class="kw">(</font>$res<font class="kw">))<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach(</font>$col <font class="kw">as </font>$field<font class="kw">=&gt;</font>$width<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$width<font class="kw">,</font>6<font class="kw">,</font>odbc_result<font class="kw">(</font>$res<font class="kw">,</font>$field<font class="kw">),</font><font class="str">'LR'</font><font class="kw">,</font>0<font class="kw">,</font><font class="str">'L'</font><font class="kw">,</font>$fill<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Ln<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$fill<font class="kw">=!</font>$fill<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$tw<font class="kw">,</font>0<font class="kw">,</font><font class="str">''</font><font class="kw">,</font><font class="str">'T'</font><font class="kw">);<br>}<br>}<br><br></font>$conn<font class="kw">=</font>odbc_connect<font class="kw">(</font><font class="str">'COFFEE'</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font><font class="str">''</font><font class="kw">);<br>if(!</font>$conn<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;die(</font><font class="str">'Connection failed'</font><font class="kw">);<br></font>$pdf<font class="kw">=new </font>PDF<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>Open<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>AddPage<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>14<font class="kw">);<br></font>$sql<font class="kw">=</font><font class="str">'SELECT COFFEE_NAME, ROAST_TYPE, QUANTITY FROM COFFEE_INVENTORY ORDER BY QUANTITY DESC'</font><font class="kw">;<br></font>$pdf<font class="kw">-&gt;</font>Table<font class="kw">(array(</font><font class="str">'COFFEE_NAME'</font><font class="kw">=&gt;</font>50<font class="kw">,</font><font class="str">'ROAST_TYPE'</font><font class="kw">=&gt;</font>40<font class="kw">,</font><font class="str">'QUANTITY'</font><font class="kw">=&gt;</font>100<font class="kw">),</font>$sql<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Output<font class="kw">();<br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>
<BR>
View the result <A HREF="coffee.pdf" TARGET="_blank">here</A>.
<H4 CLASS="st">Download</H4><A HREF="script22.zip">ZIP</A> | <A HREF="script22.tgz">TGZ</A>
</BODY>
</HTML>

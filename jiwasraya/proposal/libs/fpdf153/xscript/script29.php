<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<TITLE>Labels</TITLE>
<LINK TYPE="text/css" REL="stylesheet" HREF="../fpdf.css">
</HEAD>
<BODY ONLOAD="if(window.focus) window.focus()">
<H2>Labels</H2>
<H4 CLASS="st">Informations</H4>Author: <SCRIPT TYPE="text/javascript">document.write('<A H'+'REF="m'+'ailto:lpasseb'+'&#'+'64;'+'numericable.fr?subject=Labels">');</SCRIPT>LPA<SCRIPT TYPE="text/javascript">document.write('<\/A>');</SCRIPT><BR>License: Freeware
<H4 CLASS="st">Description</H4>This class allows to print labels easily, whatever the format (AVERY or custom).
<H4 CLASS="st">Source</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br><font class="cmt">////////////////////////////////////////////////////<br>// PDF_Label <br>//<br>// Class to print labels in Avery or custom formats<br>//<br>//<br>// Copyright (C) 2003 Laurent PASSEBECQ (LPA)<br>// Based on code by Steve Dillon : steved@mad.scientist.com<br>//<br>//-------------------------------------------------------------------<br>// VERSIONS :<br>// 1.0&nbsp;&nbsp;: Initial release<br>// 1.1&nbsp;&nbsp;: + : Added unit in the constructor<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ : Now Positions start @ (1,1).. then the first image @top-left of a page is (1,1)<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ : Added in the description of a label : <br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size&nbsp;&nbsp;&nbsp;&nbsp;: defaut char size (can be changed by calling Set_Char_Size(xx);<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paper-size&nbsp;&nbsp;&nbsp;&nbsp;: Size of the paper for this sheet (thanx to Al Canton)<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;metric&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: type of unit used in this description<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You can define your label properties in inches by setting metric to 'in'<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and printing in millimiter by setting unit to 'mm' in constructor.<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Added some labels :<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5160, 5161, 5162, 5163,5164 : thanx to Al Canton : acanton@adams-blake.com<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8600 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: thanx to Kunal Walia : kunal@u.washington.edu<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ : Added 3mm to the position of labels to avoid errors <br>// 1.2&nbsp;&nbsp;: + : Added Set_Font_Name method<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= : Bug of positioning<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= : Set_Font_Size modified -&gt; Now, just modify the size of the font<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= : Set_Char_Size renamed to Set_Font_Size<br>////////////////////////////////////////////////////<br><br>/**<br> * PDF_Label - PDF label editing<br> * @package PDF_Label<br> * @author Laurent PASSEBECQ &lt;lpasseb@numericable.fr&gt;<br> * @copyright 2003 Laurent PASSEBECQ<br>**/<br><br></font><font class="kw">require_once(</font><font class="str">'fpdf.php'</font><font class="kw">);<br><br>class </font>PDF_Label <font class="kw">extends </font>FPDF <font class="kw">{<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Private properties<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">var </font>$_Avery_Name&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font><font class="str">''</font><font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Name of format<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">var </font>$_Margin_Left&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>0<font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Left margin of labels<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">var </font>$_Margin_Top&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>0<font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Top margin of labels<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">var </font>$_X_Space &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>0<font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Horizontal space between 2 labels<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">var </font>$_Y_Space &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>0<font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Vertical space between 2 labels<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">var </font>$_X_Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>0<font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Number of labels horizontally<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">var </font>$_Y_Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>0<font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Number of labels vertically<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">var </font>$_Width &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>0<font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Width of label<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">var </font>$_Height &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>0<font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Height of label<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">var </font>$_Char_Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>10<font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Character size<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">var </font>$_Line_Height&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>10<font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Default line height<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">var </font>$_Metric &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font><font class="str">'mm'</font><font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Type of metric for labels.. Will help to calculate good values<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">var </font>$_Metric_Doc &nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font><font class="str">'mm'</font><font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Type of metric for the document<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">var </font>$_Font_Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font><font class="str">'Arial'</font><font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Name of the font<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">var </font>$_COUNTX <font class="kw">= </font>1<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;var </font>$_COUNTY <font class="kw">= </font>1<font class="kw">;<br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Listing of labels size<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">var </font>$_Avery_Labels <font class="kw">= array (<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'5160'</font><font class="kw">=&gt;array(</font><font class="str">'name'</font><font class="kw">=&gt;</font><font class="str">'5160'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'paper-size'</font><font class="kw">=&gt;</font><font class="str">'letter'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'metric'</font><font class="kw">=&gt;</font><font class="str">'mm'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'marginLeft'</font><font class="kw">=&gt;</font>1.762<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'marginTop'</font><font class="kw">=&gt;</font>10.7<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'NX'</font><font class="kw">=&gt;</font>3<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'NY'</font><font class="kw">=&gt;</font>10<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'SpaceX'</font><font class="kw">=&gt;</font>3.175<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'SpaceY'</font><font class="kw">=&gt;</font>0<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'width'</font><font class="kw">=&gt;</font>66.675<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'height'</font><font class="kw">=&gt;</font>25.4<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'font-size'</font><font class="kw">=&gt;</font>8<font class="kw">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'5161'</font><font class="kw">=&gt;array(</font><font class="str">'name'</font><font class="kw">=&gt;</font><font class="str">'5161'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'paper-size'</font><font class="kw">=&gt;</font><font class="str">'letter'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'metric'</font><font class="kw">=&gt;</font><font class="str">'mm'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'marginLeft'</font><font class="kw">=&gt;</font>0.967<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'marginTop'</font><font class="kw">=&gt;</font>10.7<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'NX'</font><font class="kw">=&gt;</font>2<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'NY'</font><font class="kw">=&gt;</font>10<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'SpaceX'</font><font class="kw">=&gt;</font>3.967<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'SpaceY'</font><font class="kw">=&gt;</font>0<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'width'</font><font class="kw">=&gt;</font>101.6<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'height'</font><font class="kw">=&gt;</font>25.4<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'font-size'</font><font class="kw">=&gt;</font>8<font class="kw">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'5162'</font><font class="kw">=&gt;array(</font><font class="str">'name'</font><font class="kw">=&gt;</font><font class="str">'5162'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'paper-size'</font><font class="kw">=&gt;</font><font class="str">'letter'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'metric'</font><font class="kw">=&gt;</font><font class="str">'mm'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'marginLeft'</font><font class="kw">=&gt;</font>0.97<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'marginTop'</font><font class="kw">=&gt;</font>20.224<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'NX'</font><font class="kw">=&gt;</font>2<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'NY'</font><font class="kw">=&gt;</font>7<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'SpaceX'</font><font class="kw">=&gt;</font>4.762<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'SpaceY'</font><font class="kw">=&gt;</font>0<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'width'</font><font class="kw">=&gt;</font>100.807<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'height'</font><font class="kw">=&gt;</font>35.72<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'font-size'</font><font class="kw">=&gt;</font>8<font class="kw">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'5163'</font><font class="kw">=&gt;array(</font><font class="str">'name'</font><font class="kw">=&gt;</font><font class="str">'5163'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'paper-size'</font><font class="kw">=&gt;</font><font class="str">'letter'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'metric'</font><font class="kw">=&gt;</font><font class="str">'mm'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'marginLeft'</font><font class="kw">=&gt;</font>1.762<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'marginTop'</font><font class="kw">=&gt;</font>10.7<font class="kw">, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'NX'</font><font class="kw">=&gt;</font>2<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'NY'</font><font class="kw">=&gt;</font>5<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'SpaceX'</font><font class="kw">=&gt;</font>3.175<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'SpaceY'</font><font class="kw">=&gt;</font>0<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'width'</font><font class="kw">=&gt;</font>101.6<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'height'</font><font class="kw">=&gt;</font>50.8<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'font-size'</font><font class="kw">=&gt;</font>8<font class="kw">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'5164'</font><font class="kw">=&gt;array(</font><font class="str">'name'</font><font class="kw">=&gt;</font><font class="str">'5164'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'paper-size'</font><font class="kw">=&gt;</font><font class="str">'letter'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'metric'</font><font class="kw">=&gt;</font><font class="str">'in'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'marginLeft'</font><font class="kw">=&gt;</font>0.148<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'marginTop'</font><font class="kw">=&gt;</font>0.5<font class="kw">, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'NX'</font><font class="kw">=&gt;</font>2<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'NY'</font><font class="kw">=&gt;</font>3<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'SpaceX'</font><font class="kw">=&gt;</font>0.2031<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'SpaceY'</font><font class="kw">=&gt;</font>0<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'width'</font><font class="kw">=&gt;</font>4.0<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'height'</font><font class="kw">=&gt;</font>3.33<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'font-size'</font><font class="kw">=&gt;</font>12<font class="kw">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'8600'</font><font class="kw">=&gt;array(</font><font class="str">'name'</font><font class="kw">=&gt;</font><font class="str">'8600'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'paper-size'</font><font class="kw">=&gt;</font><font class="str">'letter'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'metric'</font><font class="kw">=&gt;</font><font class="str">'mm'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'marginLeft'</font><font class="kw">=&gt;</font>7.1<font class="kw">, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'marginTop'</font><font class="kw">=&gt;</font>19<font class="kw">, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'NX'</font><font class="kw">=&gt;</font>3<font class="kw">, &nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'NY'</font><font class="kw">=&gt;</font>10<font class="kw">, &nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'SpaceX'</font><font class="kw">=&gt;</font>9.5<font class="kw">, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'SpaceY'</font><font class="kw">=&gt;</font>3.1<font class="kw">, &nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'width'</font><font class="kw">=&gt;</font>66.6<font class="kw">, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'height'</font><font class="kw">=&gt;</font>25.4<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'font-size'</font><font class="kw">=&gt;</font>8<font class="kw">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'L7163'</font><font class="kw">=&gt;array(</font><font class="str">'name'</font><font class="kw">=&gt;</font><font class="str">'L7163'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'paper-size'</font><font class="kw">=&gt;</font><font class="str">'A4'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'metric'</font><font class="kw">=&gt;</font><font class="str">'mm'</font><font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'marginLeft'</font><font class="kw">=&gt;</font>5<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'marginTop'</font><font class="kw">=&gt;</font>15<font class="kw">, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'NX'</font><font class="kw">=&gt;</font>2<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'NY'</font><font class="kw">=&gt;</font>7<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'SpaceX'</font><font class="kw">=&gt;</font>25<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'SpaceY'</font><font class="kw">=&gt;</font>0<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'width'</font><font class="kw">=&gt;</font>99.1<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'height'</font><font class="kw">=&gt;</font>38.1<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">'font-size'</font><font class="kw">=&gt;</font>9<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// convert units (in to mm, mm to in)<br>&nbsp;&nbsp;&nbsp;&nbsp;// $src and $dest must be 'in' or 'mm'<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">function </font>_Convert_Metric <font class="kw">(</font>$value<font class="kw">, </font>$src<font class="kw">, </font>$dest<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$src <font class="kw">!= </font>$dest<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$tab<font class="kw">[</font><font class="str">'in'</font><font class="kw">] = </font>39.37008<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$tab<font class="kw">[</font><font class="str">'mm'</font><font class="kw">] = </font>1000<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return </font>$value <font class="kw">* </font>$tab<font class="kw">[</font>$dest<font class="kw">] / </font>$tab<font class="kw">[</font>$src<font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return </font>$value<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Give the height for a char size given.<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">function </font>_Get_Height_Chars<font class="kw">(</font>$pt<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Array matching character sizes and line heights<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$_Table_Hauteur_Chars <font class="kw">= array(</font>6<font class="kw">=&gt;</font>2<font class="kw">, </font>7<font class="kw">=&gt;</font>2.5<font class="kw">, </font>8<font class="kw">=&gt;</font>3<font class="kw">, </font>9<font class="kw">=&gt;</font>4<font class="kw">, </font>10<font class="kw">=&gt;</font>5<font class="kw">, </font>11<font class="kw">=&gt;</font>6<font class="kw">, </font>12<font class="kw">=&gt;</font>7<font class="kw">, </font>13<font class="kw">=&gt;</font>8<font class="kw">, </font>14<font class="kw">=&gt;</font>9<font class="kw">, </font>15<font class="kw">=&gt;</font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>in_array<font class="kw">(</font>$pt<font class="kw">, </font>array_keys<font class="kw">(</font>$_Table_Hauteur_Chars<font class="kw">))) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return </font>$_Table_Hauteur_Chars<font class="kw">[</font>$pt<font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return </font>100<font class="kw">; </font><font class="cmt">// There is a prob..<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;function </font>_Set_Format<font class="kw">(</font>$format<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Metric &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>$format<font class="kw">[</font><font class="str">'metric'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Avery_Name &nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>$format<font class="kw">[</font><font class="str">'name'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Margin_Left&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>_Convert_Metric <font class="kw">(</font>$format<font class="kw">[</font><font class="str">'marginLeft'</font><font class="kw">], </font>$<font class="kw">this-&gt;</font>_Metric<font class="kw">, </font>$<font class="kw">this-&gt;</font>_Metric_Doc<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Margin_Top&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>_Convert_Metric <font class="kw">(</font>$format<font class="kw">[</font><font class="str">'marginTop'</font><font class="kw">], </font>$<font class="kw">this-&gt;</font>_Metric<font class="kw">, </font>$<font class="kw">this-&gt;</font>_Metric_Doc<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_X_Space &nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>_Convert_Metric <font class="kw">(</font>$format<font class="kw">[</font><font class="str">'SpaceX'</font><font class="kw">], </font>$<font class="kw">this-&gt;</font>_Metric<font class="kw">, </font>$<font class="kw">this-&gt;</font>_Metric_Doc<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Y_Space &nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>_Convert_Metric <font class="kw">(</font>$format<font class="kw">[</font><font class="str">'SpaceY'</font><font class="kw">], </font>$<font class="kw">this-&gt;</font>_Metric<font class="kw">, </font>$<font class="kw">this-&gt;</font>_Metric_Doc<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_X_Number &nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>$format<font class="kw">[</font><font class="str">'NX'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Y_Number &nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>$format<font class="kw">[</font><font class="str">'NY'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Width &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>_Convert_Metric <font class="kw">(</font>$format<font class="kw">[</font><font class="str">'width'</font><font class="kw">], </font>$<font class="kw">this-&gt;</font>_Metric<font class="kw">, </font>$<font class="kw">this-&gt;</font>_Metric_Doc<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Height&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>_Convert_Metric <font class="kw">(</font>$format<font class="kw">[</font><font class="str">'height'</font><font class="kw">], </font>$<font class="kw">this-&gt;</font>_Metric<font class="kw">, </font>$<font class="kw">this-&gt;</font>_Metric_Doc<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Set_Font_Size<font class="kw">(</font>$format<font class="kw">[</font><font class="str">'font-size'</font><font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Constructor<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">function </font>PDF_Label <font class="kw">(</font>$format<font class="kw">, </font>$unit<font class="kw">=</font><font class="str">'mm'</font><font class="kw">, </font>$posX<font class="kw">=</font>1<font class="kw">, </font>$posY<font class="kw">=</font>1<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>is_array<font class="kw">(</font>$format<font class="kw">)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Custom format<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$Tformat <font class="kw">= </font>$format<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Avery format<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$Tformat <font class="kw">= </font>$<font class="kw">this-&gt;</font>_Avery_Labels<font class="kw">[</font>$format<font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">parent::</font>FPDF<font class="kw">(</font><font class="str">'P'</font><font class="kw">, </font>$Tformat<font class="kw">[</font><font class="str">'metric'</font><font class="kw">], </font>$Tformat<font class="kw">[</font><font class="str">'paper-size'</font><font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Set_Format<font class="kw">(</font>$Tformat<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Set_Font_Name<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetMargins<font class="kw">(</font>0<font class="kw">,</font>0<font class="kw">); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetAutoPageBreak<font class="kw">(</font>false<font class="kw">); <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Metric_Doc <font class="kw">= </font>$unit<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Start at the given label position<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if (</font>$posX <font class="kw">&gt; </font>1<font class="kw">) </font>$posX<font class="kw">--; else </font>$posX<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$posY <font class="kw">&gt; </font>1<font class="kw">) </font>$posY<font class="kw">--; else </font>$posY<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$posX <font class="kw">&gt;=&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_X_Number<font class="kw">) </font>$posX <font class="kw">=&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_X_Number<font class="kw">-</font>1<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$posY <font class="kw">&gt;=&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Y_Number<font class="kw">) </font>$posY <font class="kw">=&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Y_Number<font class="kw">-</font>1<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_COUNTX <font class="kw">= </font>$posX<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_COUNTY <font class="kw">= </font>$posY<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Sets the character size<br>&nbsp;&nbsp;&nbsp;&nbsp;// This changes the line height too<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">function </font>Set_Font_Size<font class="kw">(</font>$pt<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$pt <font class="kw">&gt; </font>3<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Char_Size <font class="kw">= </font>$pt<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Line_Height <font class="kw">= </font>$<font class="kw">this-&gt;</font>_Get_Height_Chars<font class="kw">(</font>$pt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFontSize<font class="kw">(</font>$<font class="kw">this-&gt;</font>_Char_Size<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Method to change font name<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">function </font>Set_Font_Name<font class="kw">(</font>$fontname<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$fontname <font class="kw">!= </font><font class="str">''</font><font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Font_Name <font class="kw">= </font>$fontname<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font>$<font class="kw">this-&gt;</font>_Font_Name<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Print a label<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">function </font>Add_PDF_Label<font class="kw">(</font>$texte<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// We are in a new page, then we must add a page<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if ((</font>$<font class="kw">this-&gt;</font>_COUNTX <font class="kw">==</font>0<font class="kw">) and (</font>$<font class="kw">this-&gt;</font>_COUNTY<font class="kw">==</font>0<font class="kw">)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>AddPage<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$_PosX <font class="kw">= </font>$<font class="kw">this-&gt;</font>_Margin_Left<font class="kw">+(</font>$<font class="kw">this-&gt;</font>_COUNTX<font class="kw">*(</font>$<font class="kw">this-&gt;</font>_Width<font class="kw">+</font>$<font class="kw">this-&gt;</font>_X_Space<font class="kw">));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$_PosY <font class="kw">= </font>$<font class="kw">this-&gt;</font>_Margin_Top<font class="kw">+(</font>$<font class="kw">this-&gt;</font>_COUNTY<font class="kw">*(</font>$<font class="kw">this-&gt;</font>_Height<font class="kw">+</font>$<font class="kw">this-&gt;</font>_Y_Space<font class="kw">));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>$_PosX<font class="kw">+</font>3<font class="kw">, </font>$_PosY<font class="kw">+</font>3<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>MultiCell<font class="kw">(</font>$<font class="kw">this-&gt;</font>_Width<font class="kw">, </font>$<font class="kw">this-&gt;</font>_Line_Height<font class="kw">, </font>$texte<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_COUNTY<font class="kw">++;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$<font class="kw">this-&gt;</font>_COUNTY <font class="kw">== </font>$<font class="kw">this-&gt;</font>_Y_Number<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// End of column reached, we start a new one<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_COUNTX<font class="kw">++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_COUNTY<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$<font class="kw">this-&gt;</font>_COUNTX <font class="kw">== </font>$<font class="kw">this-&gt;</font>_X_Number<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// Page full, we start a new one<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_COUNTX<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_COUNTY<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>}<br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>

<H4 CLASS="st">Example</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br>define<font class="kw">(</font><font class="str">'FPDF_FONTPATH'</font><font class="kw">,</font><font class="str">'font/'</font><font class="kw">);<br>require_once(</font><font class="str">'PDF_Label.php'</font><font class="kw">);<br><br></font><font class="cmt">/*-------------------------------------------------<br>To create the object, 2 possibilities:<br>either pass a custom format via an array<br>or use a built-in AVERY name<br>-------------------------------------------------*/<br><br>// Example of custom format; we start at the second column<br>//$pdf = new PDF_Label(array('name'=&gt;'perso1', 'paper-size'=&gt;'A4', 'marginLeft'=&gt;1, 'marginTop'=&gt;1, 'NX'=&gt;2, 'NY'=&gt;7, 'SpaceX'=&gt;0, 'SpaceY'=&gt;0, 'width'=&gt;99.1, 'height'=&gt;38.1, 'metric'=&gt;'mm', 'font-size'=&gt;14), 1, 2);<br>// Standard format<br></font>$pdf <font class="kw">= new </font>PDF_Label<font class="kw">(</font><font class="str">'L7163'</font><font class="kw">, </font><font class="str">'mm'</font><font class="kw">, </font>1<font class="kw">, </font>2<font class="kw">);<br><br></font>$pdf<font class="kw">-&gt;</font>Open<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>AddPage<font class="kw">();<br><br></font><font class="cmt">// Print labels<br></font><font class="kw">for(</font>$i<font class="kw">=</font>1<font class="kw">;</font>$i<font class="kw">&lt;=</font>40<font class="kw">;</font>$i<font class="kw">++)<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$pdf<font class="kw">-&gt;</font>Add_PDF_Label<font class="kw">(</font>sprintf<font class="kw">(</font><font class="str">"%s\n%s\n%s\n%s, %s, %s"</font><font class="kw">, </font><font class="str">"Laurent $i"</font><font class="kw">, </font><font class="str">'Immeuble Titi'</font><font class="kw">, </font><font class="str">'av. fragonard'</font><font class="kw">, </font><font class="str">'06000'</font><font class="kw">, </font><font class="str">'NICE'</font><font class="kw">, </font><font class="str">'FRANCE'</font><font class="kw">));<br><br></font>$pdf<font class="kw">-&gt;</font>Output<font class="kw">();<br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>
<BR>
View the result <A HREF="ex29.pdf" TARGET="_blank">here</A>.
<H4 CLASS="st">Download</H4><A HREF="script29.zip">ZIP</A> | <A HREF="script29.tgz">TGZ</A>
</BODY>
</HTML>

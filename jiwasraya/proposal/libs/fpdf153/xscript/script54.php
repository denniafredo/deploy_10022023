<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<TITLE>Table</TITLE>
<LINK TYPE="text/css" REL="stylesheet" HREF="../fpdf.css">
</HEAD>
<BODY ONLOAD="if(window.focus) window.focus()">
<H2>Table</H2>
<H4 CLASS="st">Informations</H4>Author: <SCRIPT TYPE="text/javascript">document.write('<A H'+'REF="m'+'ailto:klodoma'+'&#'+'64;'+'ar-sd.net?subject=Table">');</SCRIPT>Andrei Bintintan<SCRIPT TYPE="text/javascript">document.write('<\/A>');</SCRIPT><BR>License: Free for non-commercial use
<H4 CLASS="st">Description</H4>This script allows to produce tables with the following features:
<UL>
<LI>The header is printed automatically on each page
<LI>You can set styles for header and data rows
<LI>The style can be overriden for every cell
<LI>Columns can be spanned
<LI>The cell content wraps if necessary
<LI>Every cell has the <A HREF='script81.php'>MultiCellTag</A> method functionality
</UL>
See the class and example for details on the methods and parameters.
<H4 CLASS="st">Source</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br><font class="cmt">/****************************************************************************<br>* Software: FPDF class extention&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates Pdf Tables&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>* Version:&nbsp;&nbsp;3.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>* Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2005/07/20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>* Author:&nbsp;&nbsp;&nbsp;Bintintan Andrei&nbsp;&nbsp;-- klodoma@ar-sd.net&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>* Last Modification: 2006/09/25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>* License:&nbsp;&nbsp;Free for non-commercial use&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>* You may use and modify this software as you wish.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>* PLEASE REPORT ANY BUGS TO THE AUTHOR. THANK YOU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>****************************************************************************/<br>/**<br>Modifications:<br>2006.09.25<br>&nbsp;&nbsp;&nbsp;&nbsp;- corrected a bug for empty cell texts<br>&nbsp;&nbsp;&nbsp;&nbsp;- corrected a bug for cell lines aligment error on new page<br>2006.05.18<br>&nbsp;&nbsp;&nbsp;&nbsp;- added support for cell splitting if new page ocuurs. FPDF_TABLE::Set_Table_SplitMode(true/false)<br>&nbsp;&nbsp;&nbsp;&nbsp;sets the splitting mode.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true = normal mode, the cell is splitted where the split ocuurs.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false = if splitting is required then the cell is drawed on the new page. If the cell<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Height is bigger then the page height then the cell will be splitted.<br>&nbsp;&nbsp;&nbsp;&nbsp;- if the header does not have enough space for double it's Height then a new page ocuurs.<br>*/<br></font><font class="kw">require_once(</font><font class="str">'class.multicelltag.php'</font><font class="kw">);<br><br></font><font class="cmt">//extension class<br></font><font class="kw">class </font>FPDF_TABLE <font class="kw">extends </font>FPDF_MULTICELLTAG<br><font class="kw">{<br><br>var </font>$tb_columns<font class="kw">; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//number of columns of the table<br></font><font class="kw">var </font>$tb_header_type<font class="kw">; &nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//array which contains the header characteristics and texts<br></font><font class="kw">var </font>$tb_header_draw<font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//TRUE or FALSE, the header is drawed or not<br></font><font class="kw">var </font>$tb_header_height<font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//This is the Table Header Maximum Height<br></font><font class="kw">var </font>$tb_border_draw<font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//TRUE or FALSE, the table border is drawed or not<br></font><font class="kw">var </font>$tb_data_type<font class="kw">; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//array which contains the data characteristics (only the characteristics)<br></font><font class="kw">var </font>$tb_table_type<font class="kw">; &nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//array which contains the table charactersitics<br></font><font class="kw">var </font>$table_startx<font class="kw">, </font>$table_starty<font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//the X and Y position where the table starts<br></font><font class="kw">var </font>$tb_split_normal<font class="kw">;&nbsp;&nbsp;&nbsp;</font><font class="cmt">/*&nbsp;&nbsp;&lt;&lt; ** special request from Marc Ulfig &gt;&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= false - the split is made only if the cell width does not fit into a page height<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= true - the split of a cell will ocuur whenever necesary<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br></font><font class="kw">var </font>$Draw_Header_Command<font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//command which determines in the DrawData first the header draw<br></font><font class="kw">var </font>$Data_On_Current_Page<font class="kw">; </font><font class="cmt">// = true/false ... if on current page was some data written<br><br>//returns the width of the page in user units<br></font><font class="kw">function </font>PageWidth<font class="kw">(){<br>&nbsp;&nbsp;&nbsp;&nbsp;return (int) </font>$<font class="kw">this-&gt;</font>w<font class="kw">-</font>$<font class="kw">this-&gt;</font>rMargin<font class="kw">-</font>$<font class="kw">this-&gt;</font>lMargin<font class="kw">;<br>}<br><br></font><font class="cmt">//constructor(not a real one, but have to call it first)<br>//we initialize all the variables that we use<br></font><font class="kw">function </font>Table_Init<font class="kw">(</font>$col_no <font class="kw">= </font>0<font class="kw">, </font>$header_draw <font class="kw">= </font>true<font class="kw">, </font>$border_draw <font class="kw">= </font>true<font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tb_columns <font class="kw">= </font>$col_no<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tb_header_type <font class="kw">= Array();<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tb_header_draw <font class="kw">= </font>$header_draw<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tb_header_height <font class="kw">= </font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tb_border_draw <font class="kw">= </font>$border_draw<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tb_data_type <font class="kw">= Array();<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tb_split_normal <font class="kw">= </font>true<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tb_type <font class="kw">= Array();<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>table_startx <font class="kw">= </font>$<font class="kw">this-&gt;</font>GetX<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>table_starty <font class="kw">= </font>$<font class="kw">this-&gt;</font>GetY<font class="kw">();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Draw_Header_Command <font class="kw">= </font>false<font class="kw">; </font><font class="cmt">//by default we don't draw the header<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Data_On_Current_Page <font class="kw">= </font>false<font class="kw">;<br>}<br><br></font><font class="cmt">//Sets the number of columns of the table<br></font><font class="kw">function </font>Set_Table_Columns<font class="kw">(</font>$nr<font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tb_columns <font class="kw">= </font>$nr<font class="kw">;<br>}<br><br></font><font class="cmt">//Sets the number of columns of the table<br></font><font class="kw">function </font>Set_Table_SplitMode<font class="kw">(</font>$pSplit <font class="kw">= </font>true<font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tb_split_normal <font class="kw">= </font>$pSplit<font class="kw">;<br>}<br><br></font><font class="cmt">/*<br>Characteristics constants for Header Type:<br>EVERY CELL FROM THE TABLE IS A MULTICELL<br><br>&nbsp;&nbsp;&nbsp;&nbsp;WIDTH - this is the cell width. This value must be sent only to the HEADER!!!!!!!!<br>&nbsp;&nbsp;&nbsp;&nbsp;T_COLOR - text color = array(r,g,b);<br>&nbsp;&nbsp;&nbsp;&nbsp;T_SIZE - text size<br>&nbsp;&nbsp;&nbsp;&nbsp;T_FONT - text font - font type = "Arial", "Times"<br>&nbsp;&nbsp;&nbsp;&nbsp;T_ALIGN - text align - "RLCJ"<br>&nbsp;&nbsp;&nbsp;&nbsp;V_ALIGN - text vertical alignment - "TMB"<br>&nbsp;&nbsp;&nbsp;&nbsp;T_TYPE - text type (Bold Italic etc)<br>&nbsp;&nbsp;&nbsp;&nbsp;LN_SPACE - space between lines<br>&nbsp;&nbsp;&nbsp;&nbsp;BG_COLOR - background color = array(r,g,b);<br>&nbsp;&nbsp;&nbsp;&nbsp;BRD_COLOR - border color = array(r,g,b);<br>&nbsp;&nbsp;&nbsp;&nbsp;BRD_SIZE - border size --<br>&nbsp;&nbsp;&nbsp;&nbsp;BRD_TYPE - border size -- up down, with border without!!! etc<br>&nbsp;&nbsp;&nbsp;&nbsp;BRD_TYPE_NEW_PAGE - border type on new page - this is user only if specified(&lt;&gt;'')<br>&nbsp;&nbsp;&nbsp;&nbsp;TEXT - header text -- THIS ALSO BELONGS ONLY TO THE HEADER!!!!<br><br>&nbsp;&nbsp;&nbsp;&nbsp;all these setting conform to the settings from the multicell functions!!!!<br>*/<br><br>/*<br>Function: Set_Header_Type($type_arr) -- sets the array for the header type<br><br>type array =<br>&nbsp;&nbsp;&nbsp;&nbsp; array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0=&gt;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"WIDTH" =&gt; 10,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"T_COLOR" =&gt; array(120,120,120),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"T_SIZE" =&gt; 5,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"TEXT" =&gt; "Header text 1"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1=&gt;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp; );<br>where 0,1... are the column number<br>*/<br><br></font><font class="kw">function </font>Set_Header_Type<font class="kw">(</font>$type_arr<font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tb_header_type <font class="kw">= </font>$type_arr<font class="kw">;<br>}<br><br><br></font><font class="cmt">/*<br>Characteristics constants for Data Type:<br>EVERY CELL FROM THE TABLE IS A MULTICELL<br>&nbsp;&nbsp;&nbsp;&nbsp;T_COLOR - text color = array(r,g,b);<br>&nbsp;&nbsp;&nbsp;&nbsp;T_SIZE - text size<br>&nbsp;&nbsp;&nbsp;&nbsp;T_FONT - text font - font type = "Arial", "Times"<br>&nbsp;&nbsp;&nbsp;&nbsp;T_ALIGN - text align - "RLCJ"<br>&nbsp;&nbsp;&nbsp;&nbsp;V_ALIGN - text vertical alignment - "TMB"<br>&nbsp;&nbsp;&nbsp;&nbsp;T_TYPE - text type (Bold Italic etc)<br>&nbsp;&nbsp;&nbsp;&nbsp;LN_SPACE - space between lines<br>&nbsp;&nbsp;&nbsp;&nbsp;BG_COLOR - background color = array(r,g,b);<br>&nbsp;&nbsp;&nbsp;&nbsp;BRD_COLOR - border color = array(r,g,b);<br>&nbsp;&nbsp;&nbsp;&nbsp;BRD_SIZE - border size --<br>&nbsp;&nbsp;&nbsp;&nbsp;BRD_TYPE - border size -- up down, with border without!!! etc<br>&nbsp;&nbsp;&nbsp;&nbsp;BRD_TYPE_NEW_PAGE - border type on new page - this is user only if specified(&lt;&gt;'')<br><br>&nbsp;&nbsp;&nbsp;&nbsp;all these settings conform to the settings from the multicell functions!!!!<br>*/<br><br>/*<br>Function: Set_data_Type($type_arr) -- sets the array for the header type<br><br>type array =<br>&nbsp;&nbsp;&nbsp;&nbsp; array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0=&gt;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"T_COLOR" =&gt; array(120,120,120),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"T_SIZE" =&gt; 5,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"BRD_TYPE" =&gt; 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1=&gt;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp; );<br>where 0,1... are the column number<br>*/<br><br></font><font class="kw">function </font>Set_Data_Type<font class="kw">(</font>$type_arr<font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tb_data_type <font class="kw">= </font>$type_arr<font class="kw">;<br>}<br><br><br><br></font><font class="cmt">/*<br>Function Set_Table_Type<br><br>$type_arr = array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"BRD_COLOR"=&gt; array (120,120,120), //border color<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"BRD_SIZE"=&gt;5), //border line width<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"TB_COLUMNS"=&gt;5), //the number of columns<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"TB_ALIGN"=&gt;"L"), //the align of the table, possible values = L, R, C equivalent to Left, Right, Center<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'L_MARGIN' =&gt; 0// left margin... reference from this-&gt;lmargin values<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>*/<br></font><font class="kw">function </font>Set_Table_Type<font class="kw">(</font>$type_arr<font class="kw">){<br><br>&nbsp;&nbsp;&nbsp;&nbsp;if (isset(</font>$type_arr<font class="kw">[</font><font class="str">'TB_COLUMNS'</font><font class="kw">])) </font>$<font class="kw">this-&gt;</font>tb_columns <font class="kw">= </font>$type_arr<font class="kw">[</font><font class="str">'TB_COLUMNS'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;if (!isset(</font>$type_arr<font class="kw">[</font><font class="str">'L_MARGIN'</font><font class="kw">])) </font>$type_arr<font class="kw">[</font><font class="str">'L_MARGIN'</font><font class="kw">]=</font>0<font class="kw">;</font><font class="cmt">//default values<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tb_table_type <font class="kw">= </font>$type_arr<font class="kw">;<br><br>}<br><br></font><font class="cmt">//this functiondraws the exterior table border!!!!<br></font><font class="kw">function </font>Draw_Table_Border<font class="kw">(){<br></font><font class="cmt">/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"BRD_COLOR"=&gt; array (120,120,120), //border color<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"BRD_SIZE"=&gt;5), //border line width<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"TB_COLUMNS"=&gt;5), //the number of columns<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"TB_ALIGN"=&gt;"L"), //the align of the table, possible values = L, R, C equivalent to Left, Right, Center<br>*/<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if ( ! </font>$<font class="kw">this-&gt;</font>tb_border_draw <font class="kw">) return;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;if ( ! </font>$<font class="kw">this-&gt;</font>Data_On_Current_Page<font class="kw">) return; </font><font class="cmt">//there was no data on the current page<br><br>&nbsp;&nbsp;&nbsp;&nbsp;//set the colors<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">list(</font>$r<font class="kw">, </font>$g<font class="kw">, </font>$b<font class="kw">) = </font>$<font class="kw">this-&gt;</font>tb_table_type<font class="kw">[</font><font class="str">'BRD_COLOR'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetDrawColor<font class="kw">(</font>$r<font class="kw">, </font>$g<font class="kw">, </font>$b<font class="kw">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//set the line width<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetLineWidth<font class="kw">(</font>$<font class="kw">this-&gt;</font>tb_table_type<font class="kw">[</font><font class="str">'BRD_SIZE'</font><font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">#echo $this-&gt;GetY()-$this-&gt;table_starty." ";;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;//draw the border<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Rect<font class="kw">(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>table_startx<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>table_starty<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Get_Table_Width<font class="kw">(),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>GetY<font class="kw">()-</font>$<font class="kw">this-&gt;</font>table_starty<font class="kw">);<br><br>}<br><br>function </font>End_Page_Border<font class="kw">(){<br>&nbsp;&nbsp;&nbsp;&nbsp;if (isset(</font>$<font class="kw">this-&gt;</font>tb_table_type<font class="kw">[</font><font class="str">'BRD_TYPE_END_PAGE'</font><font class="kw">])){<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>strpos<font class="kw">(</font>$<font class="kw">this-&gt;</font>tb_table_type<font class="kw">[</font><font class="str">'BRD_TYPE_END_PAGE'</font><font class="kw">], </font><font class="str">'B'</font><font class="kw">) &gt;= </font>0<font class="kw">){<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//set the colors<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">list(</font>$r<font class="kw">, </font>$g<font class="kw">, </font>$b<font class="kw">) = </font>$<font class="kw">this-&gt;</font>tb_table_type<font class="kw">[</font><font class="str">'BRD_COLOR'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetDrawColor<font class="kw">(</font>$r<font class="kw">, </font>$g<font class="kw">, </font>$b<font class="kw">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//set the line width<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetLineWidth<font class="kw">(</font>$<font class="kw">this-&gt;</font>tb_table_type<font class="kw">[</font><font class="str">'BRD_SIZE'</font><font class="kw">]);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//draw the line<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">(</font>$<font class="kw">this-&gt;</font>table_startx<font class="kw">, </font>$<font class="kw">this-&gt;</font>GetY<font class="kw">(), </font>$<font class="kw">this-&gt;</font>table_startx <font class="kw">+ </font>$<font class="kw">this-&gt;</font>Get_Table_Width<font class="kw">(), </font>$<font class="kw">this-&gt;</font>GetY<font class="kw">());<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br><br></font><font class="cmt">//returns the table width in user units<br></font><font class="kw">function </font>Get_Table_Width<font class="kw">()<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//calculate the table width<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$tb_width <font class="kw">= </font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;for (</font>$i<font class="kw">=</font>0<font class="kw">; </font>$i <font class="kw">&lt; </font>$<font class="kw">this-&gt;</font>tb_columns<font class="kw">; </font>$i<font class="kw">++){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$tb_width <font class="kw">+= </font>$<font class="kw">this-&gt;</font>tb_header_type<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'WIDTH'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;return </font>$tb_width<font class="kw">;<br>}<br><br></font><font class="cmt">//alignes the table to C, L or R(default is L)<br></font><font class="kw">function </font>Table_Align<font class="kw">(){<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//check if the table is aligned<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if (isset(</font>$<font class="kw">this-&gt;</font>tb_table_type<font class="kw">[</font><font class="str">'TB_ALIGN'</font><font class="kw">])) </font>$tb_align <font class="kw">= </font>$<font class="kw">this-&gt;</font>tb_table_type<font class="kw">[</font><font class="str">'TB_ALIGN'</font><font class="kw">]; else </font>$tb_align<font class="kw">=</font><font class="str">''</font><font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//set the table align<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">switch(</font>$tb_align<font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'C'</font><font class="kw">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetX<font class="kw">(</font>$<font class="kw">this-&gt;</font>lMargin <font class="kw">+ </font>$<font class="kw">this-&gt;</font>tb_table_type<font class="kw">[</font><font class="str">'L_MARGIN'</font><font class="kw">] + (</font>$<font class="kw">this-&gt;</font>PageWidth<font class="kw">() - </font>$<font class="kw">this-&gt;</font>Get_Table_Width<font class="kw">())/</font>2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'R'</font><font class="kw">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetX<font class="kw">(</font>$<font class="kw">this-&gt;</font>lMargin <font class="kw">+ </font>$<font class="kw">this-&gt;</font>tb_table_type<font class="kw">[</font><font class="str">'L_MARGIN'</font><font class="kw">] + (</font>$<font class="kw">this-&gt;</font>PageWidth<font class="kw">() - </font>$<font class="kw">this-&gt;</font>Get_Table_Width<font class="kw">()));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetX<font class="kw">(</font>$<font class="kw">this-&gt;</font>lMargin <font class="kw">+ </font>$<font class="kw">this-&gt;</font>tb_table_type<font class="kw">[</font><font class="str">'L_MARGIN'</font><font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>&nbsp;&nbsp;&nbsp;&nbsp;}</font><font class="cmt">//if (isset($this-&gt;tb_table_type['TB_ALIGN'])){<br></font><font class="kw">}<br><br></font><font class="cmt">//Draws the Header<br></font><font class="kw">function </font>Draw_Header<font class="kw">(){<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Draw_Header_Command <font class="kw">= </font>true<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tb_header_height <font class="kw">= </font>0<font class="kw">;<br>}<br><br>function </font>Init_Table_Position<font class="kw">(){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Table_Align<font class="kw">();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>table_startx <font class="kw">= </font>$<font class="kw">this-&gt;</font>GetX<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>table_starty <font class="kw">= </font>$<font class="kw">this-&gt;</font>GetY<font class="kw">();<br>}<br><br></font><font class="cmt">/**&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Draws the header line from a table.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@param&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;none<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@return&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nothing<br>*/<br></font><font class="kw">function </font>Draw_Header_<font class="kw">(){<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tb_header_height <font class="kw">= </font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Init_Table_Position<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Draw_Header_Command <font class="kw">= </font>false<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//if the header will be showed<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if ( ! </font>$<font class="kw">this-&gt;</font>tb_header_draw <font class="kw">) return;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>DrawTableLine<font class="kw">(</font>$<font class="kw">this-&gt;</font>tb_header_type<font class="kw">, </font>false<font class="kw">, </font>1<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Data_On_Current_Page <font class="kw">= </font>true<font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;<br><br>}<br><br><br></font><font class="cmt">/**&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Draws a data line from the table.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call this function after the table initialization, table, header and data types are set<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@param&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data - array containing line informations <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$header - header will be drawed or not in case of new page <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@return&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nothing<br>*/<br></font><font class="kw">function </font>Draw_Data<font class="kw">(</font>$data<font class="kw">, </font>$header <font class="kw">= </font>true<font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>DrawTableLine<font class="kw">(</font>$data<font class="kw">, </font>$header<font class="kw">, </font>0<font class="kw">);&nbsp;&nbsp;&nbsp;<br>}<br><br></font><font class="cmt">/**&nbsp;&nbsp;&nbsp;Draws a data or header line from the table.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@param&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data - array containing line informations <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$header - header will be drawed or not in case of new page <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pDataType =&nbsp;&nbsp;&nbsp;&nbsp;0 - normal line<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 - header line<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 - not implemented<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@return&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nothing<br>*/<br></font><font class="kw">function </font>DrawTableLine<font class="kw">(</font>$data<font class="kw">, </font>$header<font class="kw">, </font>$pDataType <font class="kw">= </font>0<font class="kw">){<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$h <font class="kw">= </font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$hm <font class="kw">= </font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$xx <font class="kw">= Array();<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$tt <font class="kw">= Array();<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;if (!</font>$<font class="kw">this-&gt;</font>Data_On_Current_Page<font class="kw">) </font>$<font class="kw">this-&gt;</font>Init_Table_Position<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$pDataType <font class="kw">== </font>0<font class="kw">){</font><font class="cmt">//data line<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if (</font>$<font class="kw">this-&gt;</font>Draw_Header_Command<font class="kw">){</font><font class="cmt">//draw the header<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Draw_Header_<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//maximum Height available on this page<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$AvailPageH <font class="kw">= </font>$<font class="kw">this-&gt;</font>PageBreakTrigger <font class="kw">- </font>$<font class="kw">this-&gt;</font>GetY<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$AvailPageH <font class="kw">&lt;= </font>0<font class="kw">){ </font><font class="cmt">//there is no more space on this page<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>TableAddPage<font class="kw">(</font>$header<font class="kw">);</font><font class="cmt">//add a page without header<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>DrawTableLine<font class="kw">(</font>$data<font class="kw">, </font>$header<font class="kw">, </font>$pDataType<font class="kw">);</font><font class="cmt">//recall this function<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">return;</font><font class="cmt">//exit this function<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$MaxPageH <font class="kw">= </font>$<font class="kw">this-&gt;</font>PageBreakTrigger <font class="kw">- </font>$<font class="kw">this-&gt;</font>tMargin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$split <font class="kw">= </font>false<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$backdata <font class="kw">= </font>$data<font class="kw">; </font><font class="cmt">//backup data in case of split or recall;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;//calculate the maximum height of the cells<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">for(</font>$i<font class="kw">=</font>0<font class="kw">; </font>$i <font class="kw">&lt; </font>$<font class="kw">this-&gt;</font>tb_columns<font class="kw">; </font>$i<font class="kw">++)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!isset(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">]) || (</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">]==</font><font class="str">''</font><font class="kw">)) </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">" "</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!isset(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_FONT'</font><font class="kw">])) </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_FONT'</font><font class="kw">] = </font>$<font class="kw">this-&gt;</font>tb_data_type<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_FONT'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!isset(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_TYPE'</font><font class="kw">])) </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_TYPE'</font><font class="kw">] = </font>$<font class="kw">this-&gt;</font>tb_data_type<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_TYPE'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!isset(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_SIZE'</font><font class="kw">])) </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_SIZE'</font><font class="kw">] = </font>$<font class="kw">this-&gt;</font>tb_data_type<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_SIZE'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!isset(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_COLOR'</font><font class="kw">])) </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_COLOR'</font><font class="kw">] = </font>$<font class="kw">this-&gt;</font>tb_data_type<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_COLOR'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!isset(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_ALIGN'</font><font class="kw">])) </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_ALIGN'</font><font class="kw">] = </font>$<font class="kw">this-&gt;</font>tb_data_type<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_ALIGN'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!isset(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'V_ALIGN'</font><font class="kw">])) </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'V_ALIGN'</font><font class="kw">] = </font>$<font class="kw">this-&gt;</font>tb_data_type<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'V_ALIGN'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!isset(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'LN_SIZE'</font><font class="kw">])) </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'LN_SIZE'</font><font class="kw">] = </font>$<font class="kw">this-&gt;</font>tb_data_type<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'LN_SIZE'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!isset(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'BRD_SIZE'</font><font class="kw">])) </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'BRD_SIZE'</font><font class="kw">] = </font>$<font class="kw">this-&gt;</font>tb_data_type<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'BRD_SIZE'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!isset(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'BRD_COLOR'</font><font class="kw">])) </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'BRD_COLOR'</font><font class="kw">] = </font>$<font class="kw">this-&gt;</font>tb_data_type<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'BRD_COLOR'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!isset(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'BRD_TYPE'</font><font class="kw">])) </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'BRD_TYPE'</font><font class="kw">] = </font>$<font class="kw">this-&gt;</font>tb_data_type<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'BRD_TYPE'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!isset(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'BG_COLOR'</font><font class="kw">])) </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'BG_COLOR'</font><font class="kw">] = </font>$<font class="kw">this-&gt;</font>tb_data_type<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'BG_COLOR'</font><font class="kw">];<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_FONT'</font><font class="kw">],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_TYPE'</font><font class="kw">],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_SIZE'</font><font class="kw">]);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'CELL_WIDTH'</font><font class="kw">] = </font>$<font class="kw">this-&gt;</font>tb_header_type<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'WIDTH'</font><font class="kw">];<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (isset(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'COLSPAN'</font><font class="kw">])){<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$colspan <font class="kw">= (int) </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'COLSPAN'</font><font class="kw">];</font><font class="cmt">//convert to integer<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">for (</font>$j <font class="kw">= </font>1<font class="kw">; </font>$j <font class="kw">&lt; </font>$colspan<font class="kw">; </font>$j<font class="kw">++){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//if there is a colspan, then calculate the number of lines also with the with of the next cell<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if ((</font>$i <font class="kw">+ </font>$j<font class="kw">) &lt; </font>$<font class="kw">this-&gt;</font>tb_columns<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'CELL_WIDTH'</font><font class="kw">] += </font>$<font class="kw">this-&gt;</font>tb_header_type<font class="kw">[</font>$i <font class="kw">+ </font>$j<font class="kw">][</font><font class="str">'WIDTH'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$MaxLines <font class="kw">= </font>floor<font class="kw">(</font>$AvailPageH <font class="kw">/ </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'LN_SIZE'</font><font class="kw">]);</font><font class="cmt">//floor this value, must be the lowest possible<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if (!isset(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'TEXT_STRLINES'</font><font class="kw">])) </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'TEXT_STRLINES'</font><font class="kw">] = </font>$<font class="kw">this-&gt;</font>StringToLines<font class="kw">(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'CELL_WIDTH'</font><font class="kw">], </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$NoLines <font class="kw">= </font>count<font class="kw">(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'TEXT_STRLINES'</font><font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$hm <font class="kw">= </font>max<font class="kw">(</font>$hm<font class="kw">, </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'LN_SIZE'</font><font class="kw">] * </font>$NoLines<font class="kw">);</font><font class="cmt">//this would be the normal height<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if (</font>$NoLines <font class="kw">&gt; </font>$MaxLines<font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$split <font class="kw">= </font>true<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$NoLines <font class="kw">= </font>$MaxLines<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'TEXT_SPLITLINES'</font><font class="kw">] = </font>array_splice<font class="kw">(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'TEXT_STRLINES'</font><font class="kw">], </font>$MaxLines<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'CELL_LINES'</font><font class="kw">] = </font>$NoLines<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//this is the maximum cell height<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$h <font class="kw">= </font>max<font class="kw">(</font>$h<font class="kw">, </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'LN_SIZE'</font><font class="kw">] * </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'CELL_LINES'</font><font class="kw">]);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (isset(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'COLSPAN'</font><font class="kw">])){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//just skip the other cells<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$i <font class="kw">= </font>$i <font class="kw">+ </font>$colspan <font class="kw">- </font>1<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$pDataType <font class="kw">== </font>0<font class="kw">){</font><font class="cmt">//data line&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if (!</font>$<font class="kw">this-&gt;</font>tb_split_normal<font class="kw">){</font><font class="cmt">//split only if the cell height is bigger than a page size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if (</font>$split <font class="kw">&amp;&amp; ((</font>$hm <font class="kw">+ </font>$<font class="kw">this-&gt;</font>tb_header_height<font class="kw">) &lt; </font>$MaxPageH<font class="kw">)){</font><font class="cmt">//if the header is splitted and it has space on a page<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>TableAddPage<font class="kw">(</font>$header<font class="kw">);</font><font class="cmt">//add a page without header<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>DrawTableLine<font class="kw">(</font>$backdata<font class="kw">, </font>$header<font class="kw">, </font>0<font class="kw">);</font><font class="cmt">//recall this function<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">return;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$pDataType <font class="kw">== </font>1<font class="kw">){</font><font class="cmt">//header line<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>tb_header_height <font class="kw">= </font>$hm<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$split <font class="kw">&amp;&amp; (</font>$hm <font class="kw">&lt; </font>$MaxPageH<font class="kw">)){</font><font class="cmt">//if the header is splitted and it has space on a page<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//new page<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>TableAddPage<font class="kw">(</font>false<font class="kw">);</font><font class="cmt">//add a page without header<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>DrawTableLine<font class="kw">(</font>$backdata<font class="kw">, </font>$header<font class="kw">, </font>1<font class="kw">);</font><font class="cmt">//recall this function<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">return;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( ((</font>2<font class="kw">*</font>$h<font class="kw">) &gt; </font>$AvailPageH<font class="kw">) &amp;&amp; ((</font>2<font class="kw">*</font>$h<font class="kw">) &lt; </font>$MaxPageH<font class="kw">)){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">/*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if the header double size is bigger then the available size <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;but the double size is smaller than a page size<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;&gt; we draw a new page<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**/<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>TableAddPage<font class="kw">(</font>false<font class="kw">);</font><font class="cmt">//add a page withot header<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>DrawTableLine<font class="kw">(</font>$backdata<font class="kw">, </font>$header<font class="kw">, </font>1<font class="kw">);</font><font class="cmt">//recall this function<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">return;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Table_Align<font class="kw">();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Draw the cells of the row<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">for( </font>$i <font class="kw">= </font>0<font class="kw">; </font>$i <font class="kw">&lt; </font>$<font class="kw">this-&gt;</font>tb_columns<font class="kw">; </font>$i<font class="kw">++ )<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//border size BRD_SIZE<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetLineWidth<font class="kw">(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'BRD_SIZE'</font><font class="kw">]);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//fill color = BG_COLOR<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">list(</font>$r<font class="kw">, </font>$g<font class="kw">, </font>$b<font class="kw">) = </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'BG_COLOR'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFillColor<font class="kw">(</font>$r<font class="kw">, </font>$g<font class="kw">, </font>$b<font class="kw">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Draw Color = BRD_COLOR<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">list(</font>$r<font class="kw">, </font>$g<font class="kw">, </font>$b<font class="kw">) = </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'BRD_COLOR'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetDrawColor<font class="kw">(</font>$r<font class="kw">, </font>$g<font class="kw">, </font>$b<font class="kw">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Text Color = T_COLOR<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">list(</font>$r<font class="kw">, </font>$g<font class="kw">, </font>$b<font class="kw">) = </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_COLOR'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetTextColor<font class="kw">(</font>$r<font class="kw">, </font>$g<font class="kw">, </font>$b<font class="kw">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Set the font, font type and size<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_FONT'</font><font class="kw">],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_TYPE'</font><font class="kw">],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_SIZE'</font><font class="kw">]);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Save the current position<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$x<font class="kw">=</font>$<font class="kw">this-&gt;</font>GetX<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$y<font class="kw">=</font>$<font class="kw">this-&gt;</font>GetY<font class="kw">();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//print the text<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>MultiCellTable<font class="kw">(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'CELL_WIDTH'</font><font class="kw">],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'LN_SIZE'</font><font class="kw">],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'TEXT_STRLINES'</font><font class="kw">],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'BRD_TYPE'</font><font class="kw">],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'T_ALIGN'</font><font class="kw">],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'V_ALIGN'</font><font class="kw">],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>1<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$h <font class="kw">- </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'LN_SIZE'</font><font class="kw">] * </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'CELL_LINES'</font><font class="kw">]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Put the position to the right of the cell<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>$x <font class="kw">+ </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'CELL_WIDTH'</font><font class="kw">],</font>$y<font class="kw">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//if we have colspan, just ignore the next cells<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if (isset(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'COLSPAN'</font><font class="kw">])){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$i <font class="kw">= </font>$i <font class="kw">+ (int)</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'COLSPAN'</font><font class="kw">] - </font>1<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Data_On_Current_Page <font class="kw">= </font>true<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Go to the next line<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Ln<font class="kw">(</font>$h<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$split<font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//calculate the maximum height of the cells<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">for(</font>$i<font class="kw">=</font>0<font class="kw">; </font>$i <font class="kw">&lt; </font>$<font class="kw">this-&gt;</font>tb_columns<font class="kw">; </font>$i<font class="kw">++){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$backdata<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'TEXT_STRLINES'</font><font class="kw">] = isset(</font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'TEXT_SPLITLINES'</font><font class="kw">]) ? </font>$data<font class="kw">[</font>$i<font class="kw">][</font><font class="str">'TEXT_SPLITLINES'</font><font class="kw">] : array();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>TableAddPage<font class="kw">(</font>$header<font class="kw">);</font><font class="cmt">//we have a page split, add a page<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if (</font>$pDataType <font class="kw">== </font>1<font class="kw">) </font>$header <font class="kw">= </font>false<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>DrawTableLine<font class="kw">(</font>$backdata<font class="kw">, </font>$header<font class="kw">, </font>$pDataType<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}</font><font class="cmt">//DrawTableLine<br><br>/**&nbsp;&nbsp;&nbsp;Adds a new page in the pdf document and initializes the table and the header if necessary.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@param<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$header - boolean - if the header is drawed or not<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@return&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nothing<br>*/<br></font><font class="kw">function </font>TableAddPage<font class="kw">(</font>$header <font class="kw">= </font>true<font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Draw_Table_Border<font class="kw">();</font><font class="cmt">//draw the table border<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>End_Page_Border<font class="kw">();</font><font class="cmt">//if there is a special handling for end page??? this is specific for me<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>AddPage<font class="kw">(</font>$<font class="kw">this-&gt;</font>CurOrientation<font class="kw">);</font><font class="cmt">//add a new page<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Data_On_Current_Page <font class="kw">= </font>false<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>table_startx <font class="kw">= </font>$<font class="kw">this-&gt;</font>GetX<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>table_starty <font class="kw">= </font>$<font class="kw">this-&gt;</font>GetY<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$header<font class="kw">) </font>$this <font class="kw">-&gt;</font>Draw_Header<font class="kw">();</font><font class="cmt">//if we have to draw the header!!!&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font class="kw">}</font><font class="cmt">//TableAddPage<br><br>/**&nbsp;&nbsp;&nbsp;This method allows printing text with line breaks.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;It works like a modified MultiCell<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@param<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$w - width<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$h - line height<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$txtData - the outputed text<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$border - border(LRTB 0 or 1)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$align - horizontal align 'JLR'<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$valign - Vertical Alignment - Top, Middle, Bottom<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fill - fill (1/0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$vh - vertical adjustment - the Multicell Height will be with this VH Higher!!!!<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@return&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nothing<br>*/<br></font><font class="kw">function </font>MultiCellTable<font class="kw">(</font>$w<font class="kw">, </font>$h<font class="kw">, </font>$txtData<font class="kw">, </font>$border<font class="kw">=</font>0<font class="kw">, </font>$align<font class="kw">=</font><font class="str">'J'</font><font class="kw">, </font>$valign<font class="kw">=</font><font class="str">'T'</font><font class="kw">, </font>$fill<font class="kw">=</font>0<font class="kw">, </font>$vh<font class="kw">=</font>0<font class="kw">)<br>{<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$b1 <font class="kw">= </font><font class="str">''</font><font class="kw">;</font><font class="cmt">//border for top cell<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$b2 <font class="kw">= </font><font class="str">''</font><font class="kw">;</font><font class="cmt">//border for middle cell<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$b3 <font class="kw">= </font><font class="str">''</font><font class="kw">;</font><font class="cmt">//border for bottom cell<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if(</font>$border<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$border<font class="kw">==</font>1<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$border <font class="kw">= </font><font class="str">'LTRB'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$b1 <font class="kw">= </font><font class="str">'LRT'</font><font class="kw">;</font><font class="cmt">//without the bottom<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$b2 <font class="kw">= </font><font class="str">'LR'</font><font class="kw">;</font><font class="cmt">//without the top and bottom<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$b3 <font class="kw">= </font><font class="str">'LRB'</font><font class="kw">;</font><font class="cmt">//without the top<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$b2<font class="kw">=</font><font class="str">''</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'L'</font><font class="kw">)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$b2<font class="kw">.=</font><font class="str">'L'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'R'</font><font class="kw">)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$b2<font class="kw">.=</font><font class="str">'R'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$b1<font class="kw">=</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'T'</font><font class="kw">)) ? </font>$b2<font class="kw">.</font><font class="str">'T' </font><font class="kw">: </font>$b2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$b3<font class="kw">=</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'B'</font><font class="kw">)) ? </font>$b2<font class="kw">.</font><font class="str">'B' </font><font class="kw">: </font>$b2<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;switch (</font>$valign<font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'T'</font><font class="kw">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$wh_T <font class="kw">= </font>0<font class="kw">;</font><font class="cmt">//Top width<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$wh_B <font class="kw">= </font>$vh <font class="kw">- </font>$wh_T<font class="kw">;</font><font class="cmt">//Bottom width<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'M'</font><font class="kw">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$wh_T <font class="kw">= </font>$vh<font class="kw">/</font>2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$wh_B <font class="kw">= </font>$vh<font class="kw">/</font>2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case </font><font class="str">'B'</font><font class="kw">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$wh_T <font class="kw">= </font>$vh<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$wh_B <font class="kw">= </font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:</font><font class="cmt">//default is TOP ALIGN<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$wh_T <font class="kw">= </font>0<font class="kw">;</font><font class="cmt">//Top width<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$wh_B <font class="kw">= </font>$vh <font class="kw">- </font>$wh_T<font class="kw">;</font><font class="cmt">//Bottom width<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//save the X position<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$x <font class="kw">= </font>$<font class="kw">this-&gt;</font>x<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">/*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $wh_T == 0 that means that we have no vertical adjustments so I will skip the cells that<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;draws the top and bottom borders<br>&nbsp;&nbsp;&nbsp;&nbsp;*/<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if (</font>$wh_T <font class="kw">!= </font>0<font class="kw">)</font><font class="cmt">//only when there is a difference<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//draw the top borders!!!<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$w<font class="kw">,</font>$wh_T<font class="kw">,</font><font class="str">''</font><font class="kw">,</font>$b1<font class="kw">,</font>2<font class="kw">,</font>$align<font class="kw">,</font>$fill<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$b2 <font class="kw">= </font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'T'</font><font class="kw">)) &amp;&amp; (</font>$wh_T <font class="kw">== </font>0<font class="kw">) ? </font>$b2<font class="kw">.</font><font class="str">'T' </font><font class="kw">: </font>$b2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$b2 <font class="kw">= </font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'B'</font><font class="kw">)) &amp;&amp; (</font>$wh_B <font class="kw">== </font>0<font class="kw">) ? </font>$b2<font class="kw">.</font><font class="str">'B' </font><font class="kw">: </font>$b2<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">#$this-&gt;MultiCell($w,$h,$txt,$b2,$align,$fill);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>MultiCellTag<font class="kw">(</font>$w<font class="kw">, </font>$h<font class="kw">, </font>$txtData<font class="kw">, </font>$b2<font class="kw">, </font>$align<font class="kw">, </font>1<font class="kw">, </font>false<font class="kw">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$wh_B <font class="kw">!= </font>0<font class="kw">){</font><font class="cmt">//only when there is a difference<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//go to the saved X position<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//a multicell always runs to the begin of line<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>x <font class="kw">= </font>$x<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$w<font class="kw">, </font>$wh_B<font class="kw">, </font><font class="str">''</font><font class="kw">, </font>$b3<font class="kw">, </font>2<font class="kw">, </font>$align<font class="kw">,</font>$fill<font class="kw">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>x<font class="kw">=</font>$<font class="kw">this-&gt;</font>lMargin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>}<br><br><br>}</font><font class="cmt">//end of pdf_table class<br><br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>

<H4 CLASS="st">Example</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br><br><font class="kw">require_once(</font><font class="str">"class.fpdf_table.php"</font><font class="kw">);<br>require_once(</font><font class="str">"table_def.inc"</font><font class="kw">);<br><br></font>$pdf<font class="kw">=new </font>FPDF_TABLE<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>SetAutoPageBreak<font class="kw">(</font>true<font class="kw">, </font>20<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetTopMargin<font class="kw">(</font>30<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>AddPage<font class="kw">();<br><br></font>$columns <font class="kw">= </font>5<font class="kw">; </font><font class="cmt">//five columns<br><br></font>$pdf<font class="kw">-&gt;</font>SetStyle<font class="kw">(</font><font class="str">"p"</font><font class="kw">,</font><font class="str">"times"</font><font class="kw">,</font><font class="str">""</font><font class="kw">,</font>10<font class="kw">,</font><font class="str">"130,0,30"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetStyle<font class="kw">(</font><font class="str">"pb"</font><font class="kw">,</font><font class="str">"times"</font><font class="kw">,</font><font class="str">"B"</font><font class="kw">,</font>11<font class="kw">,</font><font class="str">"130,0,30"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetStyle<font class="kw">(</font><font class="str">"t1"</font><font class="kw">,</font><font class="str">"arial"</font><font class="kw">,</font><font class="str">""</font><font class="kw">,</font>11<font class="kw">,</font><font class="str">"254,252,222"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetStyle<font class="kw">(</font><font class="str">"t1"</font><font class="kw">,</font><font class="str">"arial"</font><font class="kw">,</font><font class="str">""</font><font class="kw">,</font>11<font class="kw">,</font><font class="str">"0,151,200"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetStyle<font class="kw">(</font><font class="str">"t2"</font><font class="kw">,</font><font class="str">"arial"</font><font class="kw">,</font><font class="str">""</font><font class="kw">,</font>11<font class="kw">,</font><font class="str">"0,151,200"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetStyle<font class="kw">(</font><font class="str">"t3"</font><font class="kw">,</font><font class="str">"times"</font><font class="kw">,</font><font class="str">"B"</font><font class="kw">,</font>14<font class="kw">,</font><font class="str">"203,0,48"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetStyle<font class="kw">(</font><font class="str">"t4"</font><font class="kw">,</font><font class="str">"arial"</font><font class="kw">,</font><font class="str">"BI"</font><font class="kw">,</font>11<font class="kw">,</font><font class="str">"0,151,200"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetStyle<font class="kw">(</font><font class="str">"hh"</font><font class="kw">,</font><font class="str">"times"</font><font class="kw">,</font><font class="str">"B"</font><font class="kw">,</font>11<font class="kw">,</font><font class="str">"255,189,12"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetStyle<font class="kw">(</font><font class="str">"font"</font><font class="kw">,</font><font class="str">"helvetica"</font><font class="kw">,</font><font class="str">""</font><font class="kw">,</font>10<font class="kw">,</font><font class="str">"0,0,255"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetStyle<font class="kw">(</font><font class="str">"style"</font><font class="kw">,</font><font class="str">"helvetica"</font><font class="kw">,</font><font class="str">"BI"</font><font class="kw">,</font>10<font class="kw">,</font><font class="str">"0,0,220"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetStyle<font class="kw">(</font><font class="str">"size"</font><font class="kw">,</font><font class="str">"times"</font><font class="kw">,</font><font class="str">"BI"</font><font class="kw">,</font>13<font class="kw">,</font><font class="str">"0,0,120"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetStyle<font class="kw">(</font><font class="str">"color"</font><font class="kw">,</font><font class="str">"times"</font><font class="kw">,</font><font class="str">"BI"</font><font class="kw">,</font>13<font class="kw">,</font><font class="str">"0,255,255"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetStyle<font class="kw">(</font><font class="str">"ss"</font><font class="kw">,</font><font class="str">"arial"</font><font class="kw">,</font><font class="str">""</font><font class="kw">,</font>7<font class="kw">,</font><font class="str">"203,0,48"</font><font class="kw">);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br></font>$ttxt<font class="kw">[</font>1<font class="kw">] = </font><font class="str">"&lt;size&gt;Tag-Based MultiCell TABLE&lt;/size&gt;<br><br>Done by &lt;t1 href='mailto:klodoma@ar-sd.net'&gt;Bintintan Andrei&lt;/t1&gt;"</font><font class="kw">;<br></font>$ttxt<font class="kw">[</font>2<font class="kw">] = </font><font class="str">"&lt;p&gt;<br>&lt;t3&gt;Description&lt;/t3&gt;<br><br>\tThis method allows printing &lt;t4&gt;&lt;TAG&gt;&lt;/t4&gt; formatted text with line breaks. They can be automatic (as soon as the text reaches the right border of the cell) or explicit (via the &lt;pb&gt;\\n&lt;/pb&gt; character). As many cells as necessary are output, one below the other.<br>Text can be &lt;hh&gt;aligned&lt;/hh&gt;, &lt;hh&gt;cente~~~red&lt;/hh&gt; or &lt;hh&gt;justified&lt;/hh&gt;. Different &lt;font&gt;Font&lt;/font&gt;, &lt;size&gt;Sizes&lt;/size&gt;, &lt;style&gt;Styles&lt;/style&gt;, &lt;color&gt;Colors&lt;/color&gt; can be used. The cell block can be framed and the background painted. The behavior/paramaters of the method are the same as to the &lt;t2 href='http://www.fpdf.org/en/doc/multicell.htm'&gt;FPDF Multicell method&lt;/t2&gt;. &lt;style href='www.fpdf.org'&gt;Links&lt;/style&gt; can be used in any tag.<br>\t&lt;t4&gt;TAB&lt;/t4&gt; spaces (&lt;pb&gt;\\t&lt;/pb&gt;) can be used. The &lt;t4&gt;ttags&lt;/t4&gt; tag name is reserved for the TAB SPACES.<br>\tVariable Y relative positions can be used for &lt;ss ypos='-0.8'&gt;Subscript&lt;/ss&gt; or &lt;ss ypos='1.1'&gt;Superscript&lt;/ss&gt;.&lt;/p&gt;<br>&lt;style&gt;<br>\t&lt;hh size='50' &gt;Controlled Tab Space~~~&lt;/hh&gt; - Tab Space 1<br>\t&lt;hh size='60' &gt; ~~~&lt;/hh&gt;&lt;font&gt; - Tab Space 2&lt;/font&gt;<br>\t&lt;hh size='60' &gt; ~~~&lt;/hh&gt; - Tab Space 2<br>\t&lt;hh size='70' &gt; ~~~&lt;/hh&gt;&lt;hh&gt; - Tab Space 3&lt;/hh&gt;<br>\t&lt;hh size='50' &gt; ~~~&lt;/hh&gt; - Tab Space 1<br>\t&lt;hh size='60' &gt; ~~~&lt;/hh&gt;&lt;t4&gt; - Tab Space 2&lt;/t4&gt;<br>&lt;/style&gt;<br>\tIf no &lt;t4&gt;&lt;TAG&gt;&lt;/t4&gt; is specified then the FPDF current settings are used.\n\n"</font><font class="kw">;<br></font>$ttxt<font class="kw">[</font>3<font class="kw">] =</font><font class="str">"\t\t&lt;style&gt;Best Regards&lt;/style&gt;"</font><font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//we initialize the table class<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$pdf<font class="kw">-&gt;</font>Table_Init<font class="kw">(</font>$columns<font class="kw">, </font>true<font class="kw">, </font>true<font class="kw">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$table_subtype <font class="kw">= </font>$table_default_table_type<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$pdf<font class="kw">-&gt;</font>Set_Table_Type<font class="kw">(</font>$table_subtype<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//TABLE HEADER SETTINGS<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$header_subtype <font class="kw">= </font>$table_default_header_type<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;for(</font>$i<font class="kw">=</font>0<font class="kw">; </font>$i<font class="kw">&lt;</font>$columns<font class="kw">; </font>$i<font class="kw">++) </font>$header_type<font class="kw">[</font>$i<font class="kw">] = </font>$table_default_header_type<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$header_type<font class="kw">[</font>0<font class="kw">][</font><font class="str">'WIDTH'</font><font class="kw">] = </font>20<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$header_type<font class="kw">[</font>1<font class="kw">][</font><font class="str">'WIDTH'</font><font class="kw">] = </font>30<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$header_type<font class="kw">[</font>2<font class="kw">][</font><font class="str">'WIDTH'</font><font class="kw">] = </font>40<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$header_type<font class="kw">[</font>3<font class="kw">][</font><font class="str">'WIDTH'</font><font class="kw">] = </font>40<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$header_type<font class="kw">[</font>4<font class="kw">][</font><font class="str">'WIDTH'</font><font class="kw">] = </font>20<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$header_type<font class="kw">[</font>0<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">"Header 1"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$header_type<font class="kw">[</font>1<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">"Header 2 With COLSPAN"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$header_type<font class="kw">[</font>2<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">"Header 3"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$header_type<font class="kw">[</font>3<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">"Header 4"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$header_type<font class="kw">[</font>4<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">"Header 5"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$header_type<font class="kw">[</font>1<font class="kw">][</font><font class="str">'COLSPAN'</font><font class="kw">] = </font><font class="str">"2"</font><font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//set the header type<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$pdf<font class="kw">-&gt;</font>Set_Header_Type<font class="kw">(</font>$header_type<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$pdf<font class="kw">-&gt;</font>Draw_Header<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//TABLE DATA SETTINGS<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$data_subtype <font class="kw">= </font>$table_default_data_type<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$data_type <font class="kw">= Array();</font><font class="cmt">//reset the array<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">for (</font>$i<font class="kw">=</font>0<font class="kw">; </font>$i<font class="kw">&lt;</font>$columns<font class="kw">; </font>$i<font class="kw">++) </font>$data_type<font class="kw">[</font>$i<font class="kw">] = </font>$data_subtype<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$pdf<font class="kw">-&gt;</font>Set_Data_Type<font class="kw">(</font>$data_type<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$fsize <font class="kw">= </font>5<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$colspan <font class="kw">= </font>1<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$rr <font class="kw">= </font>255<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;for (</font>$j<font class="kw">=</font>0<font class="kw">; </font>$j<font class="kw">&lt;</font>30<font class="kw">; </font>$j<font class="kw">++)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data <font class="kw">= Array();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>0<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">"No.$j"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>1<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">"Test Test - $j"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>2<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">"Test Test - $j"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>3<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">"Text Longer &lt;p href='www.google.com'&gt;TexTest Longer Text&lt;/p&gt; Test Longer Text - $j"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>4<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">"Test text2 - $j"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>0<font class="kw">][</font><font class="str">'T_SIZE'</font><font class="kw">] = </font>$fsize<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>1<font class="kw">][</font><font class="str">'T_SIZE'</font><font class="kw">] = </font>13 <font class="kw">- </font>$fsize<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>3<font class="kw">][</font><font class="str">'T_SIZE'</font><font class="kw">] = </font>14 <font class="kw">- </font>$fsize<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>0<font class="kw">][</font><font class="str">'T_COLOR'</font><font class="kw">] = array(</font>$rr<font class="kw">,</font>0<font class="kw">,</font>0<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>0<font class="kw">][</font><font class="str">'BG_COLOR'</font><font class="kw">] = array(</font>$rr<font class="kw">,</font>$rr<font class="kw">,</font>$rr<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>3<font class="kw">][</font><font class="str">'T_COLOR'</font><font class="kw">] = array(</font>$rr<font class="kw">,</font>240<font class="kw">,</font>240<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>3<font class="kw">][</font><font class="str">'BG_COLOR'</font><font class="kw">] = array(</font>$rr<font class="kw">,</font>100<font class="kw">,</font>135<font class="kw">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$fsize<font class="kw">++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$fsize <font class="kw">&gt; </font>11<font class="kw">) </font>$fsize <font class="kw">= </font>5<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$j<font class="kw">&gt;</font>3 <font class="kw">&amp;&amp; </font>$j<font class="kw">&lt;</font>13<font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>0<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">"Colspan Example$j"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>0<font class="kw">][</font><font class="str">'COLSPAN'</font><font class="kw">] = </font>$colspan<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>0<font class="kw">][</font><font class="str">'BG_COLOR'</font><font class="kw">] = array(</font>$rr<font class="kw">,</font>0<font class="kw">,</font>0<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>0<font class="kw">][</font><font class="str">'T_COLOR'</font><font class="kw">] = array(</font>255<font class="kw">,</font>255<font class="kw">,</font>$rr<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$colspan<font class="kw">++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$colspan<font class="kw">&gt;</font>5<font class="kw">) </font>$colspan <font class="kw">= </font>1<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$j<font class="kw">&gt;</font>15 <font class="kw">&amp;&amp; </font>$j<font class="kw">&lt;</font>25<font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>2<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">"Colspan Example$j"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>2<font class="kw">][</font><font class="str">'COLSPAN'</font><font class="kw">] = </font>$colspan<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>2<font class="kw">][</font><font class="str">'BG_COLOR'</font><font class="kw">] = array(</font>$rr<font class="kw">,</font>0<font class="kw">,</font>0<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>2<font class="kw">][</font><font class="str">'T_COLOR'</font><font class="kw">] = array(</font>255<font class="kw">,</font>255<font class="kw">,</font>$rr<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$colspan<font class="kw">++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$colspan<font class="kw">&gt;</font>3<font class="kw">) </font>$colspan <font class="kw">= </font>1<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$j<font class="kw">&gt;</font>1<font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>2<font class="kw">][</font><font class="str">'BG_COLOR'</font><font class="kw">] = array(</font>255<font class="kw">-</font>$rr<font class="kw">,</font>$rr<font class="kw">,</font>$rr<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>2<font class="kw">][</font><font class="str">'T_COLOR'</font><font class="kw">] = array(</font>255<font class="kw">,</font>255<font class="kw">,</font>$rr<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$j<font class="kw">==</font>0<font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>0<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">"Top Right Align &lt;p&gt;Align Top&lt;/p&gt; Right Right Align "</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>0<font class="kw">][</font><font class="str">'T_ALIGN'</font><font class="kw">] = </font><font class="str">"R"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>0<font class="kw">][</font><font class="str">'V_ALIGN'</font><font class="kw">] = </font><font class="str">"T"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>1<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">"Middle Center Align Bold Italic"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>1<font class="kw">][</font><font class="str">'T_ALIGN'</font><font class="kw">] = </font><font class="str">"C"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>1<font class="kw">][</font><font class="str">'T_TYPE'</font><font class="kw">] = </font><font class="str">"BI"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>1<font class="kw">][</font><font class="str">'V_ALIGN'</font><font class="kw">] = </font><font class="str">"M"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>2<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">"\n\n\n\n\nBottom Left Align"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>2<font class="kw">][</font><font class="str">'T_ALIGN'</font><font class="kw">] = </font><font class="str">"L"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>2<font class="kw">][</font><font class="str">'V_ALIGN'</font><font class="kw">] = </font><font class="str">"B"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>3<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">"Middle Justified Align Longer text"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>3<font class="kw">][</font><font class="str">'T_ALIGN'</font><font class="kw">] = </font><font class="str">"J"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>3<font class="kw">][</font><font class="str">'V_ALIGN'</font><font class="kw">] = </font><font class="str">"M"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>4<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">"TOP RIGHT Align"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>4<font class="kw">][</font><font class="str">'T_ALIGN'</font><font class="kw">] = </font><font class="str">"R"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>4<font class="kw">][</font><font class="str">'V_ALIGN'</font><font class="kw">] = </font><font class="str">"T"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$j<font class="kw">&gt;</font>0 <font class="kw">and </font>$j<font class="kw">&lt;</font>4<font class="kw">){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>0<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">""</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>1<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">""</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>2<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">""</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>3<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">""</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>4<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">""</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$j<font class="kw">-</font>1<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font>$ttxt<font class="kw">[</font>$j<font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$j<font class="kw">-</font>1<font class="kw">][</font><font class="str">'COLSPAN'</font><font class="kw">] = </font>4<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$j<font class="kw">-</font>1<font class="kw">][</font><font class="str">'T_ALIGN'</font><font class="kw">] = </font><font class="str">"J"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>$j<font class="kw">-</font>1<font class="kw">][</font><font class="str">'LN_SIZE'</font><font class="kw">] = </font>5<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$j<font class="kw">== </font>14<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>1<font class="kw">][</font><font class="str">'TEXT'</font><font class="kw">] = </font><font class="str">"&lt;size&gt;Colspan = 4 and ... this\nCELL\nIS\nSPLITTED. Turn this split off with:\nFPDF_TABLE::Set_Table_SplitMode(true(default)/false) function&lt;/size&gt;"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>1<font class="kw">][</font><font class="str">'T_ALIGN'</font><font class="kw">] = </font><font class="str">"C"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>1<font class="kw">][</font><font class="str">'BG_COLOR'</font><font class="kw">] = array(</font>240<font class="kw">,</font>245<font class="kw">,</font>221<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[</font>1<font class="kw">][</font><font class="str">'COLSPAN'</font><font class="kw">] = </font>4<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$rr <font class="kw">-= </font>25<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$rr<font class="kw">&lt;</font>100<font class="kw">) </font>$rr <font class="kw">= </font>255<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$pdf<font class="kw">-&gt;</font>Draw_Data<font class="kw">(</font>$data<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$pdf<font class="kw">-&gt;</font>Draw_Table_Border<font class="kw">();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$pdf<font class="kw">-&gt;</font>Output<font class="kw">();<br><br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>
<BR>
View the result <A HREF="ex54.pdf" TARGET="_blank">here</A>.
<H4 CLASS="st">Download</H4><A HREF="script54.zip">ZIP</A> | <A HREF="script54.tgz">TGZ</A>
</BODY>
</HTML>

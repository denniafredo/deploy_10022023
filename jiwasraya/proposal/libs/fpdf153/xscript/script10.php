<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<TITLE>Example with MySQL</TITLE>
<LINK TYPE="text/css" REL="stylesheet" HREF="../fpdf.css">
</HEAD>
<BODY ONLOAD="if(window.focus) window.focus()">
<H2>Example with MySQL</H2>
<H4 CLASS="st">Informations</H4>Author: <SCRIPT>document.write('<A H'+'REF="m'+'ailto:carlos'+'&#'+'64;'+'magallaneslibre.com?subject=Example%20with%20MySQL">');</SCRIPT>Carlos Vásquez Sáez<SCRIPT>document.write('</A>');</SCRIPT><BR>License: Freeware
<H4 CLASS="st">Description</H4>This is an example script showing how to output a product table from a Mysql database.<BR>
Note: the table must fit in a single page.
<H4 CLASS="st">Source</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br><font class="cmt">//SHOW A DATABASE ON A PDF FILE<br>//FILE CREATED BY: Carlos José Vásquez Sáez<br>//YOU CAN CONTACT ME: carlos@magallaneslibre.com<br>//FROM PUNTA ARENAS, MAGALLANES<br><br></font>define<font class="kw">(</font><font class="str">'FPDF_FONTPATH'</font><font class="kw">,</font><font class="str">'font/'</font><font class="kw">);<br>require(</font><font class="str">'fpdf.php'</font><font class="kw">);<br><br></font><font class="cmt">//Connect to your database<br></font><font class="kw">include(</font><font class="str">"conectmysql.php"</font><font class="kw">);<br><br></font><font class="cmt">//Select the Products you want to show in your PDF file<br></font>$result<font class="kw">=</font>mysql_query<font class="kw">(</font><font class="str">"select Code,Name,Price from Products ORDER BY Code"</font><font class="kw">,</font>$link<font class="kw">);<br></font>$number_of_products <font class="kw">= </font>mysql_numrows<font class="kw">(</font>$result<font class="kw">);<br><br></font><font class="cmt">//Initialize the 3 columns and the total<br></font>$column_code <font class="kw">= </font><font class="str">""</font><font class="kw">;<br></font>$column_name <font class="kw">= </font><font class="str">""</font><font class="kw">;<br></font>$column_price <font class="kw">= </font><font class="str">""</font><font class="kw">;<br></font>$total <font class="kw">= </font>0<font class="kw">;<br><br></font><font class="cmt">//For each row, add the field to the corresponding column<br></font><font class="kw">while(</font>$row <font class="kw">= </font>mysql_fetch_array<font class="kw">(</font>$result<font class="kw">))<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$code <font class="kw">= </font>$row<font class="kw">[</font><font class="str">"Code"</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$name <font class="kw">= </font>substr<font class="kw">(</font>$row<font class="kw">[</font><font class="str">"Name"</font><font class="kw">],</font>0<font class="kw">,</font>20<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$real_price <font class="kw">= </font>$row<font class="kw">[</font><font class="str">"Price"</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$price_to_show <font class="kw">= </font>number_format<font class="kw">(</font>$row<font class="kw">[</font><font class="str">"Price"</font><font class="kw">],</font><font class="str">','</font><font class="kw">,</font><font class="str">'.'</font><font class="kw">,</font><font class="str">'.'</font><font class="kw">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$column_code <font class="kw">= </font>$column_code<font class="kw">.</font>$code<font class="kw">.</font><font class="str">"\n"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$column_name <font class="kw">= </font>$column_name<font class="kw">.</font>$name<font class="kw">.</font><font class="str">"\n"</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$column_price <font class="kw">= </font>$column_price<font class="kw">.</font>$price_to_show<font class="kw">.</font><font class="str">"\n"</font><font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Sum all the Prices (TOTAL)<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$total <font class="kw">= </font>$total<font class="kw">+</font>$real_price<font class="kw">;<br>}<br></font>mysql_close<font class="kw">();<br><br></font><font class="cmt">//Convert the Total Price to a number with (.) for thousands, and (,) for decimals.<br></font>$total <font class="kw">= </font>number_format<font class="kw">(</font>$total<font class="kw">,</font><font class="str">','</font><font class="kw">,</font><font class="str">'.'</font><font class="kw">,</font><font class="str">'.'</font><font class="kw">);<br><br></font><font class="cmt">//Create a new PDF file<br></font>$pdf<font class="kw">=new </font>FPDF<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>Open<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>AddPage<font class="kw">();<br><br></font><font class="cmt">//Fields Name position<br></font>$Y_Fields_Name_position <font class="kw">= </font>20<font class="kw">;<br></font><font class="cmt">//Table position, under Fields Name<br></font>$Y_Table_Position <font class="kw">= </font>26<font class="kw">;<br><br></font><font class="cmt">//First create each Field Name<br>//Gray color filling each Field Name box<br></font>$pdf<font class="kw">-&gt;</font>SetFillColor<font class="kw">(</font>232<font class="kw">,</font>232<font class="kw">,</font>232<font class="kw">);<br></font><font class="cmt">//Bold Font for Field Name<br></font>$pdf<font class="kw">-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">'B'</font><font class="kw">,</font>12<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetY<font class="kw">(</font>$Y_Fields_Name_position<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetX<font class="kw">(</font>45<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>20<font class="kw">,</font>6<font class="kw">,</font><font class="str">'CODE'</font><font class="kw">,</font>1<font class="kw">,</font>0<font class="kw">,</font><font class="str">'L'</font><font class="kw">,</font>1<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetX<font class="kw">(</font>65<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>100<font class="kw">,</font>6<font class="kw">,</font><font class="str">'NAME'</font><font class="kw">,</font>1<font class="kw">,</font>0<font class="kw">,</font><font class="str">'L'</font><font class="kw">,</font>1<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetX<font class="kw">(</font>135<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>30<font class="kw">,</font>6<font class="kw">,</font><font class="str">'PRICE'</font><font class="kw">,</font>1<font class="kw">,</font>0<font class="kw">,</font><font class="str">'R'</font><font class="kw">,</font>1<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Ln<font class="kw">();<br><br></font><font class="cmt">//Now show the 3 columns<br></font>$pdf<font class="kw">-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>12<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetY<font class="kw">(</font>$Y_Table_Position<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetX<font class="kw">(</font>45<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>MultiCell<font class="kw">(</font>20<font class="kw">,</font>6<font class="kw">,</font>$column_code<font class="kw">,</font>1<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetY<font class="kw">(</font>$Y_Table_Position<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetX<font class="kw">(</font>65<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>MultiCell<font class="kw">(</font>100<font class="kw">,</font>6<font class="kw">,</font>$column_name<font class="kw">,</font>1<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetY<font class="kw">(</font>$Y_Table_Position<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetX<font class="kw">(</font>135<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>MultiCell<font class="kw">(</font>30<font class="kw">,</font>6<font class="kw">,</font>$columna_price<font class="kw">,</font>1<font class="kw">,</font><font class="str">'R'</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetX<font class="kw">(</font>135<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>MultiCell<font class="kw">(</font>30<font class="kw">,</font>6<font class="kw">,</font><font class="str">'$ '</font><font class="kw">.</font>$total<font class="kw">,</font>1<font class="kw">,</font><font class="str">'R'</font><font class="kw">);<br><br></font><font class="cmt">//Create lines (boxes) for each ROW (Product)<br>//If you don't use the following code, you don't create the lines separating each row<br></font>$i <font class="kw">= </font>0<font class="kw">;<br></font>$pdf<font class="kw">-&gt;</font>SetY<font class="kw">(</font>$Y_Table_Position<font class="kw">);<br>while (</font>$i <font class="kw">&lt; </font>$number_of_products<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$pdf<font class="kw">-&gt;</font>SetX<font class="kw">(</font>45<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$pdf<font class="kw">-&gt;</font>MultiCell<font class="kw">(</font>120<font class="kw">,</font>6<font class="kw">,</font><font class="str">''</font><font class="kw">,</font>1<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$i <font class="kw">= </font>$i <font class="kw">+</font>1<font class="kw">;<br>}<br><br></font>$pdf<font class="kw">-&gt;</font>Output<font class="kw">();<br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>

<H4 CLASS="st">Download</H4><A HREF="script10.zip">ZIP</A> | <A HREF="script10.tgz">TGZ</A>
</BODY>
</HTML>

<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<TITLE>Small caps</TITLE>
<LINK TYPE="text/css" REL="stylesheet" HREF="../fpdf.css">
</HEAD>
<BODY ONLOAD="if(window.focus) window.focus()">
<H2>Small caps</H2>
<H4 CLASS="st">Informations</H4>Author: <SCRIPT TYPE="text/javascript">document.write('<A H'+'REF="m'+'ailto:costi_teleman'+'&#'+'64;'+'yahoo.com?subject=Small%20caps">');</SCRIPT>Constantin Teleman<SCRIPT TYPE="text/javascript">document.write('<\/A>');</SCRIPT><BR>License: Freeware
<H4 CLASS="st">Description</H4>This script allows to write text with small caps. Two methods are available: <TT>CellSmallCaps()</TT> and
<TT>MultiCellSmallCaps()</TT>, with the same parameters as the standard versions.
<H4 CLASS="st">Source</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br><font class="kw">require(</font><font class="str">'fpdf.php'</font><font class="kw">);<br><br>class </font>PDF_SmallCaps <font class="kw">extends </font>FPDF<br><font class="kw">{<br><br></font><font class="cmt">/**<br>* Create the Small Caps effect in a Cell<br>* @author constantin teleman<br>*/<br></font><font class="kw">function </font>CellSmallCaps<font class="kw">(</font>$w<font class="kw">,</font>$h<font class="kw">=</font>0<font class="kw">,</font>$txt<font class="kw">=</font><font class="str">''</font><font class="kw">,</font>$border<font class="kw">=</font>0<font class="kw">,</font>$ln<font class="kw">=</font>0<font class="kw">,</font>$align<font class="kw">=</font><font class="str">''</font><font class="kw">,</font>$fill<font class="kw">=</font>0<font class="kw">,</font>$link<font class="kw">=</font><font class="str">''</font><font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Output a cell<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$k<font class="kw">=</font>$<font class="kw">this-&gt;</font>k<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>y<font class="kw">+</font>$h<font class="kw">&gt;</font>$<font class="kw">this-&gt;</font>PageBreakTrigger <font class="kw">&amp;&amp; !</font>$<font class="kw">this-&gt;</font>InFooter <font class="kw">&amp;&amp; </font>$<font class="kw">this-&gt;</font>AcceptPageBreak<font class="kw">())<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Automatic page break<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$x<font class="kw">=</font>$<font class="kw">this-&gt;</font>x<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$ws<font class="kw">=</font>$<font class="kw">this-&gt;</font>ws<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$ws<font class="kw">&gt;</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>ws<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font><font class="str">'0 Tw'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>AddPage<font class="kw">(</font>$<font class="kw">this-&gt;</font>CurOrientation<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>x<font class="kw">=</font>$x<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$ws<font class="kw">&gt;</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>ws<font class="kw">=</font>$ws<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font>sprintf<font class="kw">(</font><font class="str">'%.3f Tw'</font><font class="kw">,</font>$ws<font class="kw">*</font>$k<font class="kw">));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$w<font class="kw">==</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$w<font class="kw">=</font>$<font class="kw">this-&gt;</font>w<font class="kw">-</font>$<font class="kw">this-&gt;</font>rMargin<font class="kw">-</font>$<font class="kw">this-&gt;</font>x<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">=</font><font class="str">''</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$fill<font class="kw">==</font>1 <font class="kw">|| </font>$border<font class="kw">==</font>1<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$fill<font class="kw">==</font>1<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$op<font class="kw">=(</font>$border<font class="kw">==</font>1<font class="kw">) ? </font><font class="str">'B' </font><font class="kw">: </font><font class="str">'f'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$op<font class="kw">=</font><font class="str">'S'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">=</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f %.2f %.2f re %s '</font><font class="kw">,</font>$<font class="kw">this-&gt;</font>x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$<font class="kw">this-&gt;</font>y<font class="kw">)*</font>$k<font class="kw">,</font>$w<font class="kw">*</font>$k<font class="kw">,-</font>$h<font class="kw">*</font>$k<font class="kw">,</font>$op<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>is_string<font class="kw">(</font>$border<font class="kw">))<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$x<font class="kw">=</font>$<font class="kw">this-&gt;</font>x<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$y<font class="kw">=</font>$<font class="kw">this-&gt;</font>y<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'L'</font><font class="kw">)!==</font>false<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f m %.2f %.2f l S '</font><font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'T'</font><font class="kw">)!==</font>false<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f m %.2f %.2f l S '</font><font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'R'</font><font class="kw">)!==</font>false<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f m %.2f %.2f l S '</font><font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'B'</font><font class="kw">)!==</font>false<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f m %.2f %.2f l S '</font><font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$txt<font class="kw">!==</font><font class="str">''</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//part for calculating position of text<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if(</font>$align<font class="kw">==</font><font class="str">'R'</font><font class="kw">) </font><font class="cmt">//right align<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$dx<font class="kw">=</font>$w<font class="kw">-</font>$<font class="kw">this-&gt;</font>cMargin<font class="kw">-</font>$<font class="kw">this-&gt;</font>GetStringWidth<font class="kw">(</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif(</font>$align<font class="kw">==</font><font class="str">'C'</font><font class="kw">) </font><font class="cmt">//center align<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$dx<font class="kw">=(</font>$w<font class="kw">-</font>$<font class="kw">this-&gt;</font>GetStringWidth<font class="kw">(</font>$txt<font class="kw">))/</font>2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;</font><font class="cmt">//for left align<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$dx<font class="kw">=</font>$<font class="kw">this-&gt;</font>cMargin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>ColorFlag<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font><font class="str">'q '</font><font class="kw">.</font>$<font class="kw">this-&gt;</font>TextColor<font class="kw">.</font><font class="str">' '</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$txt2<font class="kw">=</font>str_replace<font class="kw">(</font><font class="str">')'</font><font class="kw">,</font><font class="str">'\\)'</font><font class="kw">,</font>str_replace<font class="kw">(</font><font class="str">'('</font><font class="kw">,</font><font class="str">'\\('</font><font class="kw">,</font>str_replace<font class="kw">(</font><font class="str">'\\'</font><font class="kw">,</font><font class="str">'\\\\'</font><font class="kw">,</font>$txt<font class="kw">)));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//first letter in the word<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//$txtFirst = strtoupper(substr($txt2,0,1));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//$txtRest = strtoupper(substr($txt2,1));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$firstDx <font class="kw">= </font>$dx<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (</font>$i<font class="kw">=</font>0<font class="kw">; </font>$i<font class="kw">&lt;</font>strlen<font class="kw">(</font>$txt2<font class="kw">); </font>$i<font class="kw">++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$letter <font class="kw">= </font>substr<font class="kw">(</font>$txt2<font class="kw">,</font>$i<font class="kw">,</font>1<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$upper <font class="kw">= </font>strpos<font class="kw">(</font><font class="str">"ABCDEFGHIJKLMNOPQRSTUVWXZ0123456789`!@#</font><font class="kw">$</font><font class="str">%^&amp;*()_=+|'</font><font class="kw">\"</font><font class="str">;:</font><font class="kw">{}[]</font><font class="str">?,.&lt;&gt;"</font><font class="kw">,</font>$letter<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$upper <font class="kw">=== </font>false<font class="kw">) { </font><font class="cmt">//case the letter is lowercase<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if(</font>$i<font class="kw">==</font>0<font class="kw">){ </font><font class="cmt">//for the first char<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">' BT /F%d %.2f Tf'</font><font class="kw">,</font>$<font class="kw">this-&gt;</font>CurrentFont<font class="kw">[</font><font class="str">'i'</font><font class="kw">],</font>$<font class="kw">this-&gt;</font>FontSizePt<font class="kw">*</font>0.8<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">' %.2f %.2f Td (%s) Tj'</font><font class="kw">,(</font>$<font class="kw">this-&gt;</font>x<font class="kw">+</font>$dx<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$<font class="kw">this-&gt;</font>y<font class="kw">+</font>.5<font class="kw">*</font>$h<font class="kw">+</font>.3<font class="kw">*</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">))*</font>$k<font class="kw">,</font>strtoupper<font class="kw">(</font>$letter<font class="kw">));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">' /F%d %.2f Tf ET'</font><font class="kw">,</font>$<font class="kw">this-&gt;</font>CurrentFont<font class="kw">[</font><font class="str">'i'</font><font class="kw">],</font>$<font class="kw">this-&gt;</font>FontSizePt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {&nbsp;&nbsp;</font><font class="cmt">// if there is no first char<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">' BT /F%d %.2f Tf'</font><font class="kw">,</font>$<font class="kw">this-&gt;</font>CurrentFont<font class="kw">[</font><font class="str">'i'</font><font class="kw">],</font>$<font class="kw">this-&gt;</font>FontSizePt<font class="kw">*</font>0.8<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$dx<font class="kw">+=(</font>$<font class="kw">this-&gt;</font>GetStringWidth<font class="kw">(</font>substr<font class="kw">(</font>$txt2<font class="kw">,</font>$i<font class="kw">-</font>1<font class="kw">,</font>1<font class="kw">)))*</font>1.02<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">' %.2f %.2f Td (%s) Tj'</font><font class="kw">,(</font>$<font class="kw">this-&gt;</font>x<font class="kw">+</font>$dx<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$<font class="kw">this-&gt;</font>y<font class="kw">+</font>.5<font class="kw">*</font>$h<font class="kw">+</font>.3<font class="kw">*</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">))*</font>$k<font class="kw">,</font>strtoupper<font class="kw">(</font>$letter<font class="kw">));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">' /F%d %.2f Tf ET'</font><font class="kw">,</font>$<font class="kw">this-&gt;</font>CurrentFont<font class="kw">[</font><font class="str">'i'</font><font class="kw">],</font>$<font class="kw">this-&gt;</font>FontSizePt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else { </font><font class="cmt">//case the letter is uppercase<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if(</font>$i <font class="kw">== </font>0<font class="kw">){ </font><font class="cmt">//for the first char<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">' BT %.2f %.2f Td (%s) Tj ET'</font><font class="kw">,(</font>$<font class="kw">this-&gt;</font>x<font class="kw">+</font>$dx<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$<font class="kw">this-&gt;</font>y<font class="kw">+</font>.5<font class="kw">*</font>$h<font class="kw">+</font>.3<font class="kw">*</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">))*</font>$k<font class="kw">,</font>$letter<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {&nbsp;&nbsp;</font><font class="cmt">// if there is no first char<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$dx<font class="kw">+=(</font>$<font class="kw">this-&gt;</font>GetStringWidth<font class="kw">(</font>substr<font class="kw">(</font>$txt2<font class="kw">,</font>$i<font class="kw">-</font>1<font class="kw">,</font>1<font class="kw">)))*</font>1.02<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">' BT %.2f %.2f Td (%s) Tj ET'</font><font class="kw">,(</font>$<font class="kw">this-&gt;</font>x<font class="kw">+</font>$dx<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$<font class="kw">this-&gt;</font>y<font class="kw">+</font>.5<font class="kw">*</font>$h<font class="kw">+</font>.3<font class="kw">*</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">))*</font>$k<font class="kw">,</font>$letter<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>underline<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font><font class="str">' '</font><font class="kw">.</font>$<font class="kw">this-&gt;</font>_dounderline<font class="kw">(</font>$<font class="kw">this-&gt;</font>x<font class="kw">+</font>$firstDx<font class="kw">,</font>$<font class="kw">this-&gt;</font>y<font class="kw">+</font>.5<font class="kw">*</font>$h<font class="kw">+</font>.3<font class="kw">*</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">,</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>ColorFlag<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font><font class="str">' Q'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$link<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Link<font class="kw">(</font>$<font class="kw">this-&gt;</font>x<font class="kw">+</font>$firstDx<font class="kw">,</font>$<font class="kw">this-&gt;</font>y<font class="kw">+</font>.5<font class="kw">*</font>$h<font class="kw">-</font>.5<font class="kw">*</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">,</font>$<font class="kw">this-&gt;</font>GetStringWidth<font class="kw">(</font>$txt<font class="kw">),</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">,</font>$link<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$s<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font>$s<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>lasth<font class="kw">=</font>$h<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$ln<font class="kw">&gt;</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Go to next line<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>y<font class="kw">+=</font>$h<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$ln<font class="kw">==</font>1<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>x<font class="kw">=</font>$<font class="kw">this-&gt;</font>lMargin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>x<font class="kw">+=</font>$w<font class="kw">;<br>}<br><br></font><font class="cmt">/**<br>* Create the Small Caps effect in a MultiCell<br>* @author constantin teleman<br>*/<br></font><font class="kw">function </font>MultiCellSmallCaps<font class="kw">(</font>$w<font class="kw">,</font>$h<font class="kw">,</font>$txt<font class="kw">,</font>$border<font class="kw">=</font>0<font class="kw">,</font>$align<font class="kw">=</font><font class="str">''</font><font class="kw">,</font>$fill<font class="kw">=</font>0<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Output text with automatic or explicit line breaks<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$cw<font class="kw">=&amp;</font>$<font class="kw">this-&gt;</font>CurrentFont<font class="kw">[</font><font class="str">'cw'</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$w<font class="kw">==</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$w<font class="kw">=</font>$<font class="kw">this-&gt;</font>w<font class="kw">-</font>$<font class="kw">this-&gt;</font>rMargin<font class="kw">-</font>$<font class="kw">this-&gt;</font>x<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$wmax<font class="kw">=(</font>$w<font class="kw">-</font>2<font class="kw">*</font>$<font class="kw">this-&gt;</font>cMargin<font class="kw">)*</font>1000<font class="kw">/</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">=</font>str_replace<font class="kw">(</font><font class="str">"\r"</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$nb<font class="kw">=</font>strlen<font class="kw">(</font>$s<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$nb<font class="kw">&gt;</font>0 <font class="kw">&amp;&amp; </font>$s<font class="kw">[</font>$nb<font class="kw">-</font>1<font class="kw">]==</font><font class="str">"\n"</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$nb<font class="kw">--;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$b<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$border<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$border<font class="kw">==</font>1<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$border<font class="kw">=</font><font class="str">'LTRB'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$b<font class="kw">=</font><font class="str">'LRT'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$b2<font class="kw">=</font><font class="str">'LR'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$b2<font class="kw">=</font><font class="str">''</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'L'</font><font class="kw">)!==</font>false<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$b2<font class="kw">.=</font><font class="str">'L'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'R'</font><font class="kw">)!==</font>false<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$b2<font class="kw">.=</font><font class="str">'R'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$b<font class="kw">=(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'T'</font><font class="kw">)!==</font>false<font class="kw">) ? </font>$b2<font class="kw">.</font><font class="str">'T' </font><font class="kw">: </font>$b2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$sep<font class="kw">=-</font>1<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$i<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$j<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$l<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$ns<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$nl<font class="kw">=</font>1<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;while(</font>$i<font class="kw">&lt;</font>$nb<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Get next character<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$c<font class="kw">=</font>$s<font class="kw">{</font>$i<font class="kw">};<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$c<font class="kw">==</font><font class="str">"\n"</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Explicit line break<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if(</font>$<font class="kw">this-&gt;</font>ws<font class="kw">&gt;</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>ws<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font><font class="str">'0 Tw'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>CellSmallCaps<font class="kw">(</font>$w<font class="kw">,</font>$h<font class="kw">,</font>substr<font class="kw">(</font>$s<font class="kw">,</font>$j<font class="kw">,</font>$i<font class="kw">-</font>$j<font class="kw">),</font>$b<font class="kw">,</font>2<font class="kw">,</font>$align<font class="kw">,</font>$fill<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$i<font class="kw">++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$sep<font class="kw">=-</font>1<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$j<font class="kw">=</font>$i<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$l<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$ns<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$nl<font class="kw">++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$border <font class="kw">&amp;&amp; </font>$nl<font class="kw">==</font>2<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$b<font class="kw">=</font>$b2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$c<font class="kw">==</font><font class="str">' '</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$sep<font class="kw">=</font>$i<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$ls<font class="kw">=</font>$l<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$ns<font class="kw">++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$l<font class="kw">+=</font>$cw<font class="kw">[</font>$c<font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$l<font class="kw">&gt;</font>$wmax<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Automatic line break<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if(</font>$sep<font class="kw">==-</font>1<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$i<font class="kw">==</font>$j<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$i<font class="kw">++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>ws<font class="kw">&gt;</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>ws<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font><font class="str">'0 Tw'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>CellSmallCaps<font class="kw">(</font>$w<font class="kw">,</font>$h<font class="kw">,</font>substr<font class="kw">(</font>$s<font class="kw">,</font>$j<font class="kw">,</font>$i<font class="kw">-</font>$j<font class="kw">),</font>$b<font class="kw">,</font>2<font class="kw">,</font>$align<font class="kw">,</font>$fill<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$align<font class="kw">==</font><font class="str">'J'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>ws<font class="kw">=(</font>$ns<font class="kw">&gt;</font>1<font class="kw">) ? (</font>$wmax<font class="kw">-</font>$ls<font class="kw">)/</font>1000<font class="kw">*</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">/(</font>$ns<font class="kw">-</font>1<font class="kw">) : </font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font>sprintf<font class="kw">(</font><font class="str">'%.3f Tw'</font><font class="kw">,</font>$<font class="kw">this-&gt;</font>ws<font class="kw">*</font>$<font class="kw">this-&gt;</font>k<font class="kw">));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>CellSmallCaps<font class="kw">(</font>$w<font class="kw">,</font>$h<font class="kw">,</font>substr<font class="kw">(</font>$s<font class="kw">,</font>$j<font class="kw">,</font>$sep<font class="kw">-</font>$j<font class="kw">),</font>$b<font class="kw">,</font>2<font class="kw">,</font>$align<font class="kw">,</font>$fill<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$i<font class="kw">=</font>$sep<font class="kw">+</font>1<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$sep<font class="kw">=-</font>1<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$j<font class="kw">=</font>$i<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$l<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$ns<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$nl<font class="kw">++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$border <font class="kw">&amp;&amp; </font>$nl<font class="kw">==</font>2<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$b<font class="kw">=</font>$b2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$i<font class="kw">++;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Last chunk<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if(</font>$<font class="kw">this-&gt;</font>ws<font class="kw">&gt;</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>ws<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font><font class="str">'0 Tw'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$border <font class="kw">&amp;&amp; </font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'B'</font><font class="kw">)!==</font>false<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$b<font class="kw">.=</font><font class="str">'B'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>CellSmallCaps<font class="kw">(</font>$w<font class="kw">,</font>$h<font class="kw">,</font>substr<font class="kw">(</font>$s<font class="kw">,</font>$j<font class="kw">,</font>$i<font class="kw">-</font>$j<font class="kw">),</font>$b<font class="kw">,</font>2<font class="kw">,</font>$align<font class="kw">,</font>$fill<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>x<font class="kw">=</font>$<font class="kw">this-&gt;</font>lMargin<font class="kw">;<br>}<br><br>}<br><br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>

<H4 CLASS="st">Example</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br><font class="kw">require(</font><font class="str">'smallcaps.php'</font><font class="kw">);<br><br></font>$pdf<font class="kw">=new </font>PDF_SmallCaps<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>AddPage<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Courier'</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>30<font class="kw">);<br>for (</font>$i <font class="kw">= </font>30<font class="kw">; </font>$i<font class="kw">&gt;</font>4<font class="kw">; </font>$i<font class="kw">--) {<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$pdf<font class="kw">-&gt;</font>SetFontSize<font class="kw">(</font>$i<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$pdf<font class="kw">-&gt;</font>CellSmallCaps<font class="kw">(</font>180<font class="kw">,</font>8<font class="kw">,</font><font class="str">"The Code and Text Editor"</font><font class="kw">,</font>0<font class="kw">,</font>1<font class="kw">);<br>}<br></font>$pdf<font class="kw">-&gt;</font>SetFontSize<font class="kw">(</font>10<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>MultiCellSmallCaps<font class="kw">(</font>180<font class="kw">,</font>6<font class="kw">,</font><font class="str">'The Code and Text Editor is a word processing utility where you enter, display, and edit code or text.'</font><font class="kw">.<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">' It is referred to as either the Text Editor or the Code Editor, based on its content.'</font><font class="kw">.<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">' If it contains only text without an associated language, it is referred to as the Text Editor.'</font><font class="kw">.<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">' If it contains source code associated with a language, it is referred to as the Code Editor.'</font><font class="kw">.<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">' Because it is most often used for editing code, though, we will refer to it as the Code Editor.'</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Output<font class="kw">();<br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>
<BR>
View the result <A HREF="ex77.pdf" TARGET="_blank">here</A>.
<H4 CLASS="st">Download</H4><A HREF="script77.zip">ZIP</A> | <A HREF="script77.tgz">TGZ</A>
</BODY>
</HTML>

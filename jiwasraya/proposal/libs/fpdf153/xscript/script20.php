<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<TITLE>Invoice</TITLE>
<LINK TYPE="text/css" REL="stylesheet" HREF="../fpdf.css">
</HEAD>
<BODY ONLOAD="if(window.focus) window.focus()">
<H2>Invoice</H2>
<H4 CLASS="st">Informations</H4>Author: <SCRIPT TYPE="text/javascript">document.write('<A H'+'REF="m'+'ailto:XavierNicolay'+'&#'+'64;'+'ifrance.com?subject=Invoice">');</SCRIPT>Xavier Nicolay<SCRIPT TYPE="text/javascript">document.write('<\/A>');</SCRIPT><BR>License: Freeware
<H4 CLASS="st">Description</H4>This script shows an example of invoice or estimate.
<H4 CLASS="st">Source</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br><font class="kw">require(</font><font class="str">'fpdf.php'</font><font class="kw">);<br></font>define<font class="kw">(</font><font class="str">'EURO'</font><font class="kw">, </font>chr<font class="kw">(</font>128<font class="kw">) );<br></font>define<font class="kw">(</font><font class="str">'EURO_VAL'</font><font class="kw">, </font>6.55957 <font class="kw">);<br><br></font><font class="cmt">// Xavier Nicolay 2004<br>// Version 1.01<br><br>//////////////////////////////////////<br>// Public functions&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//<br>//////////////////////////////////////<br>//&nbsp;&nbsp;function sizeOfText( $texte, $larg )<br>//&nbsp;&nbsp;function addSociete( $nom, $adresse )<br>//&nbsp;&nbsp;function fact_dev( $libelle, $num )<br>//&nbsp;&nbsp;function addDevis( $numdev )<br>//&nbsp;&nbsp;function addFacture( $numfact )<br>//&nbsp;&nbsp;function addDate( $date )<br>//&nbsp;&nbsp;function addClient( $ref )<br>//&nbsp;&nbsp;function addPageNumber( $page )<br>//&nbsp;&nbsp;function addClientAdresse( $adresse )<br>//&nbsp;&nbsp;function addReglement( $mode )<br>//&nbsp;&nbsp;function addEcheance( $date )<br>//&nbsp;&nbsp;function addNumTVA($tva)<br>//&nbsp;&nbsp;function addReference($ref)<br>//&nbsp;&nbsp;function addCols( $tab )<br>//&nbsp;&nbsp;function addLineFormat( $tab )<br>//&nbsp;&nbsp;function lineVert( $tab )<br>//&nbsp;&nbsp;function addLine( $ligne, $tab )<br>//&nbsp;&nbsp;function addRemarque($remarque)<br>//&nbsp;&nbsp;function addCadreTVAs()<br>//&nbsp;&nbsp;function addCadreEurosFrancs()<br>//&nbsp;&nbsp;function addTVAs( $params, $tab_tva, $invoice )<br>//&nbsp;&nbsp;function temporaire( $texte )<br><br></font><font class="kw">class </font>INVOICE <font class="kw">extends </font>FPDF<br><font class="kw">{<br></font><font class="cmt">// private variables<br></font><font class="kw">var </font>$colonnes<font class="kw">;<br>var </font>$format<font class="kw">;<br>var </font>$angle<font class="kw">=</font>0<font class="kw">;<br><br></font><font class="cmt">// private functions<br></font><font class="kw">function </font>RoundedRect<font class="kw">(</font>$x<font class="kw">, </font>$y<font class="kw">, </font>$w<font class="kw">, </font>$h<font class="kw">, </font>$r<font class="kw">, </font>$style <font class="kw">= </font><font class="str">''</font><font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$k <font class="kw">= </font>$<font class="kw">this-&gt;</font>k<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$hp <font class="kw">= </font>$<font class="kw">this-&gt;</font>h<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$style<font class="kw">==</font><font class="str">'F'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$op<font class="kw">=</font><font class="str">'f'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;elseif(</font>$style<font class="kw">==</font><font class="str">'FD' </font><font class="kw">or </font>$style<font class="kw">==</font><font class="str">'DF'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$op<font class="kw">=</font><font class="str">'B'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$op<font class="kw">=</font><font class="str">'S'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$MyArc <font class="kw">= </font>4<font class="kw">/</font>3 <font class="kw">* (</font>sqrt<font class="kw">(</font>2<font class="kw">) - </font>1<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f m'</font><font class="kw">,(</font>$x<font class="kw">+</font>$r<font class="kw">)*</font>$k<font class="kw">,(</font>$hp<font class="kw">-</font>$y<font class="kw">)*</font>$k <font class="kw">));<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$xc <font class="kw">= </font>$x<font class="kw">+</font>$w<font class="kw">-</font>$r <font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$yc <font class="kw">= </font>$y<font class="kw">+</font>$r<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f l'</font><font class="kw">, </font>$xc<font class="kw">*</font>$k<font class="kw">,(</font>$hp<font class="kw">-</font>$y<font class="kw">)*</font>$k <font class="kw">));<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Arc<font class="kw">(</font>$xc <font class="kw">+ </font>$r<font class="kw">*</font>$MyArc<font class="kw">, </font>$yc <font class="kw">- </font>$r<font class="kw">, </font>$xc <font class="kw">+ </font>$r<font class="kw">, </font>$yc <font class="kw">- </font>$r<font class="kw">*</font>$MyArc<font class="kw">, </font>$xc <font class="kw">+ </font>$r<font class="kw">, </font>$yc<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$xc <font class="kw">= </font>$x<font class="kw">+</font>$w<font class="kw">-</font>$r <font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$yc <font class="kw">= </font>$y<font class="kw">+</font>$h<font class="kw">-</font>$r<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f l'</font><font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$hp<font class="kw">-</font>$yc<font class="kw">)*</font>$k<font class="kw">));<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Arc<font class="kw">(</font>$xc <font class="kw">+ </font>$r<font class="kw">, </font>$yc <font class="kw">+ </font>$r<font class="kw">*</font>$MyArc<font class="kw">, </font>$xc <font class="kw">+ </font>$r<font class="kw">*</font>$MyArc<font class="kw">, </font>$yc <font class="kw">+ </font>$r<font class="kw">, </font>$xc<font class="kw">, </font>$yc <font class="kw">+ </font>$r<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$xc <font class="kw">= </font>$x<font class="kw">+</font>$r <font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$yc <font class="kw">= </font>$y<font class="kw">+</font>$h<font class="kw">-</font>$r<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f l'</font><font class="kw">,</font>$xc<font class="kw">*</font>$k<font class="kw">,(</font>$hp<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">));<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Arc<font class="kw">(</font>$xc <font class="kw">- </font>$r<font class="kw">*</font>$MyArc<font class="kw">, </font>$yc <font class="kw">+ </font>$r<font class="kw">, </font>$xc <font class="kw">- </font>$r<font class="kw">, </font>$yc <font class="kw">+ </font>$r<font class="kw">*</font>$MyArc<font class="kw">, </font>$xc <font class="kw">- </font>$r<font class="kw">, </font>$yc<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$xc <font class="kw">= </font>$x<font class="kw">+</font>$r <font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$yc <font class="kw">= </font>$y<font class="kw">+</font>$r<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f l'</font><font class="kw">,(</font>$x<font class="kw">)*</font>$k<font class="kw">,(</font>$hp<font class="kw">-</font>$yc<font class="kw">)*</font>$k <font class="kw">));<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_Arc<font class="kw">(</font>$xc <font class="kw">- </font>$r<font class="kw">, </font>$yc <font class="kw">- </font>$r<font class="kw">*</font>$MyArc<font class="kw">, </font>$xc <font class="kw">- </font>$r<font class="kw">*</font>$MyArc<font class="kw">, </font>$yc <font class="kw">- </font>$r<font class="kw">, </font>$xc<font class="kw">, </font>$yc <font class="kw">- </font>$r<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font>$op<font class="kw">);<br>}<br><br>function </font>_Arc<font class="kw">(</font>$x1<font class="kw">, </font>$y1<font class="kw">, </font>$x2<font class="kw">, </font>$y2<font class="kw">, </font>$x3<font class="kw">, </font>$y3<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$h <font class="kw">= </font>$<font class="kw">this-&gt;</font>h<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f %.2f %.2f %.2f %.2f c '</font><font class="kw">, </font>$x1<font class="kw">*</font>$<font class="kw">this-&gt;</font>k<font class="kw">, (</font>$h<font class="kw">-</font>$y1<font class="kw">)*</font>$<font class="kw">this-&gt;</font>k<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$x2<font class="kw">*</font>$<font class="kw">this-&gt;</font>k<font class="kw">, (</font>$h<font class="kw">-</font>$y2<font class="kw">)*</font>$<font class="kw">this-&gt;</font>k<font class="kw">, </font>$x3<font class="kw">*</font>$<font class="kw">this-&gt;</font>k<font class="kw">, (</font>$h<font class="kw">-</font>$y3<font class="kw">)*</font>$<font class="kw">this-&gt;</font>k<font class="kw">));<br>}<br><br>function </font>Rotate<font class="kw">(</font>$angle<font class="kw">,</font>$x<font class="kw">=-</font>1<font class="kw">,</font>$y<font class="kw">=-</font>1<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$x<font class="kw">==-</font>1<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$x<font class="kw">=</font>$<font class="kw">this-&gt;</font>x<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$y<font class="kw">==-</font>1<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$y<font class="kw">=</font>$<font class="kw">this-&gt;</font>y<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>angle<font class="kw">!=</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font><font class="str">'Q'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>angle<font class="kw">=</font>$angle<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$angle<font class="kw">!=</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$angle<font class="kw">*=</font>M_PI<font class="kw">/</font>180<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$c<font class="kw">=</font>cos<font class="kw">(</font>$angle<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">=</font>sin<font class="kw">(</font>$angle<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$cx<font class="kw">=</font>$x<font class="kw">*</font>$<font class="kw">this-&gt;</font>k<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$cy<font class="kw">=(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$<font class="kw">this-&gt;</font>k<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font>sprintf<font class="kw">(</font><font class="str">'q %.5f %.5f %.5f %.5f %.2f %.2f cm 1 0 0 1 %.2f %.2f cm'</font><font class="kw">,</font>$c<font class="kw">,</font>$s<font class="kw">,-</font>$s<font class="kw">,</font>$c<font class="kw">,</font>$cx<font class="kw">,</font>$cy<font class="kw">,-</font>$cx<font class="kw">,-</font>$cy<font class="kw">));<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br><br>function </font>_endpage<font class="kw">()<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>angle<font class="kw">!=</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>angle<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font><font class="str">'Q'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">parent::</font>_endpage<font class="kw">();<br>}<br><br></font><font class="cmt">// public functions<br></font><font class="kw">function </font>sizeOfText<font class="kw">( </font>$texte<font class="kw">, </font>$largeur <font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$index&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$nb_lines <font class="kw">= </font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$loop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>TRUE<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;while ( </font>$loop <font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$pos <font class="kw">= </font>strpos<font class="kw">(</font>$texte<font class="kw">, </font><font class="str">"\n"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!</font>$pos<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$loop&nbsp;&nbsp;<font class="kw">= </font>FALSE<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$ligne <font class="kw">= </font>$texte<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$ligne&nbsp;&nbsp;<font class="kw">= </font>substr<font class="kw">( </font>$texte<font class="kw">, </font>$index<font class="kw">, </font>$pos<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$texte <font class="kw">= </font>substr<font class="kw">( </font>$texte<font class="kw">, </font>$pos<font class="kw">+</font>1 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$length <font class="kw">= </font>floor<font class="kw">( </font>$<font class="kw">this-&gt;</font>GetStringWidth<font class="kw">( </font>$ligne <font class="kw">) );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$res <font class="kw">= </font>1 <font class="kw">+ </font>floor<font class="kw">( </font>$length <font class="kw">/ </font>$largeur<font class="kw">) ;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$nb_lines <font class="kw">+= </font>$res<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;return </font>$nb_lines<font class="kw">;<br>}<br><br></font><font class="cmt">// Company<br></font><font class="kw">function </font>addSociete<font class="kw">( </font>$nom<font class="kw">, </font>$adresse <font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$x1 <font class="kw">= </font>10<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y1 <font class="kw">= </font>8<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Positionnement en bas<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$x1<font class="kw">, </font>$y1 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">'B'</font><font class="kw">,</font>12<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$length <font class="kw">= </font>$<font class="kw">this-&gt;</font>GetStringWidth<font class="kw">( </font>$nom <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>$length<font class="kw">, </font>2<font class="kw">, </font>$nom<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$x1<font class="kw">, </font>$y1 <font class="kw">+ </font>4 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$length <font class="kw">= </font>$<font class="kw">this-&gt;</font>GetStringWidth<font class="kw">( </font>$adresse <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Coordonnées de la société<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$lignes <font class="kw">= </font>$<font class="kw">this-&gt;</font>sizeOfText<font class="kw">( </font>$adresse<font class="kw">, </font>$length<font class="kw">) ;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>MultiCell<font class="kw">(</font>$length<font class="kw">, </font>4<font class="kw">, </font>$adresse<font class="kw">);<br>}<br><br></font><font class="cmt">// Label and number of invoice/estimate<br></font><font class="kw">function </font>fact_dev<font class="kw">( </font>$libelle<font class="kw">, </font>$num <font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r1&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>w <font class="kw">- </font>80<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r2&nbsp;&nbsp;<font class="kw">= </font>$r1 <font class="kw">+ </font>68<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y1&nbsp;&nbsp;<font class="kw">= </font>6<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y2&nbsp;&nbsp;<font class="kw">= </font>$y1 <font class="kw">+ </font>2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$mid <font class="kw">= (</font>$r1 <font class="kw">+ </font>$r2 <font class="kw">) / </font>2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$texte&nbsp;&nbsp;<font class="kw">= </font>$libelle <font class="kw">. </font><font class="str">" EN " </font><font class="kw">. </font>EURO <font class="kw">. </font><font class="str">" N° : " </font><font class="kw">. </font>$num<font class="kw">;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$szfont <font class="kw">= </font>12<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$loop&nbsp;&nbsp;&nbsp;<font class="kw">= </font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;while ( </font>$loop <font class="kw">== </font>0 <font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Helvetica"</font><font class="kw">, </font><font class="str">"B"</font><font class="kw">, </font>$szfont <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$sz <font class="kw">= </font>$<font class="kw">this-&gt;</font>GetStringWidth<font class="kw">( </font>$texte <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( (</font>$r1<font class="kw">+</font>$sz<font class="kw">) &gt; </font>$r2 <font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$szfont <font class="kw">--;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$loop <font class="kw">++;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetLineWidth<font class="kw">(</font>0.1<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFillColor<font class="kw">(</font>192<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>RoundedRect<font class="kw">(</font>$r1<font class="kw">, </font>$y1<font class="kw">, (</font>$r2 <font class="kw">- </font>$r1<font class="kw">), </font>$y2<font class="kw">, </font>2.5<font class="kw">, </font><font class="str">'DF'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1<font class="kw">+</font>1<font class="kw">, </font>$y1<font class="kw">+</font>2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$r2<font class="kw">-</font>$r1 <font class="kw">-</font>1<font class="kw">,</font>5<font class="kw">, </font>$texte<font class="kw">, </font>0<font class="kw">, </font>0<font class="kw">, </font><font class="str">"C" </font><font class="kw">);<br>}<br><br></font><font class="cmt">// Estimate<br></font><font class="kw">function </font>addDevis<font class="kw">( </font>$numdev <font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$string <font class="kw">= </font>sprintf<font class="kw">(</font><font class="str">"DEV%04d"</font><font class="kw">,</font>$numdev<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>fact_dev<font class="kw">( </font><font class="str">"Devis"</font><font class="kw">, </font>$string <font class="kw">);<br>}<br><br></font><font class="cmt">// Invoice<br></font><font class="kw">function </font>addFacture<font class="kw">( </font>$numfact <font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$string <font class="kw">= </font>sprintf<font class="kw">(</font><font class="str">"FA%04d"</font><font class="kw">,</font>$numfact<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>fact_dev<font class="kw">( </font><font class="str">"Facture"</font><font class="kw">, </font>$string <font class="kw">);<br>}<br><br>function </font>addDate<font class="kw">( </font>$date <font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r1&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>w <font class="kw">- </font>61<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r2&nbsp;&nbsp;<font class="kw">= </font>$r1 <font class="kw">+ </font>30<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y1&nbsp;&nbsp;<font class="kw">= </font>17<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y2&nbsp;&nbsp;<font class="kw">= </font>$y1 <font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$mid <font class="kw">= </font>$y1 <font class="kw">+ (</font>$y2 <font class="kw">/ </font>2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>RoundedRect<font class="kw">(</font>$r1<font class="kw">, </font>$y1<font class="kw">, (</font>$r2 <font class="kw">- </font>$r1<font class="kw">), </font>$y2<font class="kw">, </font>3.5<font class="kw">, </font><font class="str">'D'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">( </font>$r1<font class="kw">, </font>$mid<font class="kw">, </font>$r2<font class="kw">, </font>$mid<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1 <font class="kw">+ (</font>$r2<font class="kw">-</font>$r1<font class="kw">)/</font>2 <font class="kw">- </font>5<font class="kw">, </font>$y1<font class="kw">+</font>3 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Helvetica"</font><font class="kw">, </font><font class="str">"B"</font><font class="kw">, </font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>10<font class="kw">,</font>5<font class="kw">, </font><font class="str">"DATE"</font><font class="kw">, </font>0<font class="kw">, </font>0<font class="kw">, </font><font class="str">"C"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1 <font class="kw">+ (</font>$r2<font class="kw">-</font>$r1<font class="kw">)/</font>2 <font class="kw">- </font>5<font class="kw">, </font>$y1<font class="kw">+</font>9 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Helvetica"</font><font class="kw">, </font><font class="str">""</font><font class="kw">, </font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>10<font class="kw">,</font>5<font class="kw">,</font>$date<font class="kw">, </font>0<font class="kw">,</font>0<font class="kw">, </font><font class="str">"C"</font><font class="kw">);<br>}<br><br>function </font>addClient<font class="kw">( </font>$ref <font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r1&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>w <font class="kw">- </font>31<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r2&nbsp;&nbsp;<font class="kw">= </font>$r1 <font class="kw">+ </font>19<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y1&nbsp;&nbsp;<font class="kw">= </font>17<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y2&nbsp;&nbsp;<font class="kw">= </font>$y1<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$mid <font class="kw">= </font>$y1 <font class="kw">+ (</font>$y2 <font class="kw">/ </font>2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>RoundedRect<font class="kw">(</font>$r1<font class="kw">, </font>$y1<font class="kw">, (</font>$r2 <font class="kw">- </font>$r1<font class="kw">), </font>$y2<font class="kw">, </font>3.5<font class="kw">, </font><font class="str">'D'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">( </font>$r1<font class="kw">, </font>$mid<font class="kw">, </font>$r2<font class="kw">, </font>$mid<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1 <font class="kw">+ (</font>$r2<font class="kw">-</font>$r1<font class="kw">)/</font>2 <font class="kw">- </font>5<font class="kw">, </font>$y1<font class="kw">+</font>3 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Helvetica"</font><font class="kw">, </font><font class="str">"B"</font><font class="kw">, </font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>10<font class="kw">,</font>5<font class="kw">, </font><font class="str">"CLIENT"</font><font class="kw">, </font>0<font class="kw">, </font>0<font class="kw">, </font><font class="str">"C"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1 <font class="kw">+ (</font>$r2<font class="kw">-</font>$r1<font class="kw">)/</font>2 <font class="kw">- </font>5<font class="kw">, </font>$y1 <font class="kw">+ </font>9 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Helvetica"</font><font class="kw">, </font><font class="str">""</font><font class="kw">, </font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>10<font class="kw">,</font>5<font class="kw">,</font>$ref<font class="kw">, </font>0<font class="kw">,</font>0<font class="kw">, </font><font class="str">"C"</font><font class="kw">);<br>}<br><br>function </font>addPageNumber<font class="kw">( </font>$page <font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r1&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>w <font class="kw">- </font>80<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r2&nbsp;&nbsp;<font class="kw">= </font>$r1 <font class="kw">+ </font>19<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y1&nbsp;&nbsp;<font class="kw">= </font>17<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y2&nbsp;&nbsp;<font class="kw">= </font>$y1<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$mid <font class="kw">= </font>$y1 <font class="kw">+ (</font>$y2 <font class="kw">/ </font>2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>RoundedRect<font class="kw">(</font>$r1<font class="kw">, </font>$y1<font class="kw">, (</font>$r2 <font class="kw">- </font>$r1<font class="kw">), </font>$y2<font class="kw">, </font>3.5<font class="kw">, </font><font class="str">'D'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">( </font>$r1<font class="kw">, </font>$mid<font class="kw">, </font>$r2<font class="kw">, </font>$mid<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1 <font class="kw">+ (</font>$r2<font class="kw">-</font>$r1<font class="kw">)/</font>2 <font class="kw">- </font>5<font class="kw">, </font>$y1<font class="kw">+</font>3 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Helvetica"</font><font class="kw">, </font><font class="str">"B"</font><font class="kw">, </font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>10<font class="kw">,</font>5<font class="kw">, </font><font class="str">"PAGE"</font><font class="kw">, </font>0<font class="kw">, </font>0<font class="kw">, </font><font class="str">"C"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1 <font class="kw">+ (</font>$r2<font class="kw">-</font>$r1<font class="kw">)/</font>2 <font class="kw">- </font>5<font class="kw">, </font>$y1 <font class="kw">+ </font>9 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Helvetica"</font><font class="kw">, </font><font class="str">""</font><font class="kw">, </font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>10<font class="kw">,</font>5<font class="kw">,</font>$page<font class="kw">, </font>0<font class="kw">,</font>0<font class="kw">, </font><font class="str">"C"</font><font class="kw">);<br>}<br><br></font><font class="cmt">// Client address<br></font><font class="kw">function </font>addClientAdresse<font class="kw">( </font>$adresse <font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>w <font class="kw">- </font>80<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>$r1 <font class="kw">+ </font>68<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>40<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1<font class="kw">, </font>$y1<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>MultiCell<font class="kw">( </font>60<font class="kw">, </font>4<font class="kw">, </font>$adresse<font class="kw">);<br>}<br><br></font><font class="cmt">// Mode of payment<br></font><font class="kw">function </font>addReglement<font class="kw">( </font>$mode <font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r1&nbsp;&nbsp;<font class="kw">= </font>10<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r2&nbsp;&nbsp;<font class="kw">= </font>$r1 <font class="kw">+ </font>60<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y1&nbsp;&nbsp;<font class="kw">= </font>80<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y2&nbsp;&nbsp;<font class="kw">= </font>$y1<font class="kw">+</font>10<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$mid <font class="kw">= </font>$y1 <font class="kw">+ ((</font>$y2<font class="kw">-</font>$y1<font class="kw">) / </font>2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>RoundedRect<font class="kw">(</font>$r1<font class="kw">, </font>$y1<font class="kw">, (</font>$r2 <font class="kw">- </font>$r1<font class="kw">), (</font>$y2<font class="kw">-</font>$y1<font class="kw">), </font>2.5<font class="kw">, </font><font class="str">'D'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">( </font>$r1<font class="kw">, </font>$mid<font class="kw">, </font>$r2<font class="kw">, </font>$mid<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1 <font class="kw">+ (</font>$r2<font class="kw">-</font>$r1<font class="kw">)/</font>2 <font class="kw">-</font>5 <font class="kw">, </font>$y1<font class="kw">+</font>1 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Helvetica"</font><font class="kw">, </font><font class="str">"B"</font><font class="kw">, </font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>10<font class="kw">,</font>4<font class="kw">, </font><font class="str">"MODE DE REGLEMENT"</font><font class="kw">, </font>0<font class="kw">, </font>0<font class="kw">, </font><font class="str">"C"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1 <font class="kw">+ (</font>$r2<font class="kw">-</font>$r1<font class="kw">)/</font>2 <font class="kw">-</font>5 <font class="kw">, </font>$y1 <font class="kw">+ </font>5 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Helvetica"</font><font class="kw">, </font><font class="str">""</font><font class="kw">, </font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>10<font class="kw">,</font>5<font class="kw">,</font>$mode<font class="kw">, </font>0<font class="kw">,</font>0<font class="kw">, </font><font class="str">"C"</font><font class="kw">);<br>}<br><br></font><font class="cmt">// Expiry date<br></font><font class="kw">function </font>addEcheance<font class="kw">( </font>$date <font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r1&nbsp;&nbsp;<font class="kw">= </font>80<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r2&nbsp;&nbsp;<font class="kw">= </font>$r1 <font class="kw">+ </font>40<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y1&nbsp;&nbsp;<font class="kw">= </font>80<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y2&nbsp;&nbsp;<font class="kw">= </font>$y1<font class="kw">+</font>10<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$mid <font class="kw">= </font>$y1 <font class="kw">+ ((</font>$y2<font class="kw">-</font>$y1<font class="kw">) / </font>2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>RoundedRect<font class="kw">(</font>$r1<font class="kw">, </font>$y1<font class="kw">, (</font>$r2 <font class="kw">- </font>$r1<font class="kw">), (</font>$y2<font class="kw">-</font>$y1<font class="kw">), </font>2.5<font class="kw">, </font><font class="str">'D'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">( </font>$r1<font class="kw">, </font>$mid<font class="kw">, </font>$r2<font class="kw">, </font>$mid<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1 <font class="kw">+ (</font>$r2 <font class="kw">- </font>$r1<font class="kw">)/</font>2 <font class="kw">- </font>5 <font class="kw">, </font>$y1<font class="kw">+</font>1 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Helvetica"</font><font class="kw">, </font><font class="str">"B"</font><font class="kw">, </font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>10<font class="kw">,</font>4<font class="kw">, </font><font class="str">"DATE D'ECHEANCE"</font><font class="kw">, </font>0<font class="kw">, </font>0<font class="kw">, </font><font class="str">"C"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1 <font class="kw">+ (</font>$r2<font class="kw">-</font>$r1<font class="kw">)/</font>2 <font class="kw">- </font>5 <font class="kw">, </font>$y1 <font class="kw">+ </font>5 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Helvetica"</font><font class="kw">, </font><font class="str">""</font><font class="kw">, </font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>10<font class="kw">,</font>5<font class="kw">,</font>$date<font class="kw">, </font>0<font class="kw">,</font>0<font class="kw">, </font><font class="str">"C"</font><font class="kw">);<br>}<br><br></font><font class="cmt">// VAT number<br></font><font class="kw">function </font>addNumTVA<font class="kw">(</font>$tva<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Helvetica"</font><font class="kw">, </font><font class="str">"B"</font><font class="kw">, </font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r1&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>w <font class="kw">- </font>80<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r2&nbsp;&nbsp;<font class="kw">= </font>$r1 <font class="kw">+ </font>70<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y1&nbsp;&nbsp;<font class="kw">= </font>80<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y2&nbsp;&nbsp;<font class="kw">= </font>$y1<font class="kw">+</font>10<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$mid <font class="kw">= </font>$y1 <font class="kw">+ ((</font>$y2<font class="kw">-</font>$y1<font class="kw">) / </font>2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>RoundedRect<font class="kw">(</font>$r1<font class="kw">, </font>$y1<font class="kw">, (</font>$r2 <font class="kw">- </font>$r1<font class="kw">), (</font>$y2<font class="kw">-</font>$y1<font class="kw">), </font>2.5<font class="kw">, </font><font class="str">'D'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">( </font>$r1<font class="kw">, </font>$mid<font class="kw">, </font>$r2<font class="kw">, </font>$mid<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1 <font class="kw">+ </font>16 <font class="kw">, </font>$y1<font class="kw">+</font>1 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>40<font class="kw">, </font>4<font class="kw">, </font><font class="str">"TVA Intracommunautaire"</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">"C"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Helvetica"</font><font class="kw">, </font><font class="str">""</font><font class="kw">, </font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1 <font class="kw">+ </font>16 <font class="kw">, </font>$y1<font class="kw">+</font>5 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>40<font class="kw">, </font>5<font class="kw">, </font>$tva<font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">"C"</font><font class="kw">);<br>}<br><br>function </font>addReference<font class="kw">(</font>$ref<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Helvetica"</font><font class="kw">, </font><font class="str">""</font><font class="kw">, </font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$length <font class="kw">= </font>$<font class="kw">this-&gt;</font>GetStringWidth<font class="kw">( </font><font class="str">"Références : " </font><font class="kw">. </font>$ref <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r1&nbsp;&nbsp;<font class="kw">= </font>10<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r2&nbsp;&nbsp;<font class="kw">= </font>$r1 <font class="kw">+ </font>$length<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y1&nbsp;&nbsp;<font class="kw">= </font>92<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y2&nbsp;&nbsp;<font class="kw">= </font>$y1<font class="kw">+</font>5<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1 <font class="kw">, </font>$y1 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$length<font class="kw">,</font>4<font class="kw">, </font><font class="str">"Références : " </font><font class="kw">. </font>$ref<font class="kw">);<br>}<br><br>function </font>addCols<font class="kw">( </font>$tab <font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;global </font>$colonnes<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r1&nbsp;&nbsp;<font class="kw">= </font>10<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r2&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>w <font class="kw">- (</font>$r1 <font class="kw">* </font>2<font class="kw">) ;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y1&nbsp;&nbsp;<font class="kw">= </font>100<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y2&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>h <font class="kw">- </font>50 <font class="kw">- </font>$y1<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1<font class="kw">, </font>$y1 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Rect<font class="kw">( </font>$r1<font class="kw">, </font>$y1<font class="kw">, </font>$r2<font class="kw">, </font>$y2<font class="kw">, </font><font class="str">"D"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">( </font>$r1<font class="kw">, </font>$y1<font class="kw">+</font>6<font class="kw">, </font>$r1<font class="kw">+</font>$r2<font class="kw">, </font>$y1<font class="kw">+</font>6<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$colX <font class="kw">= </font>$r1<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$colonnes <font class="kw">= </font>$tab<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;while ( list( </font>$lib<font class="kw">, </font>$pos <font class="kw">) = </font>each <font class="kw">(</font>$tab<font class="kw">) )<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$colX<font class="kw">, </font>$y1<font class="kw">+</font>2 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>$pos<font class="kw">, </font>1<font class="kw">, </font>$lib<font class="kw">, </font>0<font class="kw">, </font>0<font class="kw">, </font><font class="str">"C"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$colX <font class="kw">+= </font>$pos<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">( </font>$colX<font class="kw">, </font>$y1<font class="kw">, </font>$colX<font class="kw">, </font>$y1<font class="kw">+</font>$y2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br><br>function </font>addLineFormat<font class="kw">( </font>$tab <font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;global </font>$format<font class="kw">, </font>$colonnes<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;while ( list( </font>$lib<font class="kw">, </font>$pos <font class="kw">) = </font>each <font class="kw">(</font>$colonnes<font class="kw">) )<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( isset( </font>$tab<font class="kw">[</font><font class="str">"$lib"</font><font class="kw">] ) )<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$format<font class="kw">[ </font>$lib <font class="kw">] = </font>$tab<font class="kw">[</font><font class="str">"$lib"</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br><br>function </font>lineVert<font class="kw">( </font>$tab <font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;global </font>$colonnes<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>reset<font class="kw">( </font>$colonnes <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$maxSize<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;while ( list( </font>$lib<font class="kw">, </font>$pos <font class="kw">) = </font>each <font class="kw">(</font>$colonnes<font class="kw">) )<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$texte <font class="kw">= </font>$tab<font class="kw">[ </font>$lib <font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$longCell&nbsp;&nbsp;<font class="kw">= </font>$pos <font class="kw">-</font>2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$size <font class="kw">= </font>$<font class="kw">this-&gt;</font>sizeOfText<font class="kw">( </font>$texte<font class="kw">, </font>$longCell <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$size <font class="kw">&gt; </font>$maxSize<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$maxSize <font class="kw">= </font>$size<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;return </font>$maxSize<font class="kw">;<br>}<br><br></font><font class="cmt">// add a line to the invoice/estimate<br>/*&nbsp;&nbsp;&nbsp;&nbsp;$ligne = array( "REFERENCE"&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $prod["ref"],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"DESIGNATION"&nbsp;&nbsp;=&gt; $libelle,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"QUANTITE"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; sprintf( "%.2f", $prod["qte"]) ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"P.U. HT"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; sprintf( "%.2f", $prod["px_unit"]),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"MONTANT H.T." =&gt; sprintf ( "%.2f", $prod["qte"] * $prod["px_unit"]) ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"TVA"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $prod["tva"] );<br>*/<br></font><font class="kw">function </font>addLine<font class="kw">( </font>$ligne<font class="kw">, </font>$tab <font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;global </font>$colonnes<font class="kw">, </font>$format<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$ordonnee&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>10<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$maxSize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>$ligne<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>reset<font class="kw">( </font>$colonnes <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;while ( list( </font>$lib<font class="kw">, </font>$pos <font class="kw">) = </font>each <font class="kw">(</font>$colonnes<font class="kw">) )<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$longCell&nbsp;&nbsp;<font class="kw">= </font>$pos <font class="kw">-</font>2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$texte&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>$tab<font class="kw">[ </font>$lib <font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$length&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>GetStringWidth<font class="kw">( </font>$texte <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$tailleTexte <font class="kw">= </font>$<font class="kw">this-&gt;</font>sizeOfText<font class="kw">( </font>$texte<font class="kw">, </font>$length <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$formText&nbsp;&nbsp;<font class="kw">= </font>$format<font class="kw">[ </font>$lib <font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$ordonnee<font class="kw">, </font>$ligne<font class="kw">-</font>1<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>MultiCell<font class="kw">( </font>$longCell<font class="kw">, </font>4 <font class="kw">, </font>$texte<font class="kw">, </font>0<font class="kw">, </font>$formText<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( </font>$maxSize <font class="kw">&lt; (</font>$<font class="kw">this-&gt;</font>GetY<font class="kw">()&nbsp;&nbsp;) )<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$maxSize <font class="kw">= </font>$<font class="kw">this-&gt;</font>GetY<font class="kw">() ;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$ordonnee <font class="kw">+= </font>$pos<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;return ( </font>$maxSize <font class="kw">- </font>$ligne <font class="kw">);<br>}<br><br>function </font>addRemarque<font class="kw">(</font>$remarque<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Helvetica"</font><font class="kw">, </font><font class="str">""</font><font class="kw">, </font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$length <font class="kw">= </font>$<font class="kw">this-&gt;</font>GetStringWidth<font class="kw">( </font><font class="str">"Remarque : " </font><font class="kw">. </font>$remarque <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r1&nbsp;&nbsp;<font class="kw">= </font>10<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r2&nbsp;&nbsp;<font class="kw">= </font>$r1 <font class="kw">+ </font>$length<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y1&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>h <font class="kw">- </font>45.5<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y2&nbsp;&nbsp;<font class="kw">= </font>$y1<font class="kw">+</font>5<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1 <font class="kw">, </font>$y1 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$length<font class="kw">,</font>4<font class="kw">, </font><font class="str">"Remarque : " </font><font class="kw">. </font>$remarque<font class="kw">);<br>}<br><br>function </font>addCadreTVAs<font class="kw">()<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Arial"</font><font class="kw">, </font><font class="str">"B"</font><font class="kw">, </font>8<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r1&nbsp;&nbsp;<font class="kw">= </font>10<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r2&nbsp;&nbsp;<font class="kw">= </font>$r1 <font class="kw">+ </font>120<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y1&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>h <font class="kw">- </font>40<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y2&nbsp;&nbsp;<font class="kw">= </font>$y1<font class="kw">+</font>20<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>RoundedRect<font class="kw">(</font>$r1<font class="kw">, </font>$y1<font class="kw">, (</font>$r2 <font class="kw">- </font>$r1<font class="kw">), (</font>$y2<font class="kw">-</font>$y1<font class="kw">), </font>2.5<font class="kw">, </font><font class="str">'D'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">( </font>$r1<font class="kw">, </font>$y1<font class="kw">+</font>4<font class="kw">, </font>$r2<font class="kw">, </font>$y1<font class="kw">+</font>4<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">( </font>$r1<font class="kw">+</font>5<font class="kw">,&nbsp;&nbsp;</font>$y1<font class="kw">+</font>4<font class="kw">, </font>$r1<font class="kw">+</font>5<font class="kw">, </font>$y2<font class="kw">); </font><font class="cmt">// avant BASES HT<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">( </font>$r1<font class="kw">+</font>27<font class="kw">, </font>$y1<font class="kw">, </font>$r1<font class="kw">+</font>27<font class="kw">, </font>$y2<font class="kw">);&nbsp;&nbsp;</font><font class="cmt">// avant REMISE<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">( </font>$r1<font class="kw">+</font>43<font class="kw">, </font>$y1<font class="kw">, </font>$r1<font class="kw">+</font>43<font class="kw">, </font>$y2<font class="kw">);&nbsp;&nbsp;</font><font class="cmt">// avant MT TVA<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">( </font>$r1<font class="kw">+</font>63<font class="kw">, </font>$y1<font class="kw">, </font>$r1<font class="kw">+</font>63<font class="kw">, </font>$y2<font class="kw">);&nbsp;&nbsp;</font><font class="cmt">// avant % TVA<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">( </font>$r1<font class="kw">+</font>75<font class="kw">, </font>$y1<font class="kw">, </font>$r1<font class="kw">+</font>75<font class="kw">, </font>$y2<font class="kw">);&nbsp;&nbsp;</font><font class="cmt">// avant PORT<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">( </font>$r1<font class="kw">+</font>91<font class="kw">, </font>$y1<font class="kw">, </font>$r1<font class="kw">+</font>91<font class="kw">, </font>$y2<font class="kw">);&nbsp;&nbsp;</font><font class="cmt">// avant TOTAUX<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1<font class="kw">+</font>9<font class="kw">, </font>$y1<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>10<font class="kw">,</font>4<font class="kw">, </font><font class="str">"BASES HT"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetX<font class="kw">( </font>$r1<font class="kw">+</font>29 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>10<font class="kw">,</font>4<font class="kw">, </font><font class="str">"REMISE"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetX<font class="kw">( </font>$r1<font class="kw">+</font>48 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>10<font class="kw">,</font>4<font class="kw">, </font><font class="str">"MT TVA"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetX<font class="kw">( </font>$r1<font class="kw">+</font>63 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>10<font class="kw">,</font>4<font class="kw">, </font><font class="str">"% TVA"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetX<font class="kw">( </font>$r1<font class="kw">+</font>78 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>10<font class="kw">,</font>4<font class="kw">, </font><font class="str">"PORT"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetX<font class="kw">( </font>$r1<font class="kw">+</font>100 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>10<font class="kw">,</font>4<font class="kw">, </font><font class="str">"TOTAUX"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Arial"</font><font class="kw">, </font><font class="str">"B"</font><font class="kw">, </font>6<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1<font class="kw">+</font>93<font class="kw">, </font>$y2 <font class="kw">- </font>8 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>6<font class="kw">,</font>0<font class="kw">, </font><font class="str">"H.T.&nbsp;&nbsp;&nbsp;:"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1<font class="kw">+</font>93<font class="kw">, </font>$y2 <font class="kw">- </font>3 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>6<font class="kw">,</font>0<font class="kw">, </font><font class="str">"T.V.A. :"</font><font class="kw">);<br>}<br><br>function </font>addCadreEurosFrancs<font class="kw">()<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r1&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>w <font class="kw">- </font>70<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$r2&nbsp;&nbsp;<font class="kw">= </font>$r1 <font class="kw">+ </font>60<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y1&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>h <font class="kw">- </font>40<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y2&nbsp;&nbsp;<font class="kw">= </font>$y1<font class="kw">+</font>20<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>RoundedRect<font class="kw">(</font>$r1<font class="kw">, </font>$y1<font class="kw">, (</font>$r2 <font class="kw">- </font>$r1<font class="kw">), (</font>$y2<font class="kw">-</font>$y1<font class="kw">), </font>2.5<font class="kw">, </font><font class="str">'D'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">( </font>$r1<font class="kw">+</font>20<font class="kw">,&nbsp;&nbsp;</font>$y1<font class="kw">, </font>$r1<font class="kw">+</font>20<font class="kw">, </font>$y2<font class="kw">); </font><font class="cmt">// avant EUROS<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">( </font>$r1<font class="kw">+</font>20<font class="kw">, </font>$y1<font class="kw">+</font>4<font class="kw">, </font>$r2<font class="kw">, </font>$y1<font class="kw">+</font>4<font class="kw">); </font><font class="cmt">// Sous Euros &amp; Francs<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">( </font>$r1<font class="kw">+</font>38<font class="kw">,&nbsp;&nbsp;</font>$y1<font class="kw">, </font>$r1<font class="kw">+</font>38<font class="kw">, </font>$y2<font class="kw">); </font><font class="cmt">// Entre Euros &amp; Francs<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Arial"</font><font class="kw">, </font><font class="str">"B"</font><font class="kw">, </font>8<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1<font class="kw">+</font>22<font class="kw">, </font>$y1 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>15<font class="kw">,</font>4<font class="kw">, </font><font class="str">"EUROS"</font><font class="kw">, </font>0<font class="kw">, </font>0<font class="kw">, </font><font class="str">"C"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Arial"</font><font class="kw">, </font><font class="str">""</font><font class="kw">, </font>8<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1<font class="kw">+</font>42<font class="kw">, </font>$y1 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>15<font class="kw">,</font>4<font class="kw">, </font><font class="str">"FRANCS"</font><font class="kw">, </font>0<font class="kw">, </font>0<font class="kw">, </font><font class="str">"C"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Arial"</font><font class="kw">, </font><font class="str">"B"</font><font class="kw">, </font>6<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1<font class="kw">, </font>$y1<font class="kw">+</font>5 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>20<font class="kw">,</font>4<font class="kw">, </font><font class="str">"TOTAL TTC"</font><font class="kw">, </font>0<font class="kw">, </font>0<font class="kw">, </font><font class="str">"C"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1<font class="kw">, </font>$y1<font class="kw">+</font>10 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>20<font class="kw">,</font>4<font class="kw">, </font><font class="str">"ACOMPTE"</font><font class="kw">, </font>0<font class="kw">, </font>0<font class="kw">, </font><font class="str">"C"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$r1<font class="kw">, </font>$y1<font class="kw">+</font>15 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>20<font class="kw">,</font>4<font class="kw">, </font><font class="str">"NET A PAYER"</font><font class="kw">, </font>0<font class="kw">, </font>0<font class="kw">, </font><font class="str">"C"</font><font class="kw">);<br>}<br><br></font><font class="cmt">// remplit les cadres TVA / Totaux et la remarque<br>// params&nbsp;&nbsp;= array( "RemiseGlobale" =&gt; [0|1],<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"remise_tva"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; [1|2...],&nbsp;&nbsp;// {la remise s'applique sur ce code TVA}<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"remise"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; value,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// {montant de la remise}<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"remise_percent" =&gt; percent,&nbsp;&nbsp;&nbsp;// {pourcentage de remise sur ce montant de TVA}<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"FraisPort"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; [0|1],<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"portTTC"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; value,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// montant des frais de ports TTC<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// par defaut la TVA = 19.6 %<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"portHT"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; value,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// montant des frais de ports HT<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"portTVA"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; tva_value, // valeur de la TVA a appliquer sur le montant HT<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"AccompteExige" =&gt; [0|1],<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"accompte"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; value&nbsp;&nbsp;&nbsp;&nbsp;// montant de l'acompte (TTC)<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"accompte_percent" =&gt; percent&nbsp;&nbsp;// pourcentage d'acompte (TTC)<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Remarque" =&gt; "texte"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// texte<br>// tab_tva = array( "1"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 19.6,<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"2"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 5.5, ... );<br>// invoice = array( "px_unit" =&gt; value,<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"qte"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; qte,<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"tva"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; code_tva );<br></font><font class="kw">function </font>addTVAs<font class="kw">( </font>$params<font class="kw">, </font>$tab_tva<font class="kw">, </font>$invoice <font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>8<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>reset <font class="kw">(</font>$invoice<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$px <font class="kw">= array();<br>&nbsp;&nbsp;&nbsp;&nbsp;while ( list( </font>$k<font class="kw">, </font>$prod<font class="kw">) = </font>each<font class="kw">( </font>$invoice <font class="kw">) )<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$tva <font class="kw">= </font>$prod<font class="kw">[</font><font class="str">"tva"</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ </font>$px<font class="kw">[</font>$tva<font class="kw">] += </font>$prod<font class="kw">[</font><font class="str">"qte"</font><font class="kw">] * </font>$prod<font class="kw">[</font><font class="str">"px_unit"</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$prix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= array();<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$totalHT&nbsp;&nbsp;<font class="kw">= </font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$totalTTC <font class="kw">= </font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$totalTVA <font class="kw">= </font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y <font class="kw">= </font>261<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>reset <font class="kw">(</font>$px<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>natsort<font class="kw">( </font>$px <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;while ( list(</font>$code_tva<font class="kw">, </font>$articleHT<font class="kw">) = </font>each<font class="kw">( </font>$px <font class="kw">) )<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$tva <font class="kw">= </font>$tab_tva<font class="kw">[</font>$code_tva<font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>17<font class="kw">, </font>$y<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>19<font class="kw">,</font>4<font class="kw">, </font>sprintf<font class="kw">(</font><font class="str">"%0.2f"</font><font class="kw">, </font>$articleHT<font class="kw">),</font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">,</font><font class="str">'R' </font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( </font>$params<font class="kw">[</font><font class="str">"RemiseGlobale"</font><font class="kw">]==</font>1 <font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( </font>$params<font class="kw">[</font><font class="str">"remise_tva"</font><font class="kw">] == </font>$code_tva <font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>37.5<font class="kw">, </font>$y <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$params<font class="kw">[</font><font class="str">"remise"</font><font class="kw">] &gt; </font>0 <font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( </font>is_int<font class="kw">( </font>$params<font class="kw">[</font><font class="str">"remise"</font><font class="kw">] ) )<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$l_remise <font class="kw">= </font>$param<font class="kw">[</font><font class="str">"remise"</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$l_remise <font class="kw">= </font>sprintf <font class="kw">(</font><font class="str">"%.02f"</font><font class="kw">, </font>$params<font class="kw">[</font><font class="str">"remise"</font><font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>14.5<font class="kw">,</font>4<font class="kw">, </font>$l_remise<font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">'R' </font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$articleHT <font class="kw">-= </font>$params<font class="kw">[</font><font class="str">"remise"</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if ( </font>$params<font class="kw">[</font><font class="str">"remise_percent"</font><font class="kw">] &gt; </font>0 <font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$rp <font class="kw">= </font>$params<font class="kw">[</font><font class="str">"remise_percent"</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( </font>$rp <font class="kw">&gt; </font>1 <font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$rp <font class="kw">/= </font>100<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$rabais <font class="kw">= </font>$articleHT <font class="kw">* </font>$rp<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$articleHT <font class="kw">-= </font>$rabais<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( </font>is_int<font class="kw">(</font>$rabais<font class="kw">) )<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$l_remise <font class="kw">= </font>$rabais<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$l_remise <font class="kw">= </font>sprintf <font class="kw">(</font><font class="str">"%.02f"</font><font class="kw">, </font>$rabais<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>14.5<font class="kw">,</font>4<font class="kw">, </font>$l_remise<font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">'R' </font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>14.5<font class="kw">,</font>4<font class="kw">, </font><font class="str">"ErrorRem"</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">'R' </font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$totalHT <font class="kw">+= </font>$articleHT<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$totalTTC <font class="kw">+= </font>$articleHT <font class="kw">* ( </font>1 <font class="kw">+ </font>$tva<font class="kw">/</font>100 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$tmp_tva <font class="kw">= </font>$articleHT <font class="kw">* </font>$tva<font class="kw">/</font>100<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$a_tva<font class="kw">[ </font>$code_tva <font class="kw">] = </font>$tmp_tva<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$totalTVA <font class="kw">+= </font>$tmp_tva<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>11<font class="kw">, </font>$y<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>5<font class="kw">,</font>4<font class="kw">, </font>$code_tva<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>53<font class="kw">, </font>$y<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>19<font class="kw">,</font>4<font class="kw">, </font>sprintf<font class="kw">(</font><font class="str">"%0.2f"</font><font class="kw">,</font>$tmp_tva<font class="kw">),</font><font class="str">''</font><font class="kw">, </font><font class="str">'' </font><font class="kw">,</font><font class="str">'R'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>74<font class="kw">, </font>$y<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>10<font class="kw">,</font>4<font class="kw">, </font>sprintf<font class="kw">(</font><font class="str">"%0.2f"</font><font class="kw">,</font>$tva<font class="kw">) ,</font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">'R'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$y<font class="kw">+=</font>4<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;if ( </font>$params<font class="kw">[</font><font class="str">"FraisPort"</font><font class="kw">] == </font>1 <font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( </font>$params<font class="kw">[</font><font class="str">"portTTC"</font><font class="kw">] &gt; </font>0 <font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$pTTC <font class="kw">= </font>sprintf<font class="kw">(</font><font class="str">"%0.2f"</font><font class="kw">, </font>$params<font class="kw">[</font><font class="str">"portTTC"</font><font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$pHT&nbsp;&nbsp;<font class="kw">= </font>sprintf<font class="kw">(</font><font class="str">"%0.2f"</font><font class="kw">, </font>$pTTC <font class="kw">/ </font>1.196<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$pTVA <font class="kw">= </font>sprintf<font class="kw">(</font><font class="str">"%0.2f"</font><font class="kw">, </font>$pHT <font class="kw">* </font>0.196<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>6<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>85<font class="kw">, </font>261 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>6 <font class="kw">,</font>4<font class="kw">, </font><font class="str">"HT : "</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>92<font class="kw">, </font>261 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>9 <font class="kw">,</font>4<font class="kw">, </font>$pHT<font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">'R'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>85<font class="kw">, </font>265 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>6 <font class="kw">,</font>4<font class="kw">, </font><font class="str">"TVA : "</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>92<font class="kw">, </font>265 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>9 <font class="kw">,</font>4<font class="kw">, </font>$pTVA<font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">'R'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>85<font class="kw">, </font>269 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>6 <font class="kw">,</font>4<font class="kw">, </font><font class="str">"TTC : "</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>92<font class="kw">, </font>269 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>9 <font class="kw">,</font>4<font class="kw">, </font>$pTTC<font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">'R'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>8<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$totalHT <font class="kw">+= </font>$pHT<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$totalTVA <font class="kw">+= </font>$pTVA<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$totalTTC <font class="kw">+= </font>$pTTC<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if ( </font>$params<font class="kw">[</font><font class="str">"portHT"</font><font class="kw">] &gt; </font>0 <font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$pHT&nbsp;&nbsp;<font class="kw">= </font>sprintf<font class="kw">(</font><font class="str">"%0.2f"</font><font class="kw">, </font>$params<font class="kw">[</font><font class="str">"portHT"</font><font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$pTVA <font class="kw">= </font>sprintf<font class="kw">(</font><font class="str">"%0.2f"</font><font class="kw">, </font>$params<font class="kw">[</font><font class="str">"portTVA"</font><font class="kw">] * </font>$pHT <font class="kw">/ </font>100 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$pTTC <font class="kw">= </font>sprintf<font class="kw">(</font><font class="str">"%0.2f"</font><font class="kw">, </font>$pHT <font class="kw">+ </font>$pTVA<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>6<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>85<font class="kw">, </font>261 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>6 <font class="kw">,</font>4<font class="kw">, </font><font class="str">"HT : "</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>92<font class="kw">, </font>261 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>9 <font class="kw">,</font>4<font class="kw">, </font>$pHT<font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">'R'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>85<font class="kw">, </font>265 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>6 <font class="kw">,</font>4<font class="kw">, </font><font class="str">"TVA : "</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>92<font class="kw">, </font>265 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>9 <font class="kw">,</font>4<font class="kw">, </font>$pTVA<font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">'R'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>85<font class="kw">, </font>269 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>6 <font class="kw">,</font>4<font class="kw">, </font><font class="str">"TTC : "</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>92<font class="kw">, </font>269 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>9 <font class="kw">,</font>4<font class="kw">, </font>$pTTC<font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">'R'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>8<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$totalHT <font class="kw">+= </font>$pHT<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$totalTVA <font class="kw">+= </font>$pTVA<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$totalTTC <font class="kw">+= </font>$pTTC<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>114<font class="kw">,</font>266.4<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>15<font class="kw">,</font>4<font class="kw">, </font>sprintf<font class="kw">(</font><font class="str">"%0.2f"</font><font class="kw">, </font>$totalHT<font class="kw">), </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">'R' </font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>114<font class="kw">,</font>271.4<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>15<font class="kw">,</font>4<font class="kw">, </font>sprintf<font class="kw">(</font><font class="str">"%0.2f"</font><font class="kw">, </font>$totalTVA<font class="kw">), </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">'R' </font><font class="kw">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$params<font class="kw">[</font><font class="str">"totalHT"</font><font class="kw">] = </font>$totalHT<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$params<font class="kw">[</font><font class="str">"TVA"</font><font class="kw">] = </font>$totalTVA<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$accompteTTC<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;if ( </font>$params<font class="kw">[</font><font class="str">"AccompteExige"</font><font class="kw">] == </font>1 <font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( </font>$params<font class="kw">[</font><font class="str">"accompte"</font><font class="kw">] &gt; </font>0 <font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$accompteTTC<font class="kw">=</font>sprintf <font class="kw">(</font><font class="str">"%.2f"</font><font class="kw">, </font>$params<font class="kw">[</font><font class="str">"accompte"</font><font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( </font>strlen <font class="kw">(</font>$params<font class="kw">[</font><font class="str">"Remarque"</font><font class="kw">]) == </font>0 <font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>addRemarque<font class="kw">( </font><font class="str">"Accompte de $accompteTTC Euros exigé à la commande."</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>addRemarque<font class="kw">( </font>$params<font class="kw">[</font><font class="str">"Remarque"</font><font class="kw">] );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if ( </font>$params<font class="kw">[</font><font class="str">"accompte_percent"</font><font class="kw">] &gt; </font>0 <font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$percent <font class="kw">= </font>$params<font class="kw">[</font><font class="str">"accompte_percent"</font><font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( </font>$percent <font class="kw">&gt; </font>1 <font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$percent <font class="kw">/= </font>100<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$accompteTTC<font class="kw">=</font>sprintf<font class="kw">(</font><font class="str">"%.2f"</font><font class="kw">, </font>$totalTTC <font class="kw">* </font>$percent<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$percent100 <font class="kw">= </font>$percent <font class="kw">* </font>100<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( </font>strlen <font class="kw">(</font>$params<font class="kw">[</font><font class="str">"Remarque"</font><font class="kw">]) == </font>0 <font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>addRemarque<font class="kw">( </font><font class="str">"Accompte de $percent100 % (soit $accompteTTC Euros) exigé à la commande." </font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>addRemarque<font class="kw">( </font>$params<font class="kw">[</font><font class="str">"Remarque"</font><font class="kw">] );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>addRemarque<font class="kw">( </font><font class="str">"Drôle d'acompte !!! " </font><font class="kw">. </font>$params<font class="kw">[</font><font class="str">"Remarque"</font><font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( </font>strlen <font class="kw">(</font>$params<font class="kw">[</font><font class="str">"Remarque"</font><font class="kw">]) &gt; </font>0 <font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>addRemarque<font class="kw">( </font>$params<font class="kw">[</font><font class="str">"Remarque"</font><font class="kw">] );<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$re&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>w <font class="kw">- </font>50<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$rf&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>w <font class="kw">- </font>29<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$y1&nbsp;&nbsp;<font class="kw">= </font>$<font class="kw">this-&gt;</font>h <font class="kw">- </font>40<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">( </font><font class="str">"Arial"</font><font class="kw">, </font><font class="str">""</font><font class="kw">, </font>8<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$re<font class="kw">, </font>$y1<font class="kw">+</font>5 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>17<font class="kw">,</font>4<font class="kw">, </font>sprintf<font class="kw">(</font><font class="str">"%0.2f"</font><font class="kw">, </font>$totalTTC<font class="kw">), </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">'R'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$re<font class="kw">, </font>$y1<font class="kw">+</font>10 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>17<font class="kw">,</font>4<font class="kw">, </font>sprintf<font class="kw">(</font><font class="str">"%0.2f"</font><font class="kw">, </font>$accompteTTC<font class="kw">), </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">'R'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$re<font class="kw">, </font>$y1<font class="kw">+</font>14.8 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>17<font class="kw">,</font>4<font class="kw">, </font>sprintf<font class="kw">(</font><font class="str">"%0.2f"</font><font class="kw">, </font>$totalTTC <font class="kw">- </font>$accompteTTC<font class="kw">), </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">'R'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$rf<font class="kw">, </font>$y1<font class="kw">+</font>5 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>17<font class="kw">,</font>4<font class="kw">, </font>sprintf<font class="kw">( </font><font class="str">"%0.2f"</font><font class="kw">, </font>$totalTTC <font class="kw">* </font>EURO_VAL<font class="kw">), </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">'R'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$rf<font class="kw">, </font>$y1<font class="kw">+</font>10 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>17<font class="kw">,</font>4<font class="kw">, </font>sprintf<font class="kw">(</font><font class="str">"%0.2f"</font><font class="kw">, </font>$accompteTTC <font class="kw">* </font>EURO_VAL<font class="kw">), </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">'R'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">( </font>$rf<font class="kw">, </font>$y1<font class="kw">+</font>14.8 <font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">( </font>17<font class="kw">,</font>4<font class="kw">, </font>sprintf<font class="kw">(</font><font class="str">"%0.2f"</font><font class="kw">, (</font>$totalTTC <font class="kw">- </font>$accompteTTC<font class="kw">) * </font>EURO_VAL<font class="kw">), </font><font class="str">''</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font><font class="str">'R'</font><font class="kw">);<br>}<br><br></font><font class="cmt">// add a watermark (temporary estimate, DUPLICATA...)<br>// call this method first<br></font><font class="kw">function </font>temporaire<font class="kw">( </font>$texte <font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">'B'</font><font class="kw">,</font>50<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetTextColor<font class="kw">(</font>203<font class="kw">,</font>203<font class="kw">,</font>203<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Rotate<font class="kw">(</font>45<font class="kw">,</font>55<font class="kw">,</font>190<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Text<font class="kw">(</font>55<font class="kw">,</font>190<font class="kw">,</font>$texte<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Rotate<font class="kw">(</font>0<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetTextColor<font class="kw">(</font>0<font class="kw">,</font>0<font class="kw">,</font>0<font class="kw">);<br>}<br><br>}<br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>

<H4 CLASS="st">Example</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br><font class="cmt">// (c) Xavier Nicolay<br>// Exemple de génération de devis/facture PDF<br><br></font>define<font class="kw">(</font><font class="str">'FPDF_FONTPATH'</font><font class="kw">,</font><font class="str">'font/'</font><font class="kw">);<br>require(</font><font class="str">'invoice.php'</font><font class="kw">);<br><br></font>$pdf <font class="kw">= new </font>INVOICE<font class="kw">( </font><font class="str">'P'</font><font class="kw">, </font><font class="str">'mm'</font><font class="kw">, </font><font class="str">'A4' </font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Open<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>AddPage<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>addSociete<font class="kw">( </font><font class="str">"MaSociete"</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"MonAdresse\n" </font><font class="kw">.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"75000 PARIS\n"</font><font class="kw">.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"R.C.S. PARIS B 000 000 007\n" </font><font class="kw">.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"Capital : 18000 " </font><font class="kw">. </font>EURO <font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>fact_dev<font class="kw">( </font><font class="str">"Devis "</font><font class="kw">, </font><font class="str">"TEMPO" </font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>temporaire<font class="kw">( </font><font class="str">"Devis temporaire" </font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>addDate<font class="kw">( </font><font class="str">"03/12/2003"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>addClient<font class="kw">(</font><font class="str">"CL01"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>addPageNumber<font class="kw">(</font><font class="str">"1"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>addClientAdresse<font class="kw">(</font><font class="str">"Ste\nM. XXXX\n3ème étage\n33, rue d'ailleurs\n75000 PARIS"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>addReglement<font class="kw">(</font><font class="str">"Chèque à réception de facture"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>addEcheance<font class="kw">(</font><font class="str">"03/12/2003"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>addNumTVA<font class="kw">(</font><font class="str">"FR888777666"</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>addReference<font class="kw">(</font><font class="str">"Devis ... du ...."</font><font class="kw">);<br></font>$cols<font class="kw">=array( </font><font class="str">"REFERENCE"&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font>23<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"DESIGNATION"&nbsp;&nbsp;</font><font class="kw">=&gt; </font>78<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"QUANTITE"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font>22<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"P.U. HT"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font>26<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"MONTANT H.T." </font><font class="kw">=&gt; </font>30<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"TVA"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font>11 <font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>addCols<font class="kw">( </font>$cols<font class="kw">);<br></font>$cols<font class="kw">=array( </font><font class="str">"REFERENCE"&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font><font class="str">"L"</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"DESIGNATION"&nbsp;&nbsp;</font><font class="kw">=&gt; </font><font class="str">"L"</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"QUANTITE"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font><font class="str">"C"</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"P.U. HT"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font><font class="str">"R"</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"MONTANT H.T." </font><font class="kw">=&gt; </font><font class="str">"R"</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"TVA"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font><font class="str">"C" </font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>addLineFormat<font class="kw">( </font>$cols<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>addLineFormat<font class="kw">(</font>$cols<font class="kw">);<br><br></font>$y&nbsp;&nbsp;&nbsp;&nbsp;<font class="kw">= </font>109<font class="kw">;<br></font>$line <font class="kw">= array( </font><font class="str">"REFERENCE"&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font><font class="str">"REF1"</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"DESIGNATION"&nbsp;&nbsp;</font><font class="kw">=&gt; </font><font class="str">"Carte Mère MSI 6378\n" </font><font class="kw">.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"Processeur AMD 1Ghz\n" </font><font class="kw">.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"128Mo SDRAM, 30 Go Disque, CD-ROM, Floppy, Carte vidéo"</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"QUANTITE"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font><font class="str">"1"</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"P.U. HT"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font><font class="str">"600.00"</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"MONTANT H.T." </font><font class="kw">=&gt; </font><font class="str">"600.00"</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"TVA"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font><font class="str">"1" </font><font class="kw">);<br></font>$size <font class="kw">= </font>$pdf<font class="kw">-&gt;</font>addLine<font class="kw">( </font>$y<font class="kw">, </font>$line <font class="kw">);<br></font>$y&nbsp;&nbsp;&nbsp;<font class="kw">+= </font>$size <font class="kw">+ </font>2<font class="kw">;<br><br></font>$line <font class="kw">= array( </font><font class="str">"REFERENCE"&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font><font class="str">"REF2"</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"DESIGNATION"&nbsp;&nbsp;</font><font class="kw">=&gt; </font><font class="str">"Câble RS232"</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"QUANTITE"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font><font class="str">"1"</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"P.U. HT"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font><font class="str">"10.00"</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"MONTANT H.T." </font><font class="kw">=&gt; </font><font class="str">"60.00"</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"TVA"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font><font class="str">"1" </font><font class="kw">);<br></font>$size <font class="kw">= </font>$pdf<font class="kw">-&gt;</font>addLine<font class="kw">( </font>$y<font class="kw">, </font>$line <font class="kw">);<br></font>$y&nbsp;&nbsp;&nbsp;<font class="kw">+= </font>$size <font class="kw">+ </font>2<font class="kw">;<br><br></font>$pdf<font class="kw">-&gt;</font>addCadreTVAs<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font class="cmt">// invoice = array( "px_unit" =&gt; value,<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"qte"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; qte,<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"tva"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; code_tva );<br>// tab_tva = array( "1"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 19.6,<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"2"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 5.5, ... );<br>// params&nbsp;&nbsp;= array( "RemiseGlobale" =&gt; [0|1],<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"remise_tva"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; [1|2...],&nbsp;&nbsp;// {la remise s'applique sur ce code TVA}<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"remise"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; value,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// {montant de la remise}<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"remise_percent" =&gt; percent,&nbsp;&nbsp;&nbsp;// {pourcentage de remise sur ce montant de TVA}<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"FraisPort"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; [0|1],<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"portTTC"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; value,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// montant des frais de ports TTC<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// par defaut la TVA = 19.6 %<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"portHT"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; value,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// montant des frais de ports HT<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"portTVA"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; tva_value, // valeur de la TVA a appliquer sur le montant HT<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"AccompteExige" =&gt; [0|1],<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"accompte"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; value&nbsp;&nbsp;&nbsp;&nbsp;// montant de l'acompte (TTC)<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"accompte_percent" =&gt; percent&nbsp;&nbsp;// pourcentage d'acompte (TTC)<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Remarque" =&gt; "texte"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// texte<br></font>$tot_prods <font class="kw">= array( array ( </font><font class="str">"px_unit" </font><font class="kw">=&gt; </font>600<font class="kw">, </font><font class="str">"qte" </font><font class="kw">=&gt; </font>1<font class="kw">, </font><font class="str">"tva" </font><font class="kw">=&gt; </font>1 <font class="kw">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array ( </font><font class="str">"px_unit" </font><font class="kw">=&gt;&nbsp;&nbsp;</font>10<font class="kw">, </font><font class="str">"qte" </font><font class="kw">=&gt; </font>1<font class="kw">, </font><font class="str">"tva" </font><font class="kw">=&gt; </font>1 <font class="kw">));<br></font>$tab_tva <font class="kw">= array( </font><font class="str">"1"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font>19.6<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"2"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font>5.5<font class="kw">);<br></font>$params&nbsp;&nbsp;<font class="kw">= array( </font><font class="str">"RemiseGlobale" </font><font class="kw">=&gt; </font>1<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"remise_tva"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font>1<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// {la remise s'applique sur ce code TVA}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"remise"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font>0<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// {montant de la remise}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"remise_percent" </font><font class="kw">=&gt; </font>10<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// {pourcentage de remise sur ce montant de TVA}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"FraisPort"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font>1<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"portTTC"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font>10<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// montant des frais de ports TTC<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// par defaut la TVA = 19.6 %<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"portHT"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font>0<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// montant des frais de ports HT<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"portTVA"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font>19.6<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// valeur de la TVA a appliquer sur le montant HT<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"AccompteExige" </font><font class="kw">=&gt; </font>1<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"accompte"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">=&gt; </font>0<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// montant de l'acompte (TTC)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"accompte_percent" </font><font class="kw">=&gt; </font>15<font class="kw">,&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">// pourcentage d'acompte (TTC)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="str">"Remarque" </font><font class="kw">=&gt; </font><font class="str">"Avec un acompte, svp..." </font><font class="kw">);<br><br></font>$pdf<font class="kw">-&gt;</font>addTVAs<font class="kw">( </font>$params<font class="kw">, </font>$tab_tva<font class="kw">, </font>$tot_prods<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>addCadreEurosFrancs<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>Output<font class="kw">();<br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>
<BR>
View the result <A HREF="ex20.pdf" TARGET="_blank">here</A>.
<H4 CLASS="st">Download</H4><A HREF="script20.zip">ZIP</A> | <A HREF="script20.tgz">TGZ</A>
</BODY>
</HTML>

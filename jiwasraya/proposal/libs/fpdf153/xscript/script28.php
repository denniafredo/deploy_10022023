<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<TITLE>Diagrams</TITLE>
<LINK TYPE="text/css" REL="stylesheet" HREF="../fpdf.css">
</HEAD>
<BODY ONLOAD="if(window.focus) window.focus()">
<H2>Diagrams</H2>
<H4 CLASS="st">Informations</H4>Author: <A HREF="&#109;ailto:pmarletta&#64;netcourrier.com?subject=Diagrams">Pierre Marletta</A><BR>License: Freeware
<H4 CLASS="st">Description</H4>This script allows to generate pie charts and bar diagrams. It requires the script
<A HREF="http://www.fpdf.org/?go=script&id=19" TARGET="_blank">Sector</A>.<BR>
<BR>
<TT>PieChart(<B>float</B> w, <B>float</B> h, <B>array</B> data, <B>string</B> format [, <B>array</B> colors])</TT><BR>
<BR>
<TT><U>w</U></TT>: maximum width of the diagram.<BR>
<TT><U>h</U></TT>: maximum height of the diagram.<BR>
<TT><U>data</U></TT>: associative array containing the labels and the corresponding data.<BR>
<TT><U>format</U></TT>: format used to display the legends. It is a string which can contain
the following special values: %l (label), %v (value) and %p (percentage).<BR>
<TT><U>colors</U></TT>: array containing the colors. If not given, a grayscale will be used.<BR>
<BR>
<TT>BarDiag(<B>float</B> w, <B>float</B> h, <B>array</B> data, <B>string</B> format [, <B>array</B> couleur [, <B>int</B> maxVal [, <B>int</B> nbDiv]]])</TT><BR>
<BR>
<TT><U>w</U></TT>: width of the diagram.<BR>
<TT><U>h</U></TT>: height of the diagram.<BR>
<TT><U>data</U></TT>: associative array containing the labels and the corresponding data.<BR>
<TT><U>format</U></TT>: format used to display the legends. It is a string which can contain
the following special values: %l (label), %v (value) and %p (percentage).<BR>
<TT><U>color</U></TT>: color of the bars. If not given, gray will be used.<BR>
<TT><U>maxVal</U></TT>: high value of the scale. Defaults to the maximum value of the data.<BR>
<TT><U>nbDiv</U></TT>: number of subdivisions of the scale (4 by default).<BR>
<H4 CLASS="st">Source</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br><font class="kw">require(</font><font class="str">'sector.php'</font><font class="kw">);<br><br>class </font>PDF_Diag <font class="kw">extends </font>PDF_Sector <font class="kw">{<br>&nbsp;&nbsp;&nbsp;&nbsp;var </font>$legends<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;var </font>$wLegend<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;var </font>$sum<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;var </font>$NbVal<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;function </font>PieChart<font class="kw">(</font>$w<font class="kw">, </font>$h<font class="kw">, </font>$data<font class="kw">, </font>$format<font class="kw">, </font>$colors<font class="kw">=</font>null<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Courier'</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetLegends<font class="kw">(</font>$data<font class="kw">,</font>$format<font class="kw">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$XPage <font class="kw">= </font>$<font class="kw">this-&gt;</font>GetX<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$YPage <font class="kw">= </font>$<font class="kw">this-&gt;</font>GetY<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$margin <font class="kw">= </font>2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$hLegend <font class="kw">= </font>5<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$radius <font class="kw">= </font>min<font class="kw">(</font>$w <font class="kw">- </font>$margin <font class="kw">* </font>4 <font class="kw">- </font>$hLegend <font class="kw">- </font>$<font class="kw">this-&gt;</font>wLegend<font class="kw">, </font>$h <font class="kw">- </font>$margin <font class="kw">* </font>2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$radius <font class="kw">= </font>floor<font class="kw">(</font>$radius <font class="kw">/ </font>2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$XDiag <font class="kw">= </font>$XPage <font class="kw">+ </font>$margin <font class="kw">+ </font>$radius<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$YDiag <font class="kw">= </font>$YPage <font class="kw">+ </font>$margin <font class="kw">+ </font>$radius<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$colors <font class="kw">== </font>null<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(</font>$i <font class="kw">= </font>0<font class="kw">;</font>$i <font class="kw">&lt; </font>$<font class="kw">this-&gt;</font>NbVal<font class="kw">; </font>$i<font class="kw">++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$gray <font class="kw">= </font>$i <font class="kw">* </font>intval<font class="kw">(</font>255 <font class="kw">/ </font>$<font class="kw">this-&gt;</font>NbVal<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$colors<font class="kw">[</font>$i<font class="kw">] = array(</font>$gray<font class="kw">,</font>$gray<font class="kw">,</font>$gray<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Sectors<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetLineWidth<font class="kw">(</font>0.2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$angleStart <font class="kw">= </font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$angleEnd <font class="kw">= </font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$i <font class="kw">= </font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach(</font>$data <font class="kw">as </font>$val<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$angle <font class="kw">= </font>floor<font class="kw">((</font>$val <font class="kw">* </font>360<font class="kw">) / </font>doubleval<font class="kw">(</font>$<font class="kw">this-&gt;</font>sum<font class="kw">));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$angle <font class="kw">!= </font>0<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$angleEnd <font class="kw">= </font>$angleStart <font class="kw">+ </font>$angle<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFillColor<font class="kw">(</font>$colors<font class="kw">[</font>$i<font class="kw">][</font>0<font class="kw">],</font>$colors<font class="kw">[</font>$i<font class="kw">][</font>1<font class="kw">],</font>$colors<font class="kw">[</font>$i<font class="kw">][</font>2<font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Sector<font class="kw">(</font>$XDiag<font class="kw">, </font>$YDiag<font class="kw">, </font>$radius<font class="kw">, </font>$angleStart<font class="kw">, </font>$angleEnd<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$angleStart <font class="kw">+= </font>$angle<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$i<font class="kw">++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$angleEnd <font class="kw">!= </font>360<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Sector<font class="kw">(</font>$XDiag<font class="kw">, </font>$YDiag<font class="kw">, </font>$radius<font class="kw">, </font>$angleStart <font class="kw">- </font>$angle<font class="kw">, </font>360<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Legends<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Courier'</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$x1 <font class="kw">= </font>$XPage <font class="kw">+ </font>2 <font class="kw">* </font>$radius <font class="kw">+ </font>4 <font class="kw">* </font>$margin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$x2 <font class="kw">= </font>$x1 <font class="kw">+ </font>$hLegend <font class="kw">+ </font>$margin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$y1 <font class="kw">= </font>$YDiag <font class="kw">- </font>$radius <font class="kw">+ (</font>2 <font class="kw">* </font>$radius <font class="kw">- </font>$<font class="kw">this-&gt;</font>NbVal<font class="kw">*(</font>$hLegend <font class="kw">+ </font>$margin<font class="kw">)) / </font>2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(</font>$i<font class="kw">=</font>0<font class="kw">; </font>$i<font class="kw">&lt;</font>$<font class="kw">this-&gt;</font>NbVal<font class="kw">; </font>$i<font class="kw">++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFillColor<font class="kw">(</font>$colors<font class="kw">[</font>$i<font class="kw">][</font>0<font class="kw">],</font>$colors<font class="kw">[</font>$i<font class="kw">][</font>1<font class="kw">],</font>$colors<font class="kw">[</font>$i<font class="kw">][</font>2<font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Rect<font class="kw">(</font>$x1<font class="kw">, </font>$y1<font class="kw">, </font>$hLegend<font class="kw">, </font>$hLegend<font class="kw">, </font><font class="str">'DF'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>$x2<font class="kw">,</font>$y1<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>0<font class="kw">,</font>$hLegend<font class="kw">,</font>$<font class="kw">this-&gt;</font>legends<font class="kw">[</font>$i<font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$y1<font class="kw">+=</font>$hLegend <font class="kw">+ </font>$margin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;function </font>BarDiagram<font class="kw">(</font>$w<font class="kw">, </font>$h<font class="kw">, </font>$data<font class="kw">, </font>$format<font class="kw">, </font>$color<font class="kw">=</font>null<font class="kw">, </font>$maxVal<font class="kw">=</font>0<font class="kw">, </font>$nbDiv<font class="kw">=</font>4<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Courier'</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetLegends<font class="kw">(</font>$data<font class="kw">,</font>$format<font class="kw">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$XPage <font class="kw">= </font>$<font class="kw">this-&gt;</font>GetX<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$YPage <font class="kw">= </font>$<font class="kw">this-&gt;</font>GetY<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$margin <font class="kw">= </font>2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$YDiag <font class="kw">= </font>$YPage <font class="kw">+ </font>$margin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$hDiag <font class="kw">= </font>floor<font class="kw">(</font>$h <font class="kw">- </font>$margin <font class="kw">* </font>2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$XDiag <font class="kw">= </font>$XPage <font class="kw">+ </font>$margin <font class="kw">* </font>2 <font class="kw">+ </font>$<font class="kw">this-&gt;</font>wLegend<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$lDiag <font class="kw">= </font>floor<font class="kw">(</font>$w <font class="kw">- </font>$margin <font class="kw">* </font>3 <font class="kw">- </font>$<font class="kw">this-&gt;</font>wLegend<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$color <font class="kw">== </font>null<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$color<font class="kw">=array(</font>155<font class="kw">,</font>155<font class="kw">,</font>155<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$maxVal <font class="kw">== </font>0<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$maxVal <font class="kw">= </font>max<font class="kw">(</font>$data<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$valIndRepere <font class="kw">= </font>ceil<font class="kw">(</font>$maxVal <font class="kw">/ </font>$nbDiv<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$maxVal <font class="kw">= </font>$valIndRepere <font class="kw">* </font>$nbDiv<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$lRepere <font class="kw">= </font>floor<font class="kw">(</font>$lDiag <font class="kw">/ </font>$nbDiv<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$lDiag <font class="kw">= </font>$lRepere <font class="kw">* </font>$nbDiv<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$unit <font class="kw">= </font>$lDiag <font class="kw">/ </font>$maxVal<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$hBar <font class="kw">= </font>floor<font class="kw">(</font>$hDiag <font class="kw">/ (</font>$<font class="kw">this-&gt;</font>NbVal <font class="kw">+ </font>1<font class="kw">));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$hDiag <font class="kw">= </font>$hBar <font class="kw">* (</font>$<font class="kw">this-&gt;</font>NbVal <font class="kw">+ </font>1<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$eBaton <font class="kw">= </font>floor<font class="kw">(</font>$hBar <font class="kw">* </font>80 <font class="kw">/ </font>100<font class="kw">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetLineWidth<font class="kw">(</font>0.2<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Rect<font class="kw">(</font>$XDiag<font class="kw">, </font>$YDiag<font class="kw">, </font>$lDiag<font class="kw">, </font>$hDiag<font class="kw">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Courier'</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font>10<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFillColor<font class="kw">(</font>$color<font class="kw">[</font>0<font class="kw">],</font>$color<font class="kw">[</font>1<font class="kw">],</font>$color<font class="kw">[</font>2<font class="kw">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$i<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach(</font>$data <font class="kw">as </font>$val<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Bar<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$xval <font class="kw">= </font>$XDiag<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$lval <font class="kw">= (int)(</font>$val <font class="kw">* </font>$unit<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$yval <font class="kw">= </font>$YDiag <font class="kw">+ (</font>$i <font class="kw">+ </font>1<font class="kw">) * </font>$hBar <font class="kw">- </font>$eBaton <font class="kw">/ </font>2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$hval <font class="kw">= </font>$eBaton<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Rect<font class="kw">(</font>$xval<font class="kw">, </font>$yval<font class="kw">, </font>$lval<font class="kw">, </font>$hval<font class="kw">, </font><font class="str">'DF'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Legend<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetXY<font class="kw">(</font>0<font class="kw">, </font>$yval<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$xval <font class="kw">- </font>$margin<font class="kw">, </font>$hval<font class="kw">, </font>$<font class="kw">this-&gt;</font>legends<font class="kw">[</font>$i<font class="kw">],</font>0<font class="kw">,</font>0<font class="kw">,</font><font class="str">'R'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$i<font class="kw">++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Scales<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">for (</font>$i <font class="kw">= </font>0<font class="kw">; </font>$i <font class="kw">&lt;= </font>$nbDiv<font class="kw">; </font>$i<font class="kw">++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$xpos <font class="kw">= </font>$XDiag <font class="kw">+ </font>$lRepere <font class="kw">* </font>$i<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Line<font class="kw">(</font>$xpos<font class="kw">, </font>$YDiag<font class="kw">, </font>$xpos<font class="kw">, </font>$YDiag <font class="kw">+ </font>$hDiag<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$val <font class="kw">= </font>$i <font class="kw">* </font>$valIndRepere<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$xpos <font class="kw">= </font>$XDiag <font class="kw">+ </font>$lRepere <font class="kw">* </font>$i <font class="kw">- </font>$<font class="kw">this-&gt;</font>GetStringWidth<font class="kw">(</font>$val<font class="kw">) / </font>2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$ypos <font class="kw">= </font>$YDiag <font class="kw">+ </font>$hDiag <font class="kw">- </font>$margin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Text<font class="kw">(</font>$xpos<font class="kw">, </font>$ypos<font class="kw">, </font>$val<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;function </font>SetLegends<font class="kw">(</font>$data<font class="kw">, </font>$format<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>legends<font class="kw">=array();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>wLegend<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>sum<font class="kw">=</font>array_sum<font class="kw">(</font>$data<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>NbVal<font class="kw">=</font>count<font class="kw">(</font>$data<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach(</font>$data <font class="kw">as </font>$l<font class="kw">=&gt;</font>$val<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$p<font class="kw">=</font>sprintf<font class="kw">(</font><font class="str">'%.2f'</font><font class="kw">,</font>$val<font class="kw">/</font>$<font class="kw">this-&gt;</font>sum<font class="kw">*</font>100<font class="kw">).</font><font class="str">'%'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$legend<font class="kw">=</font>str_replace<font class="kw">(array(</font><font class="str">'%l'</font><font class="kw">,</font><font class="str">'%v'</font><font class="kw">,</font><font class="str">'%p'</font><font class="kw">),array(</font>$l<font class="kw">,</font>$val<font class="kw">,</font>$p<font class="kw">),</font>$format<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>legends<font class="kw">[]=</font>$legend<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>wLegend<font class="kw">=</font>max<font class="kw">(</font>$<font class="kw">this-&gt;</font>GetStringWidth<font class="kw">(</font>$legend<font class="kw">),</font>$<font class="kw">this-&gt;</font>wLegend<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>

<H4 CLASS="st">Example</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br>define<font class="kw">(</font><font class="str">'FPDF_FONTPATH'</font><font class="kw">,</font><font class="str">'font/'</font><font class="kw">);<br>require(</font><font class="str">'diag.php'</font><font class="kw">);<br><br></font>$pdf <font class="kw">= new </font>PDF_Diag<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>Open<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>AddPage<font class="kw">();<br><br></font>$data <font class="kw">= array(</font><font class="str">'Men' </font><font class="kw">=&gt; </font>1510<font class="kw">, </font><font class="str">'Women' </font><font class="kw">=&gt; </font>1610<font class="kw">, </font><font class="str">'Children' </font><font class="kw">=&gt; </font>1400<font class="kw">);<br><br></font><font class="cmt">//Pie chart<br></font>$pdf<font class="kw">-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">, </font><font class="str">'BIU'</font><font class="kw">, </font>12<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>0<font class="kw">, </font>5<font class="kw">, </font><font class="str">'1 - Pie chart'</font><font class="kw">, </font>0<font class="kw">, </font>1<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Ln<font class="kw">(</font>8<font class="kw">);<br><br></font>$pdf<font class="kw">-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">, </font><font class="str">''</font><font class="kw">, </font>10<font class="kw">);<br></font>$valX <font class="kw">= </font>$pdf<font class="kw">-&gt;</font>GetX<font class="kw">();<br></font>$valY <font class="kw">= </font>$pdf<font class="kw">-&gt;</font>GetY<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>30<font class="kw">, </font>5<font class="kw">, </font><font class="str">'Number of men:'</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>15<font class="kw">, </font>5<font class="kw">, </font>$data<font class="kw">[</font><font class="str">'Men'</font><font class="kw">], </font>0<font class="kw">, </font>0<font class="kw">, </font><font class="str">'R'</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Ln<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>30<font class="kw">, </font>5<font class="kw">, </font><font class="str">'Number of women:'</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>15<font class="kw">, </font>5<font class="kw">, </font>$data<font class="kw">[</font><font class="str">'Women'</font><font class="kw">], </font>0<font class="kw">, </font>0<font class="kw">, </font><font class="str">'R'</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Ln<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>30<font class="kw">, </font>5<font class="kw">, </font><font class="str">'Number of children:'</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>15<font class="kw">, </font>5<font class="kw">, </font>$data<font class="kw">[</font><font class="str">'Children'</font><font class="kw">], </font>0<font class="kw">, </font>0<font class="kw">, </font><font class="str">'R'</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Ln<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>Ln<font class="kw">(</font>8<font class="kw">);<br><br></font>$pdf<font class="kw">-&gt;</font>SetXY<font class="kw">(</font>90<font class="kw">, </font>$valY<font class="kw">);<br></font>$col1<font class="kw">=array(</font>100<font class="kw">,</font>100<font class="kw">,</font>255<font class="kw">);<br></font>$col2<font class="kw">=array(</font>255<font class="kw">,</font>100<font class="kw">,</font>100<font class="kw">);<br></font>$col3<font class="kw">=array(</font>255<font class="kw">,</font>255<font class="kw">,</font>100<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>PieChart<font class="kw">(</font>100<font class="kw">, </font>35<font class="kw">, </font>$data<font class="kw">, </font><font class="str">'%l (%p)'</font><font class="kw">, array(</font>$col1<font class="kw">,</font>$col2<font class="kw">,</font>$col3<font class="kw">));<br></font>$pdf<font class="kw">-&gt;</font>SetXY<font class="kw">(</font>$valX<font class="kw">, </font>$valY <font class="kw">+ </font>40<font class="kw">);<br><br></font><font class="cmt">//Bar diagram<br></font>$pdf<font class="kw">-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">, </font><font class="str">'BIU'</font><font class="kw">, </font>12<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>0<font class="kw">, </font>5<font class="kw">, </font><font class="str">'2 - Bar diagram'</font><font class="kw">, </font>0<font class="kw">, </font>1<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Ln<font class="kw">(</font>8<font class="kw">);<br></font>$valX <font class="kw">= </font>$pdf<font class="kw">-&gt;</font>GetX<font class="kw">();<br></font>$valY <font class="kw">= </font>$pdf<font class="kw">-&gt;</font>GetY<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>BarDiagram<font class="kw">(</font>190<font class="kw">, </font>70<font class="kw">, </font>$data<font class="kw">, </font><font class="str">'%l : %v (%p)'</font><font class="kw">, array(</font>255<font class="kw">,</font>175<font class="kw">,</font>100<font class="kw">));<br></font>$pdf<font class="kw">-&gt;</font>SetXY<font class="kw">(</font>$valX<font class="kw">, </font>$valY <font class="kw">+ </font>80<font class="kw">);<br><br></font>$pdf<font class="kw">-&gt;</font>Output<font class="kw">();<br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>
<BR>
View the result <A HREF="ex28.pdf" TARGET="_blank">here</A>.
<H4 CLASS="st">Download</H4><A HREF="script28.zip">ZIP</A> | <A HREF="script28.tgz">TGZ</A>
</BODY>
</HTML>

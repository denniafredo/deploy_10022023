<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<TITLE>Extended Cell functions</TITLE>
<LINK TYPE="text/css" REL="stylesheet" HREF="../fpdf.css">
</HEAD>
<BODY ONLOAD="if(window.focus) window.focus()">
<H2>Extended Cell functions</H2>
<H4 CLASS="st">Informations</H4>Author: <SCRIPT TYPE="text/javascript">document.write('<A H'+'REF="m'+'ailto:boba'+'&#'+'64;'+'khspu.ru?subject=Extended%20Cell%20functions">');</SCRIPT>Pivkin Vladimir<SCRIPT TYPE="text/javascript">document.write('<\/A>');</SCRIPT><BR>License: Freeware
<H4 CLASS="st">Description</H4>This class provides two extended versions of the Cell method, one which prints horizontal text:<BR>
<BR>
<TT>Cell(<B>float</B> w [, <B>float</B> h [, <B>string</B> txt [, <B>mixed</B> border [, <B>int</B> ln [, <B>string</B> align [, <B>int</B> fill [, <B>mixed</B> link]]]]]]])</TT><BR>
<BR>
and one for vertical:<BR>
<BR>
<TT>VCell(<B>float</B> w [, <B>float</B> h [, <B>string</B> txt [, <B>mixed</B> border [, <B>int</B> ln [, <B>string</B> align [, <B>int</B> fill]]]]]])</TT><BR>
<BR>
These methods allow multiline text with the delimiter "\n".<BR>
If the cell contains a single line and its length exceeds the size of the cell, the text will be
compressed to fit.<BR>
<BR>
Changes in parameters:<BR>
<BR>
<TT><U>border</U></TT>: indicates if borders must be drawn around the cell. The value can be
either a number:<BR>
<UL>
<LI><TT>0</TT>: no border</LI>
<LI><TT>>0</TT>: frame of the corresponding width</LI>
</UL>
or a string containing some or all of the following characters (in any order):
<UL>
<LI><TT>L</TT>: left</LI>
<LI><TT>T</TT>: top</LI>
<LI><TT>R</TT>: right</LI>
<LI><TT>B</TT>: bottom</LI>
</UL>
or for bold border:
<UL>
<LI><TT>l</TT>: left</LI>
<LI><TT>t</TT>: top</LI>
<LI><TT>r</TT>: right</LI>
<LI><TT>b</TT>: bottom</LI>
</UL>
Default value: <TT>0</TT>.<BR>
<BR>
For VCell():<BR>
<BR>
<TT><U>align</U></TT>: allows to center or align the text. Possible values are:
<UL>
<LI><TT>U</TT>: top</LI>
<LI><TT>C</TT>: center (default value)</LI>
<LI><TT>D</TT>: bottom</LI>
</UL>
<H4 CLASS="st">Source</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br><font class="kw">require(</font><font class="str">'fpdf.php'</font><font class="kw">);<br><br>class </font>CellPDF <font class="kw">extends </font>FPDF<br><font class="kw">{<br>function </font>VCell<font class="kw">(</font>$w<font class="kw">,</font>$h<font class="kw">=</font>0<font class="kw">,</font>$txt<font class="kw">=</font><font class="str">''</font><font class="kw">,</font>$border<font class="kw">=</font>0<font class="kw">,</font>$ln<font class="kw">=</font>0<font class="kw">,</font>$align<font class="kw">=</font><font class="str">''</font><font class="kw">,</font>$fill<font class="kw">=</font>0<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Output a cell<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$k<font class="kw">=</font>$<font class="kw">this-&gt;</font>k<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>y<font class="kw">+</font>$h<font class="kw">&gt;</font>$<font class="kw">this-&gt;</font>PageBreakTrigger <font class="kw">and !</font>$<font class="kw">this-&gt;</font>InFooter <font class="kw">and </font>$<font class="kw">this-&gt;</font>AcceptPageBreak<font class="kw">())<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$x<font class="kw">=</font>$<font class="kw">this-&gt;</font>x<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$ws<font class="kw">=</font>$<font class="kw">this-&gt;</font>ws<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$ws<font class="kw">&gt;</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>ws<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font><font class="str">'0 Tw'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>AddPage<font class="kw">(</font>$<font class="kw">this-&gt;</font>CurOrientation<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>x<font class="kw">=</font>$x<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$ws<font class="kw">&gt;</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>ws<font class="kw">=</font>$ws<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font>sprintf<font class="kw">(</font><font class="str">'%.3f Tw'</font><font class="kw">,</font>$ws<font class="kw">*</font>$k<font class="kw">));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$w<font class="kw">==</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$w<font class="kw">=</font>$<font class="kw">this-&gt;</font>w<font class="kw">-</font>$<font class="kw">this-&gt;</font>rMargin<font class="kw">-</font>$<font class="kw">this-&gt;</font>x<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">=</font><font class="str">''</font><font class="kw">;<br></font><font class="cmt">// begin change Cell function <br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if(</font>$fill<font class="kw">==</font>1 <font class="kw">or </font>$border<font class="kw">&gt;</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$fill<font class="kw">==</font>1<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$op<font class="kw">=(</font>$border<font class="kw">&gt;</font>0<font class="kw">) ? </font><font class="str">'B' </font><font class="kw">: </font><font class="str">'f'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$op<font class="kw">=</font><font class="str">'S'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$border<font class="kw">&gt;</font>1<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">=</font>sprintf<font class="kw">(</font><font class="str">' q %.2f w %.2f %.2f %.2f %.2f re %s Q '</font><font class="kw">,</font>$border<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$<font class="kw">this-&gt;</font>y<font class="kw">)*</font>$k<font class="kw">,</font>$w<font class="kw">*</font>$k<font class="kw">,-</font>$h<font class="kw">*</font>$k<font class="kw">,</font>$op<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">=</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f %.2f %.2f re %s '</font><font class="kw">,</font>$<font class="kw">this-&gt;</font>x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$<font class="kw">this-&gt;</font>y<font class="kw">)*</font>$k<font class="kw">,</font>$w<font class="kw">*</font>$k<font class="kw">,-</font>$h<font class="kw">*</font>$k<font class="kw">,</font>$op<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>is_string<font class="kw">(</font>$border<font class="kw">))<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$x<font class="kw">=</font>$<font class="kw">this-&gt;</font>x<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$y<font class="kw">=</font>$<font class="kw">this-&gt;</font>y<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'L'</font><font class="kw">)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f m %.2f %.2f l S '</font><font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if(</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'l'</font><font class="kw">)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'q 2 w %.2f %.2f m %.2f %.2f l S Q '</font><font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'T'</font><font class="kw">)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f m %.2f %.2f l S '</font><font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if(</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'t'</font><font class="kw">)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'q 2 w %.2f %.2f m %.2f %.2f l S Q '</font><font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'R'</font><font class="kw">)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f m %.2f %.2f l S '</font><font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if(</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'r'</font><font class="kw">)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'q 2 w %.2f %.2f m %.2f %.2f l S Q '</font><font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'B'</font><font class="kw">)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f m %.2f %.2f l S '</font><font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if(</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'b'</font><font class="kw">)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'q 2 w %.2f %.2f m %.2f %.2f l S Q '</font><font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>trim<font class="kw">(</font>$txt<font class="kw">)!=</font><font class="str">''</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$cr<font class="kw">=</font>substr_count<font class="kw">(</font>$txt<font class="kw">,</font><font class="str">"\n"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$cr<font class="kw">&gt;</font>0<font class="kw">) { </font><font class="cmt">// Multi line<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$txts <font class="kw">= </font>explode<font class="kw">(</font><font class="str">"\n"</font><font class="kw">, </font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$lines <font class="kw">= </font>count<font class="kw">(</font>$txts<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(</font>$l<font class="kw">=</font>0<font class="kw">;</font>$l<font class="kw">&lt;</font>$lines<font class="kw">;</font>$l<font class="kw">++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$txt<font class="kw">=</font>$txts<font class="kw">[</font>$l<font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$w_txt<font class="kw">=</font>$<font class="kw">this-&gt;</font>GetStringWidth<font class="kw">(</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$align<font class="kw">==</font><font class="str">'U'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$dy<font class="kw">=</font>$<font class="kw">this-&gt;</font>cMargin<font class="kw">+</font>$w_txt<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif(</font>$align<font class="kw">==</font><font class="str">'D'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$dy<font class="kw">=</font>$h<font class="kw">-</font>$<font class="kw">this-&gt;</font>cMargin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$dy<font class="kw">=(</font>$h<font class="kw">+</font>$w_txt<font class="kw">)/</font>2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$txt<font class="kw">=</font>str_replace<font class="kw">(</font><font class="str">')'</font><font class="kw">,</font><font class="str">'\\)'</font><font class="kw">,</font>str_replace<font class="kw">(</font><font class="str">'('</font><font class="kw">,</font><font class="str">'\\('</font><font class="kw">,</font>str_replace<font class="kw">(</font><font class="str">'\\'</font><font class="kw">,</font><font class="str">'\\\\'</font><font class="kw">,</font>$txt<font class="kw">)));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>ColorFlag<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font><font class="str">'q '</font><font class="kw">.</font>$<font class="kw">this-&gt;</font>TextColor<font class="kw">.</font><font class="str">' '</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'BT 0 1 -1 0 %.2f %.2f Tm (%s) Tj ET '</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</font>$<font class="kw">this-&gt;</font>x<font class="kw">+</font>.5<font class="kw">*</font>$w<font class="kw">+(</font>.7<font class="kw">+</font>$l<font class="kw">-</font>$lines<font class="kw">/</font>2<font class="kw">)*</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">)*</font>$k<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$<font class="kw">this-&gt;</font>y<font class="kw">+</font>$dy<font class="kw">))*</font>$k<font class="kw">,</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>ColorFlag<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font><font class="str">' Q '</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else { </font><font class="cmt">// Single line<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$w_txt<font class="kw">=</font>$<font class="kw">this-&gt;</font>GetStringWidth<font class="kw">(</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$Tz<font class="kw">=</font>100<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$w_txt<font class="kw">&gt;</font>$h<font class="kw">-</font>2<font class="kw">*</font>$<font class="kw">this-&gt;</font>cMargin<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$Tz<font class="kw">=(</font>$h<font class="kw">-</font>2<font class="kw">*</font>$<font class="kw">this-&gt;</font>cMargin<font class="kw">)/</font>$w_txt<font class="kw">*</font>100<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$w_txt<font class="kw">=</font>$h<font class="kw">-</font>2<font class="kw">*</font>$<font class="kw">this-&gt;</font>cMargin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$align<font class="kw">==</font><font class="str">'U'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$dy<font class="kw">=</font>$<font class="kw">this-&gt;</font>cMargin<font class="kw">+</font>$w_txt<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif(</font>$align<font class="kw">==</font><font class="str">'D'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$dy<font class="kw">=</font>$h<font class="kw">-</font>$<font class="kw">this-&gt;</font>cMargin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$dy<font class="kw">=(</font>$h<font class="kw">+</font>$w_txt<font class="kw">)/</font>2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$txt<font class="kw">=</font>str_replace<font class="kw">(</font><font class="str">')'</font><font class="kw">,</font><font class="str">'\\)'</font><font class="kw">,</font>str_replace<font class="kw">(</font><font class="str">'('</font><font class="kw">,</font><font class="str">'\\('</font><font class="kw">,</font>str_replace<font class="kw">(</font><font class="str">'\\'</font><font class="kw">,</font><font class="str">'\\\\'</font><font class="kw">,</font>$txt<font class="kw">)));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>ColorFlag<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font><font class="str">'q '</font><font class="kw">.</font>$<font class="kw">this-&gt;</font>TextColor<font class="kw">.</font><font class="str">' '</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'q BT 0 1 -1 0 %.2f %.2f Tm %.2f Tz (%s) Tj ET Q '</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</font>$<font class="kw">this-&gt;</font>x<font class="kw">+</font>.5<font class="kw">*</font>$w<font class="kw">+</font>.3<font class="kw">*</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">)*</font>$k<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$<font class="kw">this-&gt;</font>y<font class="kw">+</font>$dy<font class="kw">))*</font>$k<font class="kw">,</font>$Tz<font class="kw">,</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>ColorFlag<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font><font class="str">' Q '</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font class="cmt">// end change Cell function <br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if(</font>$s<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font>$s<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>lasth<font class="kw">=</font>$h<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$ln<font class="kw">&gt;</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Go to next line<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>y<font class="kw">+=</font>$h<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$ln<font class="kw">==</font>1<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>x<font class="kw">=</font>$<font class="kw">this-&gt;</font>lMargin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>x<font class="kw">+=</font>$w<font class="kw">;<br>}<br><br>function </font>Cell<font class="kw">(</font>$w<font class="kw">,</font>$h<font class="kw">=</font>0<font class="kw">,</font>$txt<font class="kw">=</font><font class="str">''</font><font class="kw">,</font>$border<font class="kw">=</font>0<font class="kw">,</font>$ln<font class="kw">=</font>0<font class="kw">,</font>$align<font class="kw">=</font><font class="str">''</font><font class="kw">,</font>$fill<font class="kw">=</font>0<font class="kw">,</font>$link<font class="kw">=</font><font class="str">''</font><font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Output a cell<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$k<font class="kw">=</font>$<font class="kw">this-&gt;</font>k<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>y<font class="kw">+</font>$h<font class="kw">&gt;</font>$<font class="kw">this-&gt;</font>PageBreakTrigger <font class="kw">and !</font>$<font class="kw">this-&gt;</font>InFooter <font class="kw">and </font>$<font class="kw">this-&gt;</font>AcceptPageBreak<font class="kw">())<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$x<font class="kw">=</font>$<font class="kw">this-&gt;</font>x<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$ws<font class="kw">=</font>$<font class="kw">this-&gt;</font>ws<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$ws<font class="kw">&gt;</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>ws<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font><font class="str">'0 Tw'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>AddPage<font class="kw">(</font>$<font class="kw">this-&gt;</font>CurOrientation<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>x<font class="kw">=</font>$x<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$ws<font class="kw">&gt;</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>ws<font class="kw">=</font>$ws<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font>sprintf<font class="kw">(</font><font class="str">'%.3f Tw'</font><font class="kw">,</font>$ws<font class="kw">*</font>$k<font class="kw">));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$w<font class="kw">==</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$w<font class="kw">=</font>$<font class="kw">this-&gt;</font>w<font class="kw">-</font>$<font class="kw">this-&gt;</font>rMargin<font class="kw">-</font>$<font class="kw">this-&gt;</font>x<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">=</font><font class="str">''</font><font class="kw">;<br></font><font class="cmt">// begin change Cell function 12.08.2003 <br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if(</font>$fill<font class="kw">==</font>1 <font class="kw">or </font>$border<font class="kw">&gt;</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$fill<font class="kw">==</font>1<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$op<font class="kw">=(</font>$border<font class="kw">&gt;</font>0<font class="kw">) ? </font><font class="str">'B' </font><font class="kw">: </font><font class="str">'f'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$op<font class="kw">=</font><font class="str">'S'</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$border<font class="kw">&gt;</font>1<font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">=</font>sprintf<font class="kw">(</font><font class="str">' q %.2f w %.2f %.2f %.2f %.2f re %s Q '</font><font class="kw">,</font>$border<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$<font class="kw">this-&gt;</font>y<font class="kw">)*</font>$k<font class="kw">,</font>$w<font class="kw">*</font>$k<font class="kw">,-</font>$h<font class="kw">*</font>$k<font class="kw">,</font>$op<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">=</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f %.2f %.2f re %s '</font><font class="kw">,</font>$<font class="kw">this-&gt;</font>x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$<font class="kw">this-&gt;</font>y<font class="kw">)*</font>$k<font class="kw">,</font>$w<font class="kw">*</font>$k<font class="kw">,-</font>$h<font class="kw">*</font>$k<font class="kw">,</font>$op<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>is_string<font class="kw">(</font>$border<font class="kw">))<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$x<font class="kw">=</font>$<font class="kw">this-&gt;</font>x<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$y<font class="kw">=</font>$<font class="kw">this-&gt;</font>y<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'L'</font><font class="kw">)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f m %.2f %.2f l S '</font><font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if(</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'l'</font><font class="kw">)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'q 2 w %.2f %.2f m %.2f %.2f l S Q '</font><font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'T'</font><font class="kw">)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f m %.2f %.2f l S '</font><font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if(</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'t'</font><font class="kw">)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'q 2 w %.2f %.2f m %.2f %.2f l S Q '</font><font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'R'</font><font class="kw">)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f m %.2f %.2f l S '</font><font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if(</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'r'</font><font class="kw">)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'q 2 w %.2f %.2f m %.2f %.2f l S Q '</font><font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-</font>$y<font class="kw">)*</font>$k<font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'B'</font><font class="kw">)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'%.2f %.2f m %.2f %.2f l S '</font><font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if(</font>is_int<font class="kw">(</font>strpos<font class="kw">(</font>$border<font class="kw">,</font><font class="str">'b'</font><font class="kw">)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'q 2 w %.2f %.2f m %.2f %.2f l S Q '</font><font class="kw">,</font>$x<font class="kw">*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">,(</font>$x<font class="kw">+</font>$w<font class="kw">)*</font>$k<font class="kw">,(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$y<font class="kw">+</font>$h<font class="kw">))*</font>$k<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;if (</font>trim<font class="kw">(</font>$txt<font class="kw">)!=</font><font class="str">''</font><font class="kw">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$cr<font class="kw">=</font>substr_count<font class="kw">(</font>$txt<font class="kw">,</font><font class="str">"\n"</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$cr<font class="kw">&gt;</font>0<font class="kw">) { </font><font class="cmt">// Multi line<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$txts <font class="kw">= </font>explode<font class="kw">(</font><font class="str">"\n"</font><font class="kw">, </font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$lines <font class="kw">= </font>count<font class="kw">(</font>$txts<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//$dy=($h-2*$this-&gt;cMargin)/$lines;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">for(</font>$l<font class="kw">=</font>0<font class="kw">;</font>$l<font class="kw">&lt;</font>$lines<font class="kw">;</font>$l<font class="kw">++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$txt<font class="kw">=</font>$txts<font class="kw">[</font>$l<font class="kw">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$w_txt<font class="kw">=</font>$<font class="kw">this-&gt;</font>GetStringWidth<font class="kw">(</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$align<font class="kw">==</font><font class="str">'R'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$dx<font class="kw">=</font>$w<font class="kw">-</font>$w_txt<font class="kw">-</font>$<font class="kw">this-&gt;</font>cMargin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif(</font>$align<font class="kw">==</font><font class="str">'C'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$dx<font class="kw">=(</font>$w<font class="kw">-</font>$w_txt<font class="kw">)/</font>2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$dx<font class="kw">=</font>$<font class="kw">this-&gt;</font>cMargin<font class="kw">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$txt<font class="kw">=</font>str_replace<font class="kw">(</font><font class="str">')'</font><font class="kw">,</font><font class="str">'\\)'</font><font class="kw">,</font>str_replace<font class="kw">(</font><font class="str">'('</font><font class="kw">,</font><font class="str">'\\('</font><font class="kw">,</font>str_replace<font class="kw">(</font><font class="str">'\\'</font><font class="kw">,</font><font class="str">'\\\\'</font><font class="kw">,</font>$txt<font class="kw">)));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>ColorFlag<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font><font class="str">'q '</font><font class="kw">.</font>$<font class="kw">this-&gt;</font>TextColor<font class="kw">.</font><font class="str">' '</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'BT %.2f %.2f Td (%s) Tj ET '</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</font>$<font class="kw">this-&gt;</font>x<font class="kw">+</font>$dx<font class="kw">)*</font>$k<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$<font class="kw">this-&gt;</font>y<font class="kw">+</font>.5<font class="kw">*</font>$h<font class="kw">+(</font>.7<font class="kw">+</font>$l<font class="kw">-</font>$lines<font class="kw">/</font>2<font class="kw">)*</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">))*</font>$k<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>underline<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font><font class="str">' '</font><font class="kw">.</font>$<font class="kw">this-&gt;</font>_dounderline<font class="kw">(</font>$<font class="kw">this-&gt;</font>x<font class="kw">+</font>$dx<font class="kw">,</font>$<font class="kw">this-&gt;</font>y<font class="kw">+</font>.5<font class="kw">*</font>$h<font class="kw">+</font>.3<font class="kw">*</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">,</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>ColorFlag<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font><font class="str">' Q '</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$link<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Link<font class="kw">(</font>$<font class="kw">this-&gt;</font>x<font class="kw">+</font>$dx<font class="kw">,</font>$<font class="kw">this-&gt;</font>y<font class="kw">+</font>.5<font class="kw">*</font>$h<font class="kw">-</font>.5<font class="kw">*</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">,</font>$w_txt<font class="kw">,</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">,</font>$link<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else { </font><font class="cmt">// Single line<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$w_txt<font class="kw">=</font>$<font class="kw">this-&gt;</font>GetStringWidth<font class="kw">(</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$Tz<font class="kw">=</font>100<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font>$w_txt<font class="kw">&gt;</font>$w<font class="kw">-</font>2<font class="kw">*</font>$<font class="kw">this-&gt;</font>cMargin<font class="kw">) { </font><font class="cmt">// Need compression<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$Tz<font class="kw">=(</font>$w<font class="kw">-</font>2<font class="kw">*</font>$<font class="kw">this-&gt;</font>cMargin<font class="kw">)/</font>$w_txt<font class="kw">*</font>100<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$w_txt<font class="kw">=</font>$w<font class="kw">-</font>2<font class="kw">*</font>$<font class="kw">this-&gt;</font>cMargin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$align<font class="kw">==</font><font class="str">'R'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$dx<font class="kw">=</font>$w<font class="kw">-</font>$w_txt<font class="kw">-</font>$<font class="kw">this-&gt;</font>cMargin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif(</font>$align<font class="kw">==</font><font class="str">'C'</font><font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$dx<font class="kw">=(</font>$w<font class="kw">-</font>$w_txt<font class="kw">)/</font>2<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$dx<font class="kw">=</font>$<font class="kw">this-&gt;</font>cMargin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$txt<font class="kw">=</font>str_replace<font class="kw">(</font><font class="str">')'</font><font class="kw">,</font><font class="str">'\\)'</font><font class="kw">,</font>str_replace<font class="kw">(</font><font class="str">'('</font><font class="kw">,</font><font class="str">'\\('</font><font class="kw">,</font>str_replace<font class="kw">(</font><font class="str">'\\'</font><font class="kw">,</font><font class="str">'\\\\'</font><font class="kw">,</font>$txt<font class="kw">)));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>ColorFlag<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font><font class="str">'q '</font><font class="kw">.</font>$<font class="kw">this-&gt;</font>TextColor<font class="kw">.</font><font class="str">' '</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font>sprintf<font class="kw">(</font><font class="str">'q BT %.2f %.2f Td %.2f Tz (%s) Tj ET Q '</font><font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</font>$<font class="kw">this-&gt;</font>x<font class="kw">+</font>$dx<font class="kw">)*</font>$k<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</font>$<font class="kw">this-&gt;</font>h<font class="kw">-(</font>$<font class="kw">this-&gt;</font>y<font class="kw">+</font>.5<font class="kw">*</font>$h<font class="kw">+</font>.3<font class="kw">*</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">))*</font>$k<font class="kw">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$Tz<font class="kw">,</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>underline<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font><font class="str">' '</font><font class="kw">.</font>$<font class="kw">this-&gt;</font>_dounderline<font class="kw">(</font>$<font class="kw">this-&gt;</font>x<font class="kw">+</font>$dx<font class="kw">,</font>$<font class="kw">this-&gt;</font>y<font class="kw">+</font>.5<font class="kw">*</font>$h<font class="kw">+</font>.3<font class="kw">*</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">,</font>$txt<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$<font class="kw">this-&gt;</font>ColorFlag<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$s<font class="kw">.=</font><font class="str">' Q '</font><font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$link<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Link<font class="kw">(</font>$<font class="kw">this-&gt;</font>x<font class="kw">+</font>$dx<font class="kw">,</font>$<font class="kw">this-&gt;</font>y<font class="kw">+</font>.5<font class="kw">*</font>$h<font class="kw">-</font>.5<font class="kw">*</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">,</font>$w_txt<font class="kw">,</font>$<font class="kw">this-&gt;</font>FontSize<font class="kw">,</font>$link<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font class="cmt">// end change Cell function 12.08.2003<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">if(</font>$s<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>_out<font class="kw">(</font>$s<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>lasth<font class="kw">=</font>$h<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$ln<font class="kw">&gt;</font>0<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Go to next line<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>y<font class="kw">+=</font>$h<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font>$ln<font class="kw">==</font>1<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>x<font class="kw">=</font>$<font class="kw">this-&gt;</font>lMargin<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>x<font class="kw">+=</font>$w<font class="kw">;<br>}<br><br>}</font>
</font>
</code></NOBR></TD></TR></TABLE>

<H4 CLASS="st">Example</H4><TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br>define<font class="kw">(</font><font class="str">'FPDF_FONTPATH'</font><font class="kw">,</font><font class="str">'font/'</font><font class="kw">);<br>require(</font><font class="str">'cellpdf.php'</font><font class="kw">);<br><br></font>$pdf<font class="kw">=new </font>CellPDF<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>Open<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>AddPage<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>12<font class="kw">);<br><br></font>$pdf<font class="kw">-&gt;</font>VCell<font class="kw">(</font>15<font class="kw">,</font>50<font class="kw">,</font><font class="str">"Text at\nbottom"</font><font class="kw">,</font>1<font class="kw">,</font>0<font class="kw">,</font><font class="str">'D'</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>VCell<font class="kw">(</font>10<font class="kw">,</font>50<font class="kw">,</font><font class="str">'Centered text'</font><font class="kw">,</font>2<font class="kw">,</font>0<font class="kw">,</font><font class="str">'C'</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>VCell<font class="kw">(</font>15<font class="kw">,</font>50<font class="kw">,</font><font class="str">"Text\non top"</font><font class="kw">,</font>1<font class="kw">,</font>0<font class="kw">,</font><font class="str">'U'</font><font class="kw">);<br><br></font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>50<font class="kw">,</font>50<font class="kw">,</font><font class="str">"Text on\nthe left"</font><font class="kw">,</font><font class="str">'lbtR'</font><font class="kw">,</font>0<font class="kw">,</font><font class="str">'L'</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>50<font class="kw">,</font>50<font class="kw">,</font><font class="str">'This line is very long and gets compressed'</font><font class="kw">,</font><font class="str">'LtRb'</font><font class="kw">,</font>0<font class="kw">,</font><font class="str">'C'</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Cell<font class="kw">(</font>50<font class="kw">,</font>50<font class="kw">,</font><font class="str">"Text on\nthe right"</font><font class="kw">,</font><font class="str">'Ltrb'</font><font class="kw">,</font>0<font class="kw">,</font><font class="str">'R'</font><font class="kw">);<br><br></font>$pdf<font class="kw">-&gt;</font>Output<font class="kw">();<br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE>
<BR>
View the result <A HREF="ex32.pdf" TARGET="_blank">here</A>.
<H4 CLASS="st">Download</H4><A HREF="script32.zip">ZIP</A> | <A HREF="script32.tgz">TGZ</A>
</BODY>
</HTML>
